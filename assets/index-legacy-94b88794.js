System.register(["./CoreExtension-legacy-f23b096e.js"],(function(t,e){"use strict";var n,r,o,i,s,a,l,c,h,d,u,f,p,g,m,x,y,v,_,w,b;return{setters:[t=>{n=t.a,r=t.E,o=t.g,i=t.m,s=t.b,a=t.c,l=t.T,c=t.d,h=t.e,d=t.i,u=t.S,f=t.f,p=t.B,g=t.h,m=t.j,x=t.k,y=t.W,v=t.l,_=t.n,w=t.o,b=t.C}],execute:function(){const t=(t,e)=>t===e,S=Symbol("solid-proxy"),T=Symbol("solid-track"),C={equals:t};let R=st;const F=1,E=2,I={owned:null,cleanups:null,context:null,owner:null},z={};var k=null;let N,M=null,A=null,P=null,L=null,B=0;function $(t,e){const n=A,r=k,o=0===t.length,i=void 0===e?r:e,s=o?I:{owned:null,cleanups:null,context:i?i.context:null,owner:i},a=o?t:()=>t((()=>H((()=>ht(s)))));k=s,A=null;try{return it(a,!0)}finally{A=n,k=r}}function D(t,e){const n={value:t,observers:null,observerSlots:null,comparator:(e=e?Object.assign({},C,e):C).equals||void 0};return[tt.bind(n),t=>("function"==typeof t&&(t=t(n.value)),et(n,t))]}function Y(t,e,n){nt(rt(t,e,!0,F))}function O(t,e,n){nt(rt(t,e,!1,F))}function X(t,e,n){R=at;const r=rt(t,e,!1,F);n&&n.render||(r.user=!0),L?L.push(r):nt(r)}function j(t,e,n){n=n?Object.assign({},C,n):C;const r=rt(t,e,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=n.equals||void 0,nt(r),tt.bind(r)}function W(t,e,n){let r,o,i;2===arguments.length&&"object"==typeof e||1===arguments.length?(r=!0,o=t,i=e||{}):(r=t,o=e,i=n||{});let s=null,a=z,l=!1,c="initialValue"in i,h="function"==typeof r&&j(r);const d=new Set,[u,f]=(i.storage||D)(i.initialValue),[p,g]=D(void 0),[m,x]=D(void 0,{equals:!1}),[y,v]=D(c?"ready":"unresolved");function _(t,e,n,r){return s===t&&(s=null,void 0!==r&&(c=!0),t!==a&&e!==a||!i.onHydrated||queueMicrotask((()=>i.onHydrated(r,{value:e}))),a=z,function(t,e){it((()=>{void 0===e&&f((()=>t)),v(void 0!==e?"errored":c?"ready":"unresolved"),g(e);for(const t of d.keys())t.decrement();d.clear()}),!1)}(e,n)),e}function w(){const t=N,e=u(),n=p();if(void 0!==n&&!s)throw n;return A&&!A.user&&t&&Y((()=>{m(),s&&(t.resolved||d.has(t)||(t.increment(),d.add(t)))})),e}function b(t=!0){if(!1!==t&&l)return;l=!1;const e=h?h():r;if(null==e||!1===e)return void _(s,H(u));const n=a!==z?a:H((()=>o(e,{value:u(),refetching:t})));return(i=n)&&"object"==typeof i&&"then"in i?(s=n,"value"in n?("success"===n.status?_(s,n.value,void 0,e):_(s,void 0,void 0,e),n):(l=!0,queueMicrotask((()=>l=!1)),it((()=>{v(c?"refreshing":"pending"),x()}),!1),n.then((t=>_(n,t,void 0,e)),(t=>_(n,void 0,dt(t),e))))):(_(s,n,void 0,e),n);var i}return Object.defineProperties(w,{state:{get:()=>y()},error:{get:()=>p()},loading:{get(){const t=y();return"pending"===t||"refreshing"===t}},latest:{get(){if(!c)return w();const t=p();if(t&&!s)throw t;return u()}}}),h?Y((()=>b(!1))):b(!1),[w,{refetch:b,mutate:f}]}function U(e,n=t,r){const o=new Map,i=rt((t=>{const r=e();for(const[e,i]of o.entries())if(n(e,r)!==n(e,t))for(const t of i.values())t.state=F,t.pure?P.push(t):L.push(t);return r}),void 0,!0,F);return nt(i),t=>{const e=A;if(e){let n;(n=o.get(t))?n.add(e):o.set(t,n=new Set([e])),V((()=>{n.delete(e),!n.size&&o.delete(t)}))}return n(t,i.value)}}function H(t){if(null===A)return t();const e=A;A=null;try{return t()}finally{A=e}}function G(t,e,n){const r=Array.isArray(t);let o,i=n&&n.defer;return n=>{let s;if(r){s=Array(t.length);for(let e=0;e<t.length;e++)s[e]=t[e]()}else s=t();if(i)return void(i=!1);const a=H((()=>e(s,o,n)));return o=s,a}}function K(t){X((()=>H(t)))}function V(t){return null===k||(null===k.cleanups?k.cleanups=[t]:k.cleanups.push(t)),t}function q(){return k}function Q(t,e){const n=Symbol("context");return{id:n,Provider:pt(n),defaultValue:t}}function J(t){return k&&k.context&&void 0!==k.context[t.id]?k.context[t.id]:t.defaultValue}function Z(t){const e=j(t),n=j((()=>ft(e())));return n.toArray=()=>{const t=n();return Array.isArray(t)?t:null!=t?[t]:[]},n}function tt(){if(this.sources&&this.state)if(this.state===F)nt(this);else{const t=P;P=null,it((()=>lt(this)),!1),P=t}if(A){const t=this.observers?this.observers.length:0;A.sources?(A.sources.push(this),A.sourceSlots.push(t)):(A.sources=[this],A.sourceSlots=[t]),this.observers?(this.observers.push(A),this.observerSlots.push(A.sources.length-1)):(this.observers=[A],this.observerSlots=[A.sources.length-1])}return this.value}function et(t,e,n){let r=t.value;return t.comparator&&t.comparator(r,e)||(t.value=e,t.observers&&t.observers.length&&it((()=>{for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e],r=M&&M.running;r&&M.disposed.has(n),(r?n.tState:n.state)||(n.pure?P.push(n):L.push(n),n.observers&&ct(n)),r||(n.state=F)}if(P.length>1e6)throw P=[],new Error}),!1)),e}function nt(t){if(!t.fn)return;ht(t);const e=k,n=A,r=B;A=k=t,function(t,e,n){let r;try{r=t.fn(e)}catch(o){return t.pure&&(t.state=F,t.owned&&t.owned.forEach(ht),t.owned=null),t.updatedAt=n+1,ut(o)}(!t.updatedAt||t.updatedAt<=n)&&(null!=t.updatedAt&&"observers"in t?et(t,r):t.value=r,t.updatedAt=n)}(t,t.value,r),A=n,k=e}function rt(t,e,n,r=F,o){const i={fn:t,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:e,owner:k,context:k?k.context:null,pure:n};return null===k||k!==I&&(k.owned?k.owned.push(i):k.owned=[i]),i}function ot(t){if(0===t.state)return;if(t.state===E)return lt(t);if(t.suspense&&H(t.suspense.inFallback))return t.suspense.effects.push(t);const e=[t];for(;(t=t.owner)&&(!t.updatedAt||t.updatedAt<B);)t.state&&e.push(t);for(let n=e.length-1;n>=0;n--)if((t=e[n]).state===F)nt(t);else if(t.state===E){const n=P;P=null,it((()=>lt(t,e[0])),!1),P=n}}function it(t,e){if(P)return t();let n=!1;e||(P=[]),L?n=!0:L=[],B++;try{const e=t();return function(t){if(P&&(st(P),P=null),t)return;const e=L;L=null,e.length&&it((()=>R(e)),!1)}(n),e}catch(r){n||(L=null),P=null,ut(r)}}function st(t){for(let e=0;e<t.length;e++)ot(t[e])}function at(t){let e,n=0;for(e=0;e<t.length;e++){const r=t[e];r.user?t[n++]=r:ot(r)}for(e=0;e<n;e++)ot(t[e])}function lt(t,e){t.state=0;for(let n=0;n<t.sources.length;n+=1){const r=t.sources[n];if(r.sources){const t=r.state;t===F?r!==e&&(!r.updatedAt||r.updatedAt<B)&&ot(r):t===E&&lt(r,e)}}}function ct(t){for(let e=0;e<t.observers.length;e+=1){const n=t.observers[e];n.state||(n.state=E,n.pure?P.push(n):L.push(n),n.observers&&ct(n))}}function ht(t){let e;if(t.sources)for(;t.sources.length;){const e=t.sources.pop(),n=t.sourceSlots.pop(),r=e.observers;if(r&&r.length){const t=r.pop(),o=e.observerSlots.pop();n<r.length&&(t.sourceSlots[o]=n,r[n]=t,e.observerSlots[n]=o)}}if(t.owned){for(e=t.owned.length-1;e>=0;e--)ht(t.owned[e]);t.owned=null}if(t.cleanups){for(e=t.cleanups.length-1;e>=0;e--)t.cleanups[e]();t.cleanups=null}t.state=0}function dt(t){return t instanceof Error?t:new Error("string"==typeof t?t:"Unknown error",{cause:t})}function ut(t,e=k){throw dt(t)}function ft(t){if("function"==typeof t&&!t.length)return ft(t());if(Array.isArray(t)){const e=[];for(let n=0;n<t.length;n++){const r=ft(t[n]);Array.isArray(r)?e.push.apply(e,r):e.push(r)}return e}return t}function pt(t,e){return function(e){let n;return O((()=>n=H((()=>(k.context={...k.context,[t]:e.value},Z((()=>e.children)))))),void 0),n}}const gt=Symbol("fallback");function mt(t){for(let e=0;e<t.length;e++)t[e]()}function xt(t,e){return H((()=>t(e||{})))}function yt(){return!0}const vt={get:(t,e,n)=>e===S?n:t.get(e),has:(t,e)=>e===S||t.has(e),set:yt,deleteProperty:yt,getOwnPropertyDescriptor:(t,e)=>({configurable:!0,enumerable:!0,get:()=>t.get(e),set:yt,deleteProperty:yt}),ownKeys:t=>t.keys()};function _t(t){return(t="function"==typeof t?t():t)?t:{}}function wt(){for(let t=0,e=this.length;t<e;++t){const e=this[t]();if(void 0!==e)return e}}function bt(...t){let e=!1;for(let i=0;i<t.length;i++){const n=t[i];e=e||!!n&&S in n,t[i]="function"==typeof n?(e=!0,j(n)):n}if(e)return new Proxy({get(e){for(let n=t.length-1;n>=0;n--){const r=_t(t[n])[e];if(void 0!==r)return r}},has(e){for(let n=t.length-1;n>=0;n--)if(e in _t(t[n]))return!0;return!1},keys(){const e=[];for(let n=0;n<t.length;n++)e.push(...Object.keys(_t(t[n])));return[...new Set(e)]}},vt);const n={},r={},o=new Set;for(let i=t.length-1;i>=0;i--){const e=t[i];if(!e)continue;const s=Object.getOwnPropertyNames(e);for(let t=0,i=s.length;t<i;t++){const i=s[t];if("__proto__"===i||"constructor"===i)continue;const a=Object.getOwnPropertyDescriptor(e,i);if(o.has(i)){const t=r[i];t?a.get?t.push(a.get.bind(e)):void 0!==a.value&&t.push((()=>a.value)):void 0===n[i]&&(n[i]=a.value)}else a.get?(o.add(i),Object.defineProperty(n,i,{enumerable:!0,configurable:!0,get:wt.bind(r[i]=[a.get.bind(e)])})):(void 0!==a.value&&o.add(i),n[i]=a.value)}}return n}const St=t=>`Stale read from <${t}>.`;function Tt(t){const e="fallback"in t&&{fallback:()=>t.fallback};return j(function(t,e,n={}){let r=[],o=[],i=[],s=0,a=e.length>1?[]:null;return V((()=>mt(i))),()=>{let l,c,h=t()||[];return h[T],H((()=>{let t,e,u,f,p,g,m,x,y,v=h.length;if(0===v)0!==s&&(mt(i),i=[],r=[],o=[],s=0,a&&(a=[])),n.fallback&&(r=[gt],o[0]=$((t=>(i[0]=t,n.fallback()))),s=1);else if(0===s){for(o=new Array(v),c=0;c<v;c++)r[c]=h[c],o[c]=$(d);s=v}else{for(u=new Array(v),f=new Array(v),a&&(p=new Array(v)),g=0,m=Math.min(s,v);g<m&&r[g]===h[g];g++);for(m=s-1,x=v-1;m>=g&&x>=g&&r[m]===h[x];m--,x--)u[x]=o[m],f[x]=i[m],a&&(p[x]=a[m]);for(t=new Map,e=new Array(x+1),c=x;c>=g;c--)y=h[c],l=t.get(y),e[c]=void 0===l?-1:l,t.set(y,c);for(l=g;l<=m;l++)y=r[l],c=t.get(y),void 0!==c&&-1!==c?(u[c]=o[l],f[c]=i[l],a&&(p[c]=a[l]),c=e[c],t.set(y,c)):i[l]();for(c=g;c<v;c++)c in u?(o[c]=u[c],i[c]=f[c],a&&(a[c]=p[c],a[c](c))):o[c]=$(d);o=o.slice(0,s=v),r=h.slice(0)}return o}));function d(t){if(i[c]=t,a){const[t,n]=D(c);return a[c]=n,e(h[c],t)}return e(h[c])}}}((()=>t.each),t.children,e||void 0))}function Ct(t){const e=t.keyed,n=j((()=>t.when),void 0,{equals:(t,n)=>e?t===n:!t==!n});return j((()=>{const r=n();if(r){const o=t.children;return"function"==typeof o&&o.length>0?H((()=>o(e?r:()=>{if(!H(n))throw St("Show");return t.when}))):o}return t.fallback}),void 0,void 0)}const[Rt,Ft]=D(null),Et=t=>(()=>{const e=Je("text");return nn(e,t,!1),e})(),It=t=>(()=>{const e=Je("node");return nn(e,t,!1),e})();class zt{releaseCallback;constructor(t){this.releaseCallback=t}}class kt extends zt{textureMap=new Map;zeroReferenceTextureSet=new Set;options;constructor(t,e){super(t),this.options={textureCleanupIntervalMs:e.textureCleanupIntervalMs??1e4,textureCleanupAgeThreadholdMs:e.textureCleanupAgeThreadholdMs??6e4},setInterval((()=>{const t=Date.now(),e=this.options.textureCleanupAgeThreadholdMs;for(const n of this.zeroReferenceTextureSet)t-n.lastUpdate>e&&(this.releaseCallback(n.id),this.textureMap.delete(n.id),this.zeroReferenceTextureSet.delete(n))}),this.options.textureCleanupIntervalMs)}registerTexture(t){const e=t.options?.id;if(n(e,"Texture must have an id to be registered"),!this.textureMap.has(e)){const t={id:e,nodeRefCount:0,lastUpdate:Date.now()};this.textureMap.set(e,t),this.zeroReferenceTextureSet.add(t)}}incrementTextureRefCount(t){const e=t.options?.id;n(e,"Texture must have an id to be registered");let r=this.textureMap.get(e);r||(this.registerTexture(t),r=this.textureMap.get(e)),n(r,"Texture must have been registered"),"SubTexture"===t.txType&&this.incrementTextureRefCount(t.props.texture),r.nodeRefCount++,r.lastUpdate=Date.now(),this.zeroReferenceTextureSet.has(r)&&this.zeroReferenceTextureSet.delete(r)}decrementTextureRefCount(t){const e=t.options?.id;n(e,"Texture must have an id to be registered");const r=this.textureMap.get(e);n(r,"Texture must have been registered"),r.nodeRefCount--,r.lastUpdate=Date.now(),0===r.nodeRefCount&&this.zeroReferenceTextureSet.add(r),"SubTexture"===t.txType&&this.decrementTextureRefCount(t.props.texture)}}class Nt extends zt{registry;constructor(t){super(t),this.registry=new FinalizationRegistry(t)}registerTexture(t){n(t.options?.id,"Texture must have an ID to be registered"),this.registry.register(t,t.options?.id)}incrementTextureRefCount(){}decrementTextureRefCount(){}}class Mt{root=null;driver;canvas;settings;nodes=new Map;nextTextureId=1;textureTracker;constructor(t,e,n){const r={appWidth:t.appWidth||1920,appHeight:t.appHeight||1080,deviceLogicalPixelRatio:t.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:t.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:t.clearColor??0,coreExtensionModule:t.coreExtensionModule||null,experimental_FinalizationRegistryTextureUsageTracker:t.experimental_FinalizationRegistryTextureUsageTracker??!1,textureCleanupOptions:t.textureCleanupOptions||{}};this.settings=r;const{appWidth:o,appHeight:i,deviceLogicalPixelRatio:s,devicePhysicalPixelRatio:a}=r,l=t=>{this.driver.releaseTexture(t)},c=r.experimental_FinalizationRegistryTextureUsageTracker&&"function"==typeof FinalizationRegistry;this.textureTracker=c?new Nt(l):new kt(l,this.settings.textureCleanupOptions);const h=o*s,d=i*s;this.driver=n;const u=document.createElement("canvas");let f;if(this.canvas=u,u.width=h*a,u.height=d*a,u.style.width=`${h}px`,u.style.height=`${d}px`,f="string"==typeof e?document.getElementById(e):e,!f)throw new Error("Could not find target element");n.onCreateNode=t=>{this.nodes.set(t.id,t)},n.onBeforeDestroyNode=t=>{this.nodes.delete(t.id)},f.appendChild(u)}async init(){await this.driver.init(this,this.settings,this.canvas),this.root=this.driver.getRootNode()}createNode(t){return this.driver.createNode(this.resolveNodeDefaults(t))}createTextNode(t){return this.driver.createTextNode({...this.resolveNodeDefaults(t),text:t.text??"",textRendererOverride:t.textRendererOverride??null,fontSize:t.fontSize??16,fontFamily:t.fontFamily??"sans-serif",fontStyle:t.fontStyle??"normal",fontWeight:t.fontWeight??"normal",fontStretch:t.fontStretch??"normal",textAlign:t.textAlign??"left",contain:t.contain??"none",scrollable:t.scrollable??!1,scrollY:t.scrollY??0,offsetY:t.offsetY??0,letterSpacing:t.letterSpacing??0,debug:t.debug??{}})}resolveNodeDefaults(t){const e=t.color??4294967295,n=t.colorTl??t.colorTop??t.colorLeft??e,r=t.colorTr??t.colorTop??t.colorRight??e,o=t.colorBl??t.colorBottom??t.colorLeft??e,i=t.colorBr??t.colorBottom??t.colorRight??e;return{x:t.x??0,y:t.y??0,width:t.width??0,height:t.height??0,alpha:t.alpha??1,clipping:t.clipping??!1,color:e,colorTop:t.colorTop??e,colorBottom:t.colorBottom??e,colorLeft:t.colorLeft??e,colorRight:t.colorRight??e,colorBl:o,colorBr:i,colorTl:n,colorTr:r,zIndex:t.zIndex??0,zIndexLocked:t.zIndexLocked??0,parent:t.parent??null,texture:t.texture??null,shader:t.shader??null,src:t.src??"",scale:t.scale??null,scaleX:t.scaleX??t.scale??1,scaleY:t.scaleY??t.scale??1,mount:t.mount??0,mountX:t.mountX??t.mount??0,mountY:t.mountY??t.mount??0,pivot:t.pivot??.5,pivotX:t.pivotX??t.pivot??.5,pivotY:t.pivotY??t.pivot??.5,rotation:t.rotation??0}}destroyNode(t){return this.driver.destroyNode(t)}createTexture(t,e,n){const r={descType:"texture",txType:t,props:e,options:{...n,id:this.nextTextureId++}};return this.textureTracker.registerTexture(r),r}createShader(t,e){return{descType:"shader",shType:t,props:e}}getNodeById(t){return this.nodes.get(t)||null}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}rerender(){throw new Error("Not implemented")}}class At extends r{node;props;settings;propStartValues={};restoreValues={};progress=0;timingFunction;constructor(t,e,n){super(),this.node=t,this.props=e,this.settings=n,this.propStartValues={},Object.keys(e).forEach((e=>{this.propStartValues[e]=t[e]})),this.timingFunction=t=>t,n.easing&&"string"==typeof n.easing&&(this.timingFunction=o(n.easing))}reset(){this.progress=0,this.update(0)}restore(){this.reset(),Object.keys(this.props).forEach((t=>{this.node[t]=this.propStartValues[t]}))}reverse(){this.progress=0,Object.keys(this.props).forEach((t=>{const e=this.props[t],n=this.propStartValues[t];this.props[t]=n,this.propStartValues[t]=e})),this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(t,e,n){return(this.timingFunction(t)||t)*(n-e)+e}update(t){const{duration:e,loop:n,easing:r}=this.settings;e?(this.progress+=t/e,this.progress>1&&(this.progress=n?0:1,this.emit("finished",{})),Object.keys(this.props).forEach((t=>{const e=this.props[t],n=this.propStartValues[t],o=e;if(-1!==t.indexOf("color")){const e=r&&this.timingFunction(this.progress)||this.progress,s=i(n,o,e);this.node[t]=r?s:i(n,o,this.progress)}else this.node[t]=r?this.applyEasing(this.progress,n,o):n+(o-n)*this.progress}))):this.emit("finished",{})}}class Pt{manager;animation;stoppedPromise=null;stoppedResolve=null;constructor(t,e){this.manager=t,this.animation=e,this.state="stopped"}state;start(){return this.makeStoppedPromise(),this.animation.once("finished",this.finished.bind(this)),this.manager.activeAnimations.has(this.animation)||this.manager.registerAnimation(this.animation),this.state="running",this}stop(){return this.manager.unregisterAnimation(this.animation),null!==this.stoppedResolve&&(this.stoppedResolve(),this.stoppedResolve=null),this.animation.reset(),this.state="stopped",this}pause(){return this.manager.unregisterAnimation(this.animation),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){this.makeStoppedPromise();const t=this.stoppedPromise;return n(t),t}makeStoppedPromise(){null===this.stoppedResolve&&(this.stoppedPromise=new Promise((t=>{this.stoppedResolve=t})))}finished(){n(this.stoppedResolve);const{loop:t,stopMethod:e}=this.animation.settings;if("reverse"===e)return this.animation.reverse(),void this.start();this.stoppedResolve(),this.stoppedResolve=null,t||this.manager.unregisterAnimation(this.animation)}}class Lt{data;constructor(t){t?(this.data=new Float32Array(9),this.data[0]=t[0],this.data[3]=t[3],this.data[6]=t[6],this.data[1]=t[1],this.data[4]=t[4],this.data[7]=t[7],this.data[2]=t[2],this.data[5]=t[5],this.data[8]=t[8]):this.data=new Float32Array(9)}static get temp(){return Bt}static multiply(t,e,n){const r=t.data[0]*e.data[0]+t.data[3]*e.data[1]+t.data[6]*e.data[2],o=t.data[0]*e.data[3]+t.data[3]*e.data[4]+t.data[6]*e.data[5],i=t.data[0]*e.data[6]+t.data[3]*e.data[7]+t.data[6]*e.data[8],s=t.data[1]*e.data[0]+t.data[4]*e.data[1]+t.data[7]*e.data[2],a=t.data[1]*e.data[3]+t.data[4]*e.data[4]+t.data[7]*e.data[5],l=t.data[1]*e.data[6]+t.data[4]*e.data[7]+t.data[7]*e.data[8],c=t.data[2]*e.data[0]+t.data[5]*e.data[1]+t.data[8]*e.data[2],h=t.data[2]*e.data[3]+t.data[5]*e.data[4]+t.data[8]*e.data[5],d=t.data[2]*e.data[6]+t.data[5]*e.data[7]+t.data[8]*e.data[8];return n||(n=new Lt),n.data[0]=r,n.data[3]=o,n.data[6]=i,n.data[1]=s,n.data[4]=a,n.data[7]=l,n.data[2]=c,n.data[5]=h,n.data[8]=d,n}static identity(t){return t||(t=new Lt),t.data[0]=1,t.data[3]=0,t.data[6]=0,t.data[1]=0,t.data[4]=1,t.data[7]=0,t.data[2]=0,t.data[5]=0,t.data[8]=1,t}static translate(t,e,n){return n||(n=new Lt),n.data[0]=1,n.data[3]=0,n.data[6]=t,n.data[1]=0,n.data[4]=1,n.data[7]=e,n.data[2]=0,n.data[5]=0,n.data[8]=1,n}static scale(t,e,n){return n||(n=new Lt),n.data[0]=t,n.data[3]=0,n.data[6]=0,n.data[1]=0,n.data[4]=e,n.data[7]=0,n.data[2]=0,n.data[5]=0,n.data[8]=1,n}static rotate(t,e){const n=Math.cos(t),r=Math.sin(t);return e||(e=new Lt),e.data[0]=n,e.data[3]=-r,e.data[6]=0,e.data[1]=r,e.data[4]=n,e.data[7]=0,e.data[2]=0,e.data[5]=0,e.data[8]=1,e}static copy(t,e,n){return e||(e=new Lt),e.data[0]=t.data[0],e.data[1]=t.data[1],e.data[2]=t.data[2],e.data[3]=t.data[3],e.data[4]=t.data[4],e.data[5]=t.data[5],e.data[6]=t.data[6],e.data[7]=t.data[7],e.data[8]=t.data[8],e}translate(t,e){return this.data[6]=this.data[0]*t+this.data[3]*e+this.data[6],this.data[7]=this.data[1]*t+this.data[4]*e+this.data[7],this}scale(t,e){return this.data[0]=this.data[0]*t,this.data[3]=this.data[3]*e,this.data[1]=this.data[1]*t,this.data[4]=this.data[4]*e,this}rotate(t){if(0===t||!(t%Math.PI*2))return this;const e=Math.cos(t),n=Math.sin(t),r=this.data[0]*e+this.data[3]*n,o=this.data[3]*e-this.data[0]*n,i=this.data[1]*e+this.data[4]*n,s=this.data[4]*e-this.data[1]*n;return this.data[0]=r,this.data[3]=o,this.data[1]=i,this.data[4]=s,this}multiply(t){return Lt.multiply(this,t,this)}get tx(){return this.data[6]}get ty(){return this.data[7]}get ta(){return this.data[0]}get tb(){return this.data[3]}get tc(){return this.data[1]}get td(){return this.data[4]}transformPoint(t,e){return[this.data[0]*t+this.data[3]*e+this.data[6],this.data[1]*t+this.data[4]*e+this.data[1]]}}const Bt=new Lt;class $t extends r{stage;children=[];props;recalculationType=6;hasUpdates=!0;globalTransform;scaleRotateTransform;localTransform;isComplex=!1;constructor(t,e){super(),this.stage=t,this.props={...e,parent:null},this.parent=e.parent,this.updateScaleRotateTransform()}loadTexture(t,e,n=null){this.props.texture&&this.unloadTexture();const{txManager:r}=this.stage,o=r.loadTexture(t,e,n);this.props.texture=o,this.props.textureOptions=n,queueMicrotask((()=>{"loaded"===o.state?this.onTextureLoaded(o,o.dimensions):"failed"===o.state&&this.onTextureFailed(o,o.error),o.on("loaded",this.onTextureLoaded),o.on("failed",this.onTextureFailed)}))}unloadTexture(){this.props.texture&&(this.props.texture.off("loaded",this.onTextureLoaded),this.props.texture.off("failed",this.onTextureFailed)),this.props.texture=null,this.props.textureOptions=null}onTextureLoaded=(t,e)=>{this.emit("loaded",{type:"texture",dimensions:e})};onTextureFailed=(t,e)=>{this.emit("failed",{type:"texture",error:e})};loadShader(t,e){const r=this.stage.renderer.getShaderManager();n(r);const{shader:o,props:i}=r.loadShader(t,e);this.props.shader=o,this.props.shaderProps=i}setHasUpdates(){if(!this.props.alpha)return;this.hasUpdates=!0;let t=this?.props.parent;for(;t;)t.hasUpdates=!0,t=t?.props.parent}setRecalculationType(t){this.recalculationType|=t,this.setHasUpdates()}updateScaleRotateTransform(){this.setRecalculationType(4),this.scaleRotateTransform=Lt.rotate(this.props.rotation,this.scaleRotateTransform).scale(this.props.scaleX,this.props.scaleY),this.updateLocalTransform()}updateLocalTransform(){n(this.scaleRotateTransform),this.setRecalculationType(2);const t=this.props.pivotX*this.props.width,e=this.props.pivotY*this.props.height,r=this.props.mountX*this.props.width,o=this.props.mountY*this.props.height;this.localTransform=Lt.translate(t-r+this.props.x,e-o+this.props.y,this.localTransform).multiply(this.scaleRotateTransform).translate(-t,-e)}update(t){n(this.localTransform);const e=this.parent?.globalTransform;this.globalTransform=e?Lt.copy(e,this.globalTransform).multiply(this.localTransform):Lt.copy(this.localTransform,this.globalTransform),this.children.length&&this.children.forEach((e=>{e.update(t)})),this.hasUpdates=!1,this.recalculationType=0}renderQuads(t,e){const{width:r,height:o,colorTl:i,colorTr:s,colorBl:a,colorBr:l,texture:c,textureOptions:h,shader:d,shaderProps:u}=this.props,{zIndex:f,worldAlpha:p,globalTransform:g}=this;n(g),t.addRenderable({width:r,height:o,colorTl:i,colorTr:s,colorBl:a,colorBr:l,texture:c,textureOptions:h,zIndex:f,shader:d,shaderProps:u,alpha:p,clippingRect:e,tx:g.tx,ty:g.ty,ta:g.ta,tb:g.tb,tc:g.tc,td:g.td})}get id(){return this.props.id}get x(){return this.props.x}set x(t){this.props.x!==t&&(this.props.x=t,this.updateLocalTransform())}get absX(){return this.props.x+(this.props.parent?.absX||this.props.parent?.globalTransform?.tx||0)}get absY(){return this.props.y+(this.props.parent?.absY??0)}get y(){return this.props.y}set y(t){this.props.y!==t&&(this.props.y=t,this.updateLocalTransform())}get width(){return this.props.width}set width(t){this.props.width!==t&&(this.props.width=t,this.updateLocalTransform())}get height(){return this.props.height}set height(t){this.props.height!==t&&(this.props.height=t,this.updateLocalTransform())}get scale(){return this.scaleX}set scale(t){this.scaleX=t,this.scaleY=t}get scaleX(){return this.props.scaleX}set scaleX(t){this.props.scaleX!==t&&(this.props.scaleX=t,this.updateScaleRotateTransform())}get scaleY(){return this.props.scaleY}set scaleY(t){this.props.scaleY!==t&&(this.props.scaleY=t,this.updateScaleRotateTransform())}get worldScaleX(){return this.props.scaleX*(this.props.parent?.worldScaleX??1)||this.props.scaleX}get worldScaleY(){return this.props.scaleY*(this.props.parent?.worldScaleY??1)||this.props.scaleY}get mount(){return this.props.mount}set mount(t){this.props.mountX=t,this.props.mountY=t,this.props.mount=t,this.updateLocalTransform()}get mountX(){return this.props.mountX}set mountX(t){this.props.mountX=t,this.updateLocalTransform()}get mountY(){return this.props.mountY}set mountY(t){this.props.mountY=t,this.updateLocalTransform()}get pivot(){return this.props.pivot}set pivot(t){this.props.pivotX===t&&this.props.pivotY===t||(this.props.pivotX=t,this.props.pivotY=t,this.updateLocalTransform())}get pivotX(){return this.props.pivotX}set pivotX(t){this.props.pivotX=t,this.updateLocalTransform()}get pivotY(){return this.props.pivotY}set pivotY(t){this.props.pivotY=t,this.updateLocalTransform()}get rotation(){return this.props.rotation}set rotation(t){this.props.rotation!==t&&(this.props.rotation=t,this.updateScaleRotateTransform())}get alpha(){return this.props.alpha}set alpha(t){this.props.alpha=t}get worldAlpha(){const t=this.props,e=t.parent;return t.alpha*(e?.worldAlpha||1)}get clipping(){return this.props.clipping}set clipping(t){this.props.clipping=t}get color(){return this.props.color}set color(t){this.props.colorTl===t&&this.props.colorTr===t&&this.props.colorBl===t&&this.props.colorBr===t||(this.colorTl=t,this.colorTr=t,this.colorBl=t,this.colorBr=t),this.props.color=t}get colorTop(){return this.props.colorTop}set colorTop(t){this.props.colorTl===t&&this.props.colorTr===t||(this.colorTl=t,this.colorTr=t),this.props.colorTop=t}get colorBottom(){return this.props.colorBottom}set colorBottom(t){this.props.colorBl===t&&this.props.colorBr===t||(this.colorBl=t,this.colorBr=t),this.props.colorBottom=t}get colorLeft(){return this.props.colorLeft}set colorLeft(t){this.props.colorTl===t&&this.props.colorBl===t||(this.colorTl=t,this.colorBl=t),this.props.colorLeft=t}get colorRight(){return this.props.colorRight}set colorRight(t){this.props.colorTr===t&&this.props.colorBr===t||(this.colorTr=t,this.colorBr=t),this.props.colorRight=t}get colorTl(){return this.props.colorTl}set colorTl(t){this.props.colorTl=t}get colorTr(){return this.props.colorTr}set colorTr(t){this.props.colorTr=t}get colorBl(){return this.props.colorBl}set colorBl(t){this.props.colorBl=t}get colorBr(){return this.props.colorBr}set colorBr(t){this.props.colorBr=t}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(t){this.props.zIndexLocked=t}get zIndex(){const t=this.props,e=t.zIndex||0,n=t.parent?.zIndex||0;return t.parent?.zIndexLocked?e<n?e:n:e}set zIndex(t){this.props.zIndex=t}get parent(){return this.props.parent}set parent(t){const e=this.props.parent;if(e!==t){if(this.props.parent=t,e){const t=e.children.indexOf(this);n(-1!==t,"CoreNode.parent: Node not found in old parent's children!"),e.children.splice(t,1)}t&&t.children.push(this),this.updateScaleRotateTransform()}}}let Dt=1;function Yt(){return Dt++}class Ot extends r{rendererMain;stage;id;coreNode;_children=[];_src="";_parent=null;_texture=null;_shader=null;constructor(t,e,n,r){super(),this.rendererMain=e,this.stage=n,this.id=r?.id??Yt(),this.coreNode=r||new $t(this.stage,{id:this.id,x:t.x,y:t.y,width:t.width,height:t.height,alpha:t.alpha,clipping:t.clipping,color:t.color,colorTop:t.colorTop,colorBottom:t.colorBottom,colorLeft:t.colorLeft,colorRight:t.colorRight,colorTl:t.colorTl,colorTr:t.colorTr,colorBl:t.colorBl,colorBr:t.colorBr,zIndex:t.zIndex,zIndexLocked:t.zIndexLocked,scaleX:t.scaleX,scaleY:t.scaleY,mountX:t.mountX,mountY:t.mountY,mount:t.mount,pivot:t.pivot,pivotX:t.pivotX,pivotY:t.pivotY,rotation:t.rotation,parent:null,shader:null,shaderProps:null,texture:null,textureOptions:null}),this.coreNode.on("loaded",this.onTextureLoaded),this.coreNode.on("failed",this.onTextureFailed),this.parent=t.parent,this.shader=t.shader,this.texture=t.texture,this.src=t.src}get x(){return this.coreNode.x}set x(t){this.coreNode.x=t}get y(){return this.coreNode.y}set y(t){this.coreNode.y=t}get width(){return this.coreNode.width}set width(t){this.coreNode.width=t}get height(){return this.coreNode.height}set height(t){this.coreNode.height=t}get alpha(){return this.coreNode.alpha}set alpha(t){this.coreNode.alpha=t}get clipping(){return this.coreNode.clipping}set clipping(t){this.coreNode.clipping=t}get color(){return this.coreNode.color}set color(t){this.coreNode.color=t}get colorTop(){return this.coreNode.colorTop}set colorTop(t){this.coreNode.colorTop=t}get colorBottom(){return this.coreNode.colorBottom}set colorBottom(t){this.coreNode.colorBottom=t}get colorLeft(){return this.coreNode.colorLeft}set colorLeft(t){this.coreNode.colorLeft=t}get colorRight(){return this.coreNode.colorRight}set colorRight(t){this.coreNode.colorRight=t}get colorTl(){return this.coreNode.colorTl}set colorTl(t){this.coreNode.colorTl=t}get colorTr(){return this.coreNode.colorTr}set colorTr(t){this.coreNode.colorTr=t}get colorBl(){return this.coreNode.colorBl}set colorBl(t){this.coreNode.colorBl=t}get colorBr(){return this.coreNode.colorBr}set colorBr(t){this.coreNode.colorBr=t}get scale(){return this.scaleX!==this.scaleY?null:this.coreNode.scaleX}set scale(t){null!==t&&(this.coreNode.scaleX=t,this.coreNode.scaleY=t)}get scaleX(){return this.coreNode.scaleX}set scaleX(t){this.coreNode.scaleX=t}get scaleY(){return this.coreNode.scaleY}set scaleY(t){this.coreNode.scaleY=t}get mount(){return this.coreNode.mount}set mount(t){this.coreNode.mount=t}get mountX(){return this.coreNode.mountX}set mountX(t){this.coreNode.mountX=t}get mountY(){return this.coreNode.mountY}set mountY(t){this.coreNode.mountY=t}get pivot(){return this.coreNode.pivot}set pivot(t){this.coreNode.pivot=t}get pivotX(){return this.coreNode.pivotX}set pivotX(t){this.coreNode.pivotX=t}get pivotY(){return this.coreNode.pivotY}set pivotY(t){this.coreNode.pivotY=t}get rotation(){return this.coreNode.rotation}set rotation(t){this.coreNode.rotation=t}get parent(){return this._parent}set parent(t){const e=this._parent;if(this._parent=t,this.coreNode.parent=t?.coreNode??null,e){const t=e.children.indexOf(this);n(-1!==t,"MainOnlyNode.parent: Node not found in old parent's children!"),e.children.splice(t,1)}t&&t.children.push(this)}get children(){return this._children}get zIndex(){return this.coreNode.zIndex}set zIndex(t){this.coreNode.zIndex=t}get zIndexLocked(){return this.coreNode.zIndexLocked}set zIndexLocked(t){this.coreNode.zIndexLocked=t}get src(){return this._src}set src(t){this._src!==t&&(this._src=t,this.texture=t?this.rendererMain.createTexture("ImageTexture",{src:t}):null)}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this.rendererMain.textureTracker.decrementTextureRefCount(this._texture),t&&this.rendererMain.textureTracker.incrementTextureRefCount(t),this._texture=t,t?this.coreNode.loadTexture(t.txType,t.props,t.options):this.coreNode.unloadTexture())}onTextureLoaded=(t,e)=>{this.emit("loaded",e)};onTextureFailed=(t,e)=>{this.emit("failed",e)};get shader(){return this._shader}set shader(t){this._shader!==t&&(this._shader=t,t&&this.coreNode.loadShader(t.shType,t.props))}destroy(){this.emit("beforeDestroy",{}),this.parent=null,this.texture=null,this.emit("afterDestroy",{}),this.removeAllListeners()}flush(){}animate(t,e){const n=new At(this.coreNode,t,e);return new Pt(this.stage.animationManager,n)}}class Xt{root;constructor(t){this.root=t}getNodeByType(t){return[]}getNodeById(t){return null}update(t){this.root.update(t)}}class jt extends s{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(t){const{gl:e}=this;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t[0].ctxTexture)}static shaderSources={vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n          vec4 color = texture2D(u_texture, v_textureCoordinate);\n          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);\n      }\n    "}}class Wt extends s{supportsIndexedTextures=!0;constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]})}bindTextures(t){const{renderer:e,gl:n}=this;if(t.length>e.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error(`DefaultShaderBatched: Cannot bind more than ${e.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS} textures`);t.forEach(((t,e)=>{n.activeTexture(n.TEXTURE0+e),n.bindTexture(n.TEXTURE_2D,t.ctxTexture)}));const r=Array.from(Array(t.length).keys());this.setUniform("u_textures[0]",r)}static shaderSources={vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      void main(){\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_textureIndex = a_textureIndex;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:t=>`\n      #define txUnits ${t}\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textures[txUnits];\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      vec4 sampleFromTexture(sampler2D textures[${t}], int idx, vec2 uv) {\n        ${Array.from(Array(t).keys()).map((t=>`\n          ${0!==t?"else ":""}if (idx == ${t}) {\n            return texture2D(textures[${t}], uv);\n          }\n        `)).join("")}\n        return texture2D(textures[0], uv);\n      }\n\n      void main(){\n        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);\n      }\n    `}}class Ut{priority=1;name="";ref;target;passParameters="";declaredUniforms="";uniformInfo={};static uniforms={};static methods;static onShaderMask;static onColorize;static onEffectMask;static getEffectKey(t){return""}static getMethodParameters(t,e){const n=[];for(const r in t){const o=t[r];let i="";o.size&&(i=`[${o.size(e)}]`),n.push(`${o.type} ${r}${i}`)}return n.join(",")}constructor(t){const{ref:e,target:n,props:r={}}=t;this.ref=e,this.target=n;const o={},i=[];let s="";const a=this.constructor.uniforms||{};for(const l in a){const t=a[l],n=t.type,c=`${e}_${l}`;let h="";t.size&&(h=`[${t.size(r)}]`),i.push(c),s+=`uniform ${n} ${c}${h};`,o[l]={name:c,uniform:a[l].method}}this.passParameters=i.join(","),this.declaredUniforms=s,this.uniformInfo=o}static resolveDefaults(t){return{}}static makeEffectKey(t){return!1}}class Ht extends Ut{static z$__type__Props;name="radius";static getEffectKey(){return"radius"}static uniforms={radius:{value:0,method:"uniform4fv",type:"vec4",validator:t=>{let e=t;return Array.isArray(e)?2===e.length?e=[e[0],e[1],e[0],e[1]]:3===e.length?e=[e[0],e[1],e[2],e[0]]:4!==e.length&&(e=[e[0],e[0],e[0],e[0]]):"number"==typeof e&&(e=[e,e,e,e]),e}}};static methods={fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "};static resolveDefaults(t){return{radius:t.radius??10}}static onShaderMask="\n  vec2 halfDimensions = u_dimensions * 0.5;\n  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);\n  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);\n  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);\n  ";static onEffectMask="\n  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));\n  "}class Gt extends Ut{static z$__type__Props;name="border";static getEffectKey(){return"border"}static resolveDefaults(t){return{width:t.width??10,color:t.color??4294967295}}static uniforms={width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>a(t),method:"uniform4fv",type:"vec4"}};static onEffectMask="\n  float mask = clamp(shaderMask + width, 0.0, 1.0) - clamp(shaderMask, 0.0, 1.0);\n  return mix(shaderColor, maskColor, mask);\n  ";static onColorize="\n    return color;\n  "}class Kt extends Ut{static z$__type__Props;name="linearGradient";static getEffectKey(t){return`linearGradient${t.colors.length}`}static resolveDefaults(t){const e=t.colors??[4278190080,4294967295];let n=t.stops;if(!n){n=[];const t=e.length-1;for(let r=0;r<e.length;r++)n.push(r*(1/t))}return{colors:e,stops:n,angle:t.angle??0}}static uniforms={angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:t=>t.map((t=>a(t))).reduce(((t,e)=>t.concat(e)),[]),size:t=>t.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],validator:(t,e)=>{const n=e.colors??[];let r=t;const o=t;if(0===r.length||r&&r.length!==n.length){for(let t=0;t<n.length;t++)r[t]?(o[t]=r[t],void 0===r[t-1]&&void 0!==o[t-2]&&(o[t-1]=o[t-2]+(r[t]-o[t-2])/2)):o[t]=t*(1/(n.length-1));r=o}return o},size:t=>t.colors.length,method:"uniform1fv",type:"float"}};static methods={fromLinear:"\n      vec4 function(vec4 linearRGB) {\n        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);\n        vec4 lower = linearRGB * vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",toLinear:"\n      vec4 function(vec4 sRGB) {\n        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));\n        vec4 lower = sRGB/vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",calcPoint:"\n      vec2 function(float d, float angle) {\n        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);\n      }\n    "};static ColorLoop=t=>{let e="";for(let n=2;n<t;n++)e+=`colorOut = mix(colorOut, colors[${n}], clamp((dist - stops[${n-1}]) / (stops[${n}] - stops[${n-1}]), 0.0, 1.0));`;return e};static onColorize=t=>`\n      float a = angle - (PI / 180.0 * 90.0);\n      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));\n      vec2 f = $calcPoint(lineDist * 0.5, a);\n      vec2 t = $calcPoint(lineDist * 0.5, a + PI);\n      vec2 gradVec = t - f;\n      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));\n      for(int i = 1; i < ${t.colors.length||1}-1; i++) {\n        stopCalc = (dist - stops[i]) / (stops[i + 1] - stops[i]);\n        colorOut = mix(colorOut, colors[i + 1], clamp(stopCalc, 0.0, 1.0));\n      }\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    `}class Vt extends Ut{name="grayscale";static getEffectKey(){return"grayscale"}static onColorize="\n    vec3 color = pow(maskColor.rgb, vec3(2.0));\n    float gray = dot(color, vec3(0.2126, 0.7152, 0.0722));\n    float gammaGray = sqrt(gray);\n    return vec4(gammaGray, gammaGray, gammaGray, 1.0);\n  "}class qt extends Ut{static z$__type__Props;name="borderRight";static getEffectKey(){return"borderRight"}static resolveDefaults(t){return{width:t.width??10,color:t.color??4294967295}}static uniforms={width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>a(t),method:"uniform4fv",type:"vec4"}};static methods={fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "};static onEffectMask="\n  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  ";static onColorize="\n    return color;\n  "}class Qt extends Ut{static z$__type__Props;name="borderTop";static getEffectKey(){return"borderTop"}static resolveDefaults(t){return{width:t.width??10,color:t.color??4294967295}}static uniforms={width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>a(t),method:"uniform4fv",type:"vec4"}};static methods={fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "};static onEffectMask="\n  vec2 pos = vec2(0.0, width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  ";static onColorize="\n    return color;\n  "}class Jt extends Ut{static z$__type__Props;name="borderBottom";static getEffectKey(){return"borderBottom"}static resolveDefaults(t){return{width:t.width??10,color:t.color??4294967295}}static uniforms={width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>a(t),method:"uniform4fv",type:"vec4"}};static methods={fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "};static onEffectMask="\n  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  ";static onColorize="\n    return color;\n  "}class Zt extends Ut{static z$__type__Props;name="borderLeft";static getEffectKey(){return"borderLeft"}static resolveDefaults(t){return{width:t.width??10,color:t.color??4294967295}}static uniforms={width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>a(t),method:"uniform4fv",type:"vec4"}};static methods={fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "};static onEffectMask="\n  vec2 pos = vec2(width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  ";static onColorize="\n    return color;\n  "}class te extends Ut{static z$__type__Props;name="glitch";static getEffectKey(t){return"glitch"}static resolveDefaults(t){return{amplitude:t.amplitude??.2,narrowness:t.narrowness??4,blockiness:t.blockiness??2,minimizer:t.minimizer??8,time:t.time??Date.now()}}static uniforms={amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",validator:t=>(Date.now()-t)%1e3,type:"float"}};static methods={rand:"\n      float function(vec2 p, float time) {\n        float t = floor(time * 20.) / 10.;\n        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);\n      }\n    ",noise:"\n      float function(vec2 uv, float blockiness, float time) {\n        vec2 lv = fract(uv);\n        vec2 id = floor(uv);\n\n        float n1 = rand(id, time);\n        float n2 = rand(id+vec2(1,0), time);\n        float n3 = rand(id+vec2(0,1), time);\n        float n4 = rand(id+vec2(1,1), time);\n        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);\n        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);\n      }\n    ",fbm:"\n      float function(vec2 uv, int count, float blockiness, float complexity, float time) {\n        float val = 0.0;\n        float amp = 0.5;\n        const int MAX_ITERATIONS = 10;\n\n        for(int i = 0; i < MAX_ITERATIONS; i++) {\n          if(i >= count) {break;}\n          val += amp * noise(uv, blockiness, time);\n          amp *= 0.5;\n          uv *= complexity;\n        }\n        return val;\n      }\n    "};static onColorize="\n    vec2 uv = v_textureCoordinate.xy;\n    float aspect = u_dimensions.x / u_dimensions.y;\n    vec2 a = vec2(uv.x * aspect , uv.y);\n    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));\n\n    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);\n    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);\n    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);\n    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);\n\n    vec3 f = vec3(colR, colG, colB);\n    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);\n  "}class ee extends Ut{static z$__type__Props;name="fadeOut";static getEffectKey(){return"fadeOut"}static uniforms={fade:{value:0,method:"uniform4fv",type:"vec4",validator:t=>{let e=t;return Array.isArray(e)?2===e.length?e=[e[0],e[1],e[0],e[1]]:3===e.length?e=[e[0],e[1],e[2],e[0]]:4!==e.length&&(e=[e[0],e[0],e[0],e[0]]):"number"==typeof e&&(e=[e,e,e,e]),e}}};static resolveDefaults(t){return{fade:t.fade??10}}static onColorize="\n  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;\n  vec2 pos1;\n  vec2 pos2;\n  vec2 d;\n  float c;\n  vec4 result = maskColor;\n\n\n  if(fade[0] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x, point.y + fade[0]);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[1] > 0.0) {\n    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);\n    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[2] > 0.0) {\n    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);\n    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[3] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x + fade[3], point.y);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  return result;\n  "}class ne extends Ut{static z$__type__Props;name="radialGradient";static getEffectKey(t){return`radialGradient${t.colors.length}`}static resolveDefaults(t){const e=t.colors??[4278190080,4294967295];let n=t.stops;if(!n){n=[];const t=e.length-1;for(let r=0;r<e.length;r++)n.push(r*(1/t))}return{colors:e,stops:n,width:t.width??0,height:t.height??t.width??0,pivot:t.pivot??[.5,.5]}}static uniforms={width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:t=>t.map((t=>a(t))).reduce(((t,e)=>t.concat(e)),[]),size:t=>t.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],validator:(t,e)=>{const n=e.colors??[];let r=t;const o=t;if(0===r.length||r&&r.length!==n.length){for(let t=0;t<n.length;t++)r[t]?(o[t]=r[t],void 0===r[t-1]&&void 0!==o[t-2]&&(o[t-1]=o[t-2]+(r[t]-o[t-2])/2)):o[t]=t*(1/(n.length-1));r=o}return o},size:t=>t.colors.length,method:"uniform1fv",type:"float"}};static onColorize=t=>`\n      vec2 point = v_textureCoordinate.xy * u_dimensions;\n      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);\n\n      float dist = length((point - projection) / vec2(width, height));\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = mix(colors[0], colors[1], stopCalc);\n      for(int i = 1; i < ${t.colors.length||1}-1; i++) {\n        stopCalc = (dist - stops[i]) / (stops[i + 1] - stops[i]);\n        colorOut = mix(colorOut, colors[i + 1], clamp(stopCalc, 0.0, 1.0));\n      }\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    `}const re={radius:Ht,border:Gt,borderBottom:Jt,borderLeft:Zt,borderRight:qt,borderTop:Qt,fadeOut:ee,linearGradient:Kt,radialGradient:ne,grayscale:Vt,glitch:te};class oe extends s{effects=[];constructor(t,e,n){const r=oe.createShader(e,n);super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...r.uniforms],shaderSources:{vertex:r.vertex,fragment:r.fragment}}),this.effects=r.effects}bindTextures(t){const{gl:e}=this;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t[0].ctxTexture)}bindProps(t){t.effects?.forEach(((t,e)=>{const n=this.effects[e],r=re[n.name],o=t.props??{},i=n.uniformInfo;Object.keys(o).forEach((t=>{const e=r.uniforms[t],n=i[t];let s=e.validator?e.validator(o[t],o):o[t];Array.isArray(s)&&(s=new Float32Array(s)),this.setUniform(n.name,s)}))}))}static createShader(t,e){const n={},r={};let o="";const i=[],s=[],a=t.effects.map((t=>{const r=e[t.type],a=r.getEffectKey(t.props||{});n[a]=n[a]?++n[a]:1;const l=n[a];1===l&&s.push({key:a,type:t.type,props:t.props});const c=new r({ref:`${a}${1===l?"":l}`,target:a,props:t.props});return o+=c.declaredUniforms,i.push(...Object.values(c.uniformInfo)),c}));let l="";s?.forEach((t=>{const n=e[t.type],o=n.resolveDefaults(t.props??{}),i=[];for(const e in n.methods){let t=e;const o=n.methods[e];r[e]&&r[e]!==o&&(t=oe.resolveMethodDuplicate(e,o,r)),r[t]=o.replace("function",t),i.push({m:e,cm:t})}let s=n.onShaderMask instanceof Function?n.onShaderMask(o):n.onShaderMask,a=n.onColorize instanceof Function?n.onColorize(o):n.onColorize,c=n.onEffectMask instanceof Function?n.onEffectMask(o):n.onEffectMask;i.forEach((t=>{const{m:e,cm:n}=t,r=new RegExp(`\\$${e}`,"g");s&&(s=s.replace(r,n)),a&&(a=a.replace(r,n)),c&&(c=c.replace(r,n))}));const h=n.getMethodParameters(n.uniforms,o),d=h.length>0?`, ${h}`:"";s&&(l+=`\n        float fx_${t.key}_onShaderMask(float shaderMask ${d}) {\n          ${s}\n        }\n        `),a&&(l+=`\n          vec4 fx_${t.key}_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor${d}) {\n            ${a}\n          }\n        `),c&&(l+=`\n          vec4 fx_${t.key}_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor${d}) {\n            ${c}\n          }\n        `)}));let c="";for(const u in r)c+=r[u];let h="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",d="\n\n    ";for(let u=0;u<a.length;u++){const t=a[u],e=t.passParameters.length>0?`, ${t.passParameters}`:"",n=re[t.name];n.onShaderMask&&(d+=`\n        shaderMask = fx_${t.target}_onShaderMask(shaderMask ${e});\n        `),n.onColorize&&(d+=`\n        maskColor = fx_${t.target}_onColorize(shaderMask, maskColor, shaderColor${e});\n        `),n.onEffectMask&&(h=`fx_${t.target}_onEffectMask(shaderMask, maskColor, shaderColor${e})`);const r=a[u+1];(void 0===r||re[r.name].onEffectMask)&&(d+=`\n          shaderColor = ${h};\n        `)}return{effects:a,uniforms:i,fragment:oe.fragment(o,c,l,d),vertex:oe.vertex()}}static resolveMethodDuplicate(t,e,n,r=0){const o=t+(r>0?r:"");return n[o]&&n[o]!==e?this.resolveMethodDuplicate(t,e,n,++r):o}static resolveDefaults(t,e){return{effects:(t.effects??[]).map((t=>({type:t.type,props:e[t.type].resolveDefaults(t.props||{})}))),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(t,e){let n="";return t.effects?.forEach((t=>{const r=e[t.type].getEffectKey(t.props||{});n+=`,${r}`})),`DynamicShader${n}`}static z$__type__Props;static vertex=()=>"\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    attribute vec2 a_textureCoordinate;\n    attribute vec2 a_position;\n    attribute vec4 a_color;\n    attribute float a_textureIndex;\n\n    uniform vec2 u_resolution;\n    uniform float u_pixelRatio;\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying float v_textureIndex;\n\n    void main(){\n      vec2 normalized = a_position * u_pixelRatio / u_resolution;\n      vec2 zero_two = normalized * 2.0;\n      vec2 clip_space = zero_two - 1.0;\n\n      // pass to fragment\n      v_color = a_color;\n      v_textureCoordinate = a_textureCoordinate;\n      v_textureIndex = a_textureIndex;\n\n      // flip y\n      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n    }\n  ";static fragment=(t,e,n,r)=>`\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    #define PI 3.14159265359\n\n    uniform vec2 u_resolution;\n    uniform vec2 u_dimensions;\n    uniform float u_alpha;\n    uniform float u_radius;\n    uniform sampler2D u_texture;\n    uniform float u_pixelRatio;\n\n    ${t}\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n\n    ${e}\n\n    ${n}\n\n    void main() {\n      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;\n      vec2 d = abs(p) - (u_dimensions) * 0.5;\n      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n\n      vec4 shaderColor = vec4(0.0);\n      float shaderMask = lng_DefaultMask;\n\n      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;\n\n      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));\n\n      ${r}\n\n      gl_FragColor = shaderColor * u_alpha;\n    }\n  `}class ie extends s{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static z$__type__Props;static resolveDefaults(t){return{radius:t.radius||10,$dimensions:{width:0,height:0}}}bindTextures(t){const{gl:e}=this;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t[0].ctxTexture)}bindProps(t){this.setUniform("u_radius",t.radius)}canBatchShaderProps(t,e){return t.radius===e.radius&&t.$dimensions.width===e.$dimensions.width&&t.$dimensions.height===e.$dimensions.height}static shaderSources={vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform vec2 u_dimensions;\n      uniform float u_radius;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      float boxDist(vec2 p, vec2 size, float radius){\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n\n      float fillMask(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n\n      void main() {\n        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;\n        vec2 halfDimensions = u_dimensions * 0.5;\n\n        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);\n        gl_FragColor = mix(vec4(0.0), color, fillMask(d));\n      }\n    "}}const se=new Float32Array([1,0,0,0,1,0,0,0,1]);class ae extends s{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(t){const{gl:e}=this;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t[0].ctxTexture)}bindProps(t){const e=ae.resolveDefaults(t);for(const n in e)if("transform"===n)this.setUniform("u_transform",!1,e[n]);else if("scrollY"===n)this.setUniform("u_scrollY",e[n]);else if("color"===n){const t=a(e.color);this.setUniform("u_color",t)}else"size"===n?this.setUniform("u_size",e[n]):"distanceRange"===n?this.setUniform("u_distanceRange",e[n]):"debug"===n&&this.setUniform("u_debug",e[n]?1:0)}static resolveDefaults(t={}){return{transform:t.transform??se,scrollY:t.scrollY??0,color:t.color??4294967295,size:t.size??16,distanceRange:t.distanceRange??1,debug:t.debug??!1}}static shaderSources={vertex:"\n      // an attribute is an input (in) to a vertex shader.\n      // It will receive data from a buffer\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform mat3 u_transform;\n      uniform float u_scrollY;\n      uniform float u_pixelRatio;\n      uniform float u_size;\n\n      varying vec2 v_texcoord;\n\n      void main() {\n        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);\n        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;\n        gl_Position = vec4((transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1), 0, 1);\n        v_texcoord = a_textureCoordinate;\n      }\n    ",fragment:"\n      precision highp float;\n\n      uniform vec4 u_color;\n      uniform sampler2D u_texture;\n      uniform float u_distanceRange;\n      uniform float u_pixelRatio;\n      uniform int u_debug;\n\n      varying vec2 v_texcoord;\n\n      float median(float r, float g, float b) {\n          return max(min(r, g), min(max(r, g), b));\n      }\n\n      void main() {\n          vec3 sample = texture2D(u_texture, v_texcoord).rgb;\n          if (u_debug == 1) {\n            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);\n            return;\n          }\n          float scaledDistRange = u_distanceRange * u_pixelRatio;\n          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);\n          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;\n\n          // Build the final color.\n          // IMPORTANT: We must premultiply the color by the alpha value before returning it.\n          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);\n      }\n    "}}class le{shCache=new Map;shConstructors={};attachedShader=null;effectConstructors={};renderer;constructor(){this.registerShaderType("DefaultShader",jt),this.registerShaderType("DefaultShaderBatched",Wt),this.registerShaderType("RoundedRectangle",ie),this.registerShaderType("DynamicShader",oe),this.registerShaderType("SdfShader",ae),this.registerEffectType("border",Gt),this.registerEffectType("borderBottom",Jt),this.registerEffectType("borderLeft",Zt),this.registerEffectType("borderRight",qt),this.registerEffectType("borderTop",Qt),this.registerEffectType("fadeOut",ee),this.registerEffectType("linearGradient",Kt),this.registerEffectType("radialGradient",ne),this.registerEffectType("grayscale",Vt),this.registerEffectType("glitch",te),this.registerEffectType("radius",Ht)}registerShaderType(t,e){this.shConstructors[t]=e}registerEffectType(t,e){this.effectConstructors[t]=e}loadShader(t,e){if(!this.renderer)throw new Error("Renderer is not been defined");const n=this.shConstructors[t];if(!n)throw new Error(`Shader type "${t}" is not registered`);if("DynamicShader"===t)return this.loadDynamicShader(e);const r=n.resolveDefaults(e),o=n.makeCacheKey(r)||n.name;if(o&&this.shCache.has(o))return{shader:this.shCache.get(o),props:r};const i=new n(this.renderer,e);return o&&this.shCache.set(o,i),{shader:i,props:r}}loadDynamicShader(t){if(!this.renderer)throw new Error("Renderer is not been defined");const e=oe.resolveDefaults(t,this.effectConstructors),n=oe.makeCacheKey(e,this.effectConstructors);if(n&&this.shCache.has(n))return{shader:this.shCache.get(n),props:e};const r=new oe(this.renderer,t,this.effectConstructors);return n&&this.shCache.set(n,r),{shader:r,props:e}}useShader(t){this.attachedShader!==t&&(this.attachedShader&&this.attachedShader.detach(),t.attach(),this.attachedShader=t)}}class ce{activeAnimations=new Set;registerAnimation(t){this.activeAnimations.add(t)}unregisterAnimation(t){this.activeAnimations.delete(t)}update(t){this.activeAnimations.forEach((e=>{e.update(t)}))}}class he extends l{props;constructor(t,e){super(t),this.props=he.resolveDefaults(e)}async getTextureData(){const{src:t,premultiplyAlpha:e}=this.props;if(!t)return{data:null};if(t instanceof ImageData)return{data:t,premultiplyAlpha:e};const n=await fetch(t),r=await n.blob();return{data:await createImageBitmap(r,{premultiplyAlpha:e?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"})}}static makeCacheKey(t){const e=he.resolveDefaults(t);return!(e.src instanceof ImageData)&&`ImageTexture,${e.src},${e.premultiplyAlpha}`}static resolveDefaults(t){return{src:t.src??"",premultiplyAlpha:t.premultiplyAlpha??!0}}static z$__type__Props}class de extends l{props;constructor(t,e){super(t),this.props=de.resolveDefaults(e)}async getTextureData(){const{width:t,height:e}=this.props,n=t*e*4,r=new Uint8ClampedArray(n);for(let o=0;o<n;o+=4){const t=Math.floor(256*Math.random());r[o]=t,r[o+1]=t,r[o+2]=t,r[o+3]=255}return{data:new ImageData(r,t,e)}}static makeCacheKey(t){const e=de.resolveDefaults(t);return`NoiseTexture,${e.width},${e.height},${e.cacheId}`}static resolveDefaults(t){return{width:t.width??128,height:t.height??128,cacheId:t.cacheId??0}}static z$__type__Props}class ue{usedMemory=0;txConstructors={};textureKeyCache=new Map;textureIdCache=new Map;ctxTextureCache=new WeakMap;textureRefCountMap=new WeakMap;renderer;constructor(){this.registerTextureType("ImageTexture",he),this.registerTextureType("ColorTexture",c),this.registerTextureType("NoiseTexture",de),this.registerTextureType("SubTexture",h)}registerTextureType(t,e){this.txConstructors[t]=e}loadTexture(t,e,n=null){const r=this.txConstructors[t];if(!r)throw new Error(`Texture type "${t}" is not registered`);let o;if(void 0!==n?.id&&this.textureIdCache.has(n.id)&&(o=this.textureIdCache.get(n.id)),!o){const t=n?.id,i=n?.cacheKey??r.makeCacheKey(e);o=i&&this.textureKeyCache.has(i)?this.textureKeyCache.get(i):new r(this,e),t&&this.addTextureIdToCache(t,i,o)}return n?.preload&&this.getCtxTexture(o).load(),o}addTextureIdToCache(t,e,n){const{textureIdCache:r,textureRefCountMap:o}=this;r.set(t,n),o.has(n)?o.get(n).count++:(o.set(n,{cacheKey:e,count:1}),e&&this.textureKeyCache.set(e,n))}removeTextureIdFromCache(t){const{textureIdCache:e,textureRefCountMap:r}=this,o=e.get(t);if(o&&(e.delete(t),r.has(o))){const t=r.get(o);n(t),t.count--,0===t.count&&(r.delete(o),t.cacheKey&&this.textureKeyCache.delete(t.cacheKey))}}getDebugInfo(){return{keyCacheSize:this.textureKeyCache.size,idCacheSize:this.textureIdCache.size}}getCtxTexture(t){if(this.ctxTextureCache.has(t))return this.ctxTextureCache.get(t);const e=this.renderer.createCtxTexture(t);return this.ctxTextureCache.set(t,e),e}}class fe{textRenderers;constructor(t){this.textRenderers=t}addFontFace(t){for(const e in this.textRenderers){const n=this.textRenderers[e];n&&n.isFontFaceSupported(t)&&n.addFontFace(t)}}static resolveFontFace(t,e){return t.reduce(((t,n)=>{if(t)return t;const r=n[e.fontFamily];if(!r)return;const o=new Set(r);for(const i of o)i.descriptors.stretch===e.fontStretch&&i.descriptors.style===e.fontStyle&&i.descriptors.weight===e.fontWeight||o.delete(i);return o.values().next().value}),void 0)||[][0]}}const pe={x:(t,e)=>{t.props.x=e},y:(t,e)=>{t.props.y=e},width:(t,e)=>{t.props.width=e},height:(t,e)=>{t.props.height=e},color:(t,e)=>{t.props.color=e},zIndex:(t,e)=>{t.props.zIndex=e},fontFamily:(t,e)=>{t.props.fontFamily=e},fontWeight:(t,e)=>{t.props.fontWeight=e},fontStyle:(t,e)=>{t.props.fontStyle=e},fontStretch:(t,e)=>{t.props.fontStretch=e},fontSize:(t,e)=>{t.props.fontSize=e},scaleX:(t,e)=>{t.props.scaleX=e},scaleY:(t,e)=>{t.props.scaleY=e},text:(t,e)=>{t.props.text=e},textAlign:(t,e)=>{t.props.textAlign=e},contain:(t,e)=>{t.props.contain=e},offsetY:(t,e)=>{t.props.offsetY=e},scrollable:(t,e)=>{t.props.scrollable=e},scrollY:(t,e)=>{t.props.scrollY=e},letterSpacing:(t,e)=>{t.props.letterSpacing=e},debug:(t,e)=>{t.props.debug=e}};class ge{stage;set;constructor(t){this.stage=t,this.set=Object.freeze({...pe,...this.getPropertySetters()})}setStatus(t,e,n){t.status!==e&&(t.status=e,t.emitter.emit(e,n))}}class me{iterator;peekBuffer=[];_lastIndex;constructor(t,e=0){this.iterator=t,this.iterator=t,this._lastIndex=e-1,this.peekBuffer=[]}next(){const t=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return t.done?this._lastIndex=-1:this._lastIndex++,t}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const t=this.iterator.next();return this.peekBuffer.push(t),t}get lastIndex(){return this._lastIndex}}function*xe(t,e=0){let n=e;for(;n<t.length;){const e=t.codePointAt(n);if(void 0===e)throw new Error("Invalid Unicode code point");yield e,n+=e<=65535?1:2}}function ye(t,e,r,o,i,s,a,l,c,h,d,u,f,p,g,m){n(p,"Font face must be loaded"),n(p.loaded,"Font face must be loaded"),n(p.data,"Font face must be loaded"),n(p.shaper,"Font face must be loaded");const x=p.data.info.size,y=l/x,v=s/y,_=c/y,w=u[t],b=w?.codepointIndex||0;let S=w?.maxX||0,T=w?.maxY||0,C=e,R=r,F=0;const E={codepointIndex:-1,bufferOffset:-1,xStart:-1},I=p.shaper,z={letterSpacing:_};let k,N=I.shapeText(z,new me(xe(o,b),b)),M=-1;const A=[],P=a/y,L=function(t,e,n){const r=n.shapeText(e,new me(xe(t,0),0));let o=0;for(const i of r)i.mapped&&(o+=i.xAdvance);return o}("...",z,I);let B=!0;for(;B;){const e="both"!==d||m||R+x+x<=P,n=e?v:v-L;let r=0;for(;(k=N.next())&&!k.done;){const i=k.value;if(t===u.length)u.push({codepointIndex:i.cluster,maxY:T,maxX:S});else if(t>u.length)throw new Error("Unexpected lineCache length");if(32===i.codepoint||10===i.codepoint?-1!==E.codepointIndex&&(E.codepointIndex=-1,r=C):-1===E.codepointIndex&&(E.codepointIndex=i.cluster,E.bufferOffset=F,E.xStart=r),i.mapped){const t=C+i.xOffset+i.width;if("none"!==d&&t>=n&&-1!==E.codepointIndex&&E.codepointIndex<i.cluster&&E.xStart>0){if(e){N=I.shapeText(z,new me(xe(o,E.codepointIndex),E.codepointIndex)),F=E.bufferOffset;break}N=I.shapeText(z,new me(xe("...",0),0)),C=E.xStart,F=E.bufferOffset}else{const t=C+i.xOffset,e=R+i.yOffset,n=!f||R+x>=f.y1/y,r=!f||R<=f.y2/y;if(n&&r){-1===M&&(M=F);const n=p.getAtlasEntry(i.glyphId),r=n.x/p.data.common.scaleW,o=n.y/p.data.common.scaleH,s=n.width/p.data.common.scaleW,a=n.height/p.data.common.scaleH;h[F++]=t,h[F++]=e,h[F++]=r,h[F++]=o,h[F++]=t+i.width,h[F++]=e,h[F++]=r+s,h[F++]=o,h[F++]=t,h[F++]=e+i.height,h[F++]=r,h[F++]=o+a,h[F++]=t+i.width,h[F++]=e+i.height,h[F++]=r+s,h[F++]=o+a}T=Math.max(T,e+i.height),C+=i.xAdvance,S=Math.max(S,C)}}else if(10===i.codepoint)break}-1!==M&&(A.push({bufferStart:M,bufferEnd:F}),M=-1),C=0,R+=x,t++,E.codepointIndex=-1,r=0,!g&&"both"===d&&f&&R>f.y2/y||k&&k.done?B=!1:"both"!==d||m||e||(B=!1)}if("center"===i){const t="none"===d?S:v;for(let e=0;e<A.length;e++){const n=A[e],r=(t-(h[n.bufferEnd-4]-h[n.bufferStart]))/2;for(let t=n.bufferStart;t<n.bufferEnd;t+=4)h[t]+=r}}else if("right"===i){const t="none"===d?S:v;for(let e=0;e<A.length;e++){const n=A[e],r=t-(n.bufferEnd===n.bufferStart?0:h[n.bufferEnd-4]-h[n.bufferStart]);for(let t=n.bufferStart;t<n.bufferEnd;t+=4)h[t]+=r}}return n(k),{bufferNumFloats:F,bufferNumQuads:F/16,layoutNumCharacters:k.done?o.length-b:k.value.cluster-b+1,fullyProcessed:!!k.done,maxX:S,maxY:T}}class ve extends ge{ssdfFontFamilies={};msdfFontFamilies={};sdfShader;constructor(t){super(t),this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader}getPropertySetters(){return{fontFamily:(t,e)=>{t.props.fontFamily=e,t.trFontFace=void 0,this.invalidateCache(t)},fontWeight:(t,e)=>{t.props.fontWeight=e,t.trFontFace=void 0,this.invalidateCache(t)},fontStyle:(t,e)=>{t.props.fontStyle=e,t.trFontFace=void 0,this.invalidateCache(t)},fontStretch:(t,e)=>{t.props.fontStretch=e,t.trFontFace=void 0,this.invalidateCache(t)},fontSize:(t,e)=>{t.props.fontSize=e,this.invalidateCache(t)},text:(t,e)=>{t.props.text=e,this.invalidateCache(t)},textAlign:(t,e)=>{t.props.textAlign=e,this.invalidateCache(t)},color:(t,e)=>{t.props.color=e},x:(t,e)=>{t.props.x=e},y:(t,e)=>{t.props.y=e},contain:(t,e)=>{t.props.contain=e,this.invalidateCache(t)},width:(t,e)=>{t.props.width=e,this.invalidateCache(t)},height:(t,e)=>{t.props.height=e,this.invalidateCache(t)},offsetY:(t,e)=>{t.props.offsetY=e,this.invalidateCache(t)},scrollable:(t,e)=>{t.props.scrollable=e,this.invalidateCache(t)},scrollY:(t,e)=>{t.props.scrollY=e},letterSpacing:(t,e)=>{t.props.letterSpacing=e,this.invalidateCache(t)},debug:(t,e)=>{t.props.debug=e}}}canRenderFont(t){const{fontFamily:e}=t;return e in this.ssdfFontFamilies||e in this.msdfFontFamilies||"$$SDF_FAILURE_TEST$$"===e}isFontFaceSupported(t){return t instanceof u}addFontFace(t){n(t instanceof u);const e=t.fontFamily,r="ssdf"===t.type?this.ssdfFontFamilies:"msdf"===t.type?this.msdfFontFamilies:void 0;if(!r)return void console.warn(`Invalid font face type: ${t.type}`);let o=r[e];o||(o=new Set,r[e]=o),o.add(t)}createState(t){return{props:t,status:"initialState",emitter:new r,lineCache:[],forceFullLayoutCalc:!1,renderWindow:void 0,bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(t){performance.now();let{trFontFace:e}=t;const{textH:r,lineCache:o,debugData:i,forceFullLayoutCalc:s}=t;if(i.updateCount++,"initialState"===t.status&&this.setStatus(t,"loading"),!e&&(e=this.resolveFontFace(t.props),t.trFontFace=e,!e)){const e=`SdfTextRenderer: Could not resolve font face for family: '${t.props.fontFamily}'`;return console.error(e),void this.setStatus(t,"failed",new Error(e))}if(!e.loaded)return void e.on("loaded",(function n(){t.emitter.emit("fontLoaded",{}),e?.off("fontLoaded",n)}));n(e.data,"Font face data should be loaded");const{text:a,fontSize:l,x:c,y:h,contain:u,width:p,height:g,scrollable:m}=t.props,x="both"===u&&m?t.props.scrollY:0;let{renderWindow:y}=t;const v=e.data.info.size,_=l/v;t.distanceRange=_*e.data.distanceField.distanceRange;const w=24*a.length;let b=t.vertexBuffer;(!b||b.length<w)&&(b=new Float32Array(2*w));const S={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight},T=f(S,{x1:c,y1:h,x2:"none"!==u?c+p:1/0,y2:"both"===u?h+g:1/0});if(!s&&y){if(c+y.x1<=T.x1&&c+y.x2>=T.x2&&h-x+y.y1<=T.y1&&h-x+y.y2>=T.y2)return;t.renderWindow=y=void 0}const{offsetY:C,textAlign:R}=t.props;if(!y){const t=T.y2-T.y1;y=function(t,e,n,r,o,i){const s=r*o,a=i.x1-t,l=i.y1-e;return d(i)?{x1:a,y1:l+n-s,x2:a+(i.x2-i.x1),y2:l+n+(i.y2-i.y1)+s}:{x1:0,y1:0,x2:0,y2:0}}(c,h,x,v,Math.ceil(t/v),T)}const F=function(t,e,n,r,o,i,s){let a=0;o&&(a=Math.min(Math.max(Math.floor(o.y1/t),0),i.length));const l=e/n+a*r;if(!(s&&l>=s/n))return{x:0,y:l,lineIndex:a}}(l,C,_,v,y,o,r);if(!F)return void this.setStatus(t,"loaded");const{letterSpacing:E}=t.props,I=ye(F.lineIndex,F.x,F.y,a,R,p,g,l,E,b,u,o,y,e,s,m);t.bufferUploaded=!1,t.bufferNumFloats=I.bufferNumFloats,t.bufferNumQuads=I.bufferNumQuads,t.vertexBuffer=b,t.renderWindow=y,i.lastLayoutNumCharacters=I.layoutNumCharacters,i.bufferSize=b.byteLength,I.fullyProcessed&&(t.textW=I.maxX*_,t.textH=I.maxY*_),this.setStatus(t,"loaded")}renderQuads(t,e,r,o){if(!t.vertexBuffer)return;performance.now();const{renderer:i}=this.stage;this.stage.options;const{fontSize:s,color:a,contain:l,scrollable:c,zIndex:h,debug:d}=t.props,u="both"===l&&c?t.props.scrollY:0,{textW:f=0,textH:x=0,distanceRange:y,vertexBuffer:v,bufferNumFloats:_,bufferUploaded:w,renderWindow:b,debugData:S,trFontFace:T}=t;let{webGlBuffers:C}=t;if(!C){const e=i.gl,r=4*Float32Array.BYTES_PER_ELEMENT,o=e.createBuffer();n(o),t.webGlBuffers=new p([{buffer:o,attributes:{a_position:{name:"a_position",size:2,type:e.FLOAT,normalized:!1,stride:r,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:e.FLOAT,normalized:!1,stride:r,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),t.bufferUploaded=!1,n(t.webGlBuffers),C=t.webGlBuffers}if(!w){const e=i.gl,n=C?.getBuffer("a_textureCoordinate")??null;e.bindBuffer(e.ARRAY_BUFFER,n),e.bufferData(e.ARRAY_BUFFER,v,e.STATIC_DRAW),t.bufferUploaded=!0}n(T);const R=new g(i.gl,i.options,C,this.sdfShader,{transform:e.data,color:m(a,o),size:s/(T.data?.info.size||0),scrollY:u,distanceRange:y,debug:d.sdfShaderDebug},o,r,{height:x,width:f},0,h),F=t.trFontFace?.texture;n(F);const E=this.stage.txManager.getCtxTexture(F);R.addTexture(E),R.length=t.bufferNumFloats,R.numQuads=t.bufferNumQuads,i.addRenderable(R)}resolveFontFace(t){return fe.resolveFontFace([this.msdfFontFamilies,this.ssdfFontFamilies],t)}invalidateCache(t){t.renderWindow=void 0,t.textH=void 0,t.textW=void 0,t.lineCache=[],this.setStatus(t,"loading")}}class _e{_canvas;_context;_settings;renderInfo;constructor(t,e){this._canvas=t,this._context=e,this._settings=this.mergeDefaults({})}set settings(t){this._settings=this.mergeDefaults(t)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const t=[this._settings.fontFace],e=[];for(let n=0,r=t.length;n<r;n++)"serif"===t[n]||"sans-serif"===t[n]?e.push(t[n]):e.push(`"${t[n]}"`);return`${this._settings.fontStyle} ${this._settings.fontSize*this.getPrecision()}px ${e.join(",")}`}_load(){if(document.fonts){const e=this._getFontSetting();try{if(!document.fonts.check(e,this._settings.text))return document.fonts.load(e,this._settings.text).catch((t=>{console.warn("[Lightning] Font load error",t,e)})).then((()=>{document.fonts.check(e,this._settings.text)||console.warn("[Lightning] Font not found",e)}))}catch(t){console.warn("[Lightning] Can't check font loading for "+e)}}}calculateRenderInfo(){const t={},e=this.getPrecision(),n=this._settings.paddingLeft*e,r=this._settings.paddingRight*e,o=this._settings.fontSize*e;let i=null===this._settings.offsetY?null:this._settings.offsetY*e,s=(this._settings.lineHeight||o)*e;const a=this._settings.w*e,l=this._settings.h*e;let c=this._settings.wordWrapWidth*e;const h=this._settings.cutSx*e,d=this._settings.cutEx*e,u=this._settings.cutSy*e,f=this._settings.cutEy*e,p=(this._settings.letterSpacing||0)*e,g=this._settings.textIndent*e;this.setFontProperties();let m,x=a||2048/this.getPrecision(),y=x-n;if(y<10&&(x+=10-y,y=10),c||(c=y),this._settings.textOverflow&&!this._settings.wordWrap){let t;switch(this._settings.textOverflow){case"clip":t="";break;case"ellipsis":t=this._settings.maxLinesSuffix;break;default:t=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,c-g,t)}if(this._settings.wordWrap)m=this.wrapText(this._settings.text,c,p,g);else{m={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const t=m.l.length;for(let e=0;e<t-1;e++)m.n.push(e)}let v=m.l;if(this._settings.maxLines&&v.length>this._settings.maxLines){const e=v.slice(0,this._settings.maxLines);let n,r=null;if(this._settings.maxLinesSuffix){const t=this._settings.maxLinesSuffix?this.measureText(this._settings.maxLinesSuffix):0,n=this.wrapText(e[e.length-1],c-t,p,g);e[e.length-1]=`${n.l[0]}${this._settings.maxLinesSuffix}`,r=[n.l.length>1?n.l[1]:""]}else r=[""];const o=v.length;let i=0;const s=m.n.length;for(n=this._settings.maxLines;n<o;n++)r[i]+=`${r[i]?" ":""}${v[n]}`,n+1<s&&m.n[n+1]&&i++;t.remainingText=r.join("\n"),t.moreTextLines=!0,v=e}else t.moreTextLines=!1,t.remainingText="";let _=0;const w=[];for(let S=0;S<v.length;S++){const t=this.measureText(v[S],p)+(0===S?g:0);w.push(t),_=Math.max(_,t)}let b;if(t.lineWidths=w,a||(x=_+n+r,y=_),s=s||o,l)b=l;else{const t="bottom"!=this._settings.textBaseline?.5*o:0;b=s*(v.length-1)+t+Math.max(s,o)+(i||0)}return null===i&&(i=o),t.w=x,t.h=b,t.lines=v,t.precision=e,x||(x=1),b||(b=1),(h||d)&&(x=Math.min(x,d-h)),(u||f)&&(b=Math.min(b,f-u)),t.width=x,t.innerWidth=y,t.height=b,t.fontSize=o,t.cutSx=h,t.cutSy=u,t.cutEx=d,t.cutEy=f,t.lineHeight=s,t.lineWidths=w,t.offsetY=i,t.paddingLeft=n,t.paddingRight=r,t.letterSpacing=p,t.textIndent=g,t}draw(t,e){const n=this.getPrecision(),r=e?.lines||t.lines,o=e?.lineWidths||t.lineWidths,i=e?e.lines.length*t.lineHeight:t.height;let s,a;this._canvas.width=Math.min(Math.ceil(t.width+this._settings.textRenderIssueMargin),2048),this._canvas.height=Math.min(Math.ceil(i),2048),this.setFontProperties(),t.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(t.cutSx||t.cutSy)&&this._context.translate(-t.cutSx,-t.cutSy);const l=[];for(let h=0,d=r.length;h<d;h++)s=0===h?t.textIndent:0,a=h*t.lineHeight+t.offsetY,"middle"==this._settings.verticalAlign?a+=(t.lineHeight-t.fontSize)/2:"bottom"==this._settings.verticalAlign&&(a+=t.lineHeight-t.fontSize),"right"===this._settings.textAlign?s+=t.innerWidth-o[h]:"center"===this._settings.textAlign&&(s+=(t.innerWidth-o[h])/2),s+=t.paddingLeft,l.push({text:r[h],x:s,y:a,w:o[h]});if(this._settings.highlight){const e=this._settings.highlightColor,r=this._settings.highlightHeight*n||1.5*t.fontSize,o=this._settings.highlightOffset*n,i=null!==this._settings.highlightPaddingLeft?this._settings.highlightPaddingLeft*n:t.paddingLeft,s=null!==this._settings.highlightPaddingRight?this._settings.highlightPaddingRight*n:t.paddingRight;this._context.fillStyle=x(e);for(let n=0;n<l.length;n++){const e=l[n];this._context.fillRect(e.x-i,e.y-t.offsetY+o,e.w+s+i,r)}}let c=null;this._settings.shadow&&(c=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=x(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*n,this._context.shadowOffsetY=this._settings.shadowOffsetY*n,this._context.shadowBlur=this._settings.shadowBlur*n),this._context.fillStyle=x(this._settings.textColor);for(let h=0,d=l.length;h<d;h++){const e=l[h];if(0===t.letterSpacing)this._context.fillText(e.text,e.x,e.y);else{const n=e.text.split("");let r=e.x;for(let o=0,i=n.length;o<i;o++)this._context.fillText(n[o],r,e.y),r+=this.measureText(n[o],t.letterSpacing)}}c&&(this._context.shadowColor=c[0],this._context.shadowOffsetX=c[1],this._context.shadowOffsetY=c[2],this._context.shadowBlur=c[3]),(t.cutSx||t.cutSy)&&this._context.translate(t.cutSx,t.cutSy),this.renderInfo=t}wrapWord(t,e,n){const r=this._context.measureText(n).width,o=t.length,i=this._context.measureText(t).width;if(i<=e)return t;let s=Math.floor(e*o/i),a=this._context.measureText(t.substring(0,s)).width+r;if(a>e)for(;s>0&&(a=this._context.measureText(t.substring(0,s)).width+r,a>e);)s-=1;else for(;s<o;){if(a=this._context.measureText(t.substring(0,s)).width+r,!(a<e)){s-=1;break}s+=1}return t.substring(0,s)+(e>=r?n:"")}wrapText(t,e,n,r=0){const o=t.split(/\r?\n/g);let i=[];const s=[];for(let a=0;a<o.length;a++){const t=[];let l="",c=e-r;const h=o[a].split(" ");for(let o=0;o<h.length;o++){const i=this.measureText(h[o],n),s=i+this.measureText(" ",n);0===o||s>c?(o>0&&(t.push(l),l=""),l+=h[o],c=e-i-(0===o?r:0)):(c-=s,l+=` ${h[o]}`)}t.push(l),l="",i=i.concat(t),a<o.length-1&&s.push(i.length)}return{l:i,n:s}}measureText(t,e=0){return e?t.split("").reduce(((t,n)=>t+this._context.measureText(n).width+e),0):this._context.measureText(t).width}mergeDefaults(t){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxLinesSuffix:"..",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...t}}}const we="undefined"==typeof self?globalThis:self,be=we.document?.fonts||we.fonts;class Se extends ge{canvas;context;constructor(t){super(t),"undefined"!=typeof OffscreenCanvas?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let e=this.canvas.getContext("2d");e||(this.canvas=document.createElement("canvas"),e=this.canvas.getContext("2d")),n(e),this.context=e}getPropertySetters(){return{fontFamily:(t,e)=>{t.props.fontFamily=e,t.fontInfo=void 0,this.markForReload(t)},fontWeight:(t,e)=>{t.props.fontWeight=e,t.fontInfo=void 0,this.markForReload(t)},fontStyle:(t,e)=>{t.props.fontStyle=e,t.fontInfo=void 0,this.markForReload(t)},fontStretch:(t,e)=>{t.props.fontStretch=e,t.fontInfo=void 0,this.markForReload(t)},fontSize:(t,e)=>{t.props.fontSize=e,t.fontInfo=void 0,this.markForReload(t)},text:(t,e)=>{t.props.text=e,this.markForReload(t)},textAlign:(t,e)=>{t.props.textAlign=e,this.markForReload(t)},color:(t,e)=>{t.props.color=e,this.markForReload(t)},x:(t,e)=>{t.props.x=e},y:(t,e)=>{t.props.y=e},contain:(t,e)=>{t.props.contain=e,this.markForReload(t)},width:(t,e)=>{t.props.width=e,this.markForReload(t)},height:(t,e)=>{t.props.height=e,this.markForReload(t)},offsetY:(t,e)=>{t.props.offsetY=e,this.markForReload(t)},scrollY:(t,e)=>{t.props.scrollY=e},letterSpacing:(t,e)=>{t.props.letterSpacing=e,this.markForReload(t)}}}canRenderFont(t){return!0}isFontFaceSupported(t){return t instanceof y}addFontFace(t){n(t instanceof y),be.add(t.fontFace)}createState(t){return{props:t,status:"initialState",emitter:new r,canvasPages:void 0,lightning2TextRenderer:new _e(this.canvas,this.context),renderWindow:void 0,renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,fontFaceLoadedHandler:void 0,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(t){if("initialState"===t.status&&this.setStatus(t,"loading"),!t.fontInfo){const e=function(t){const{fontFamily:e,fontStyle:n,fontWeight:r,fontStretch:o,fontSize:i}=t;return[n,r,o,`${i}px`,e].join(" ")}(t.props);if(t.fontInfo={cssString:e,loaded:!1},!t.fontInfo.loaded)return void be.load(e).then(this.onFontLoaded.bind(this,t,e)).catch(this.onFontLoadError.bind(this,t,e))}if(!t.fontInfo.loaded)return;if(!t.renderInfo){t.lightning2TextRenderer.settings={text:t.props.text,textAlign:t.props.textAlign,fontFace:t.props.fontFamily,fontSize:t.props.fontSize,fontStyle:[t.props.fontStretch,t.props.fontStyle,t.props.fontWeight].join(" "),textColor:a(t.props.color),offsetY:t.props.fontSize+t.props.offsetY,wordWrap:"none"!==t.props.contain,wordWrapWidth:"none"===t.props.contain?void 0:t.props.width,letterSpacing:t.props.letterSpacing};const e=performance.now();t.renderInfo=t.lightning2TextRenderer.calculateRenderInfo(),console.log("Render info calculated in",performance.now()-e,"ms"),t.textH=t.renderInfo.lineHeight*t.renderInfo.lines.length,t.textW=t.renderInfo.width,t.renderWindow=void 0}const{x:e,y:n,width:r,height:o,scrollY:i,contain:s}=t.props;let{renderWindow:l,canvasPages:c}=t;const h={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight},d=f(h,{x1:e,y1:n,x2:"none"!==s?e+r:1/0,y2:"both"===s?n+o:1/0}),u=d.y2-d.y1,p=Math.ceil(u/t.renderInfo.lineHeight);if(l&&c){const r=e+l.x1,o=n-i+l.y1,s=e+l.x2,a=n-i+l.y2;if(r<=d.x1&&s>=d.x2&&o<=d.y1&&a>=d.y2)return;a<d.y2?(l.y1+=p*t.renderInfo.lineHeight,l.y2+=p*t.renderInfo.lineHeight,c.push(c.shift()),c[2].lineNumStart=c[1].lineNumStart+p,c[2].lineNumEnd=c[2].lineNumStart+p,c[2].valid=!1):o>d.y1&&(l.y1-=p*t.renderInfo.lineHeight,l.y2-=p*t.renderInfo.lineHeight,c.unshift(c.pop()),c[0].lineNumStart=c[1].lineNumStart-p,c[0].lineNumEnd=c[0].lineNumStart+p,c[0].valid=!1)}else{const e=t.renderInfo.lineHeight*p,n=Math.ceil(i/e)*p,o=n-p,s=n+p;c=[{texture:c?.[0].texture,lineNumStart:o,lineNumEnd:o+p,valid:!1},{texture:c?.[1].texture,lineNumStart:n,lineNumEnd:n+p,valid:!1},{texture:c?.[2].texture,lineNumStart:s,lineNumEnd:s+p,valid:!1}],t.canvasPages=c;const a=Math.ceil(i/e)*e;l={x1:0,y1:a-e,x2:r,y2:a+2*e}}t.renderWindow=l;const g=performance.now();for(const a of c)a.valid||(a.lineNumStart<0?(a.texture=this.stage.txManager.loadTexture("ImageTexture",{src:""}),a.valid=!0):(t.lightning2TextRenderer.draw(t.renderInfo,{lines:t.renderInfo.lines.slice(a.lineNumStart,a.lineNumEnd),lineWidths:t.renderInfo.lineWidths.slice(a.lineNumStart,a.lineNumEnd)}),0!==this.canvas.width&&0!==this.canvas.height&&(a.texture=this.stage.txManager.loadTexture("ImageTexture",{src:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)},{preload:!0})),a.valid=!0));console.log("pageDrawTime",performance.now()-g,"ms"),this.setStatus(t,"loaded")}renderQuads(t,e,r,o){const{stage:i}=this,{canvasPages:s,textW:a=0,textH:l=0,renderWindow:c}=t;if(!s||!c)return;const{x:h,y:d,scrollY:u,contain:f,width:p,height:g}=t.props,m={x:h,y:d,width:"none"!==f?p:a,height:"both"===f?g:l};v({x:0,y:0,width:i.options.appWidth,height:i.options.appHeight},m),n(s,"canvasPages is not defined"),n(c,"renderWindow is not defined");const x=(c.y2-c.y1)/3,{zIndex:y,color:w}=t.props,b=o*_(w);s[0].valid&&this.stage.renderer.addRenderable({alpha:b,clippingRect:r,colorBl:4294967295,colorBr:4294967295,colorTl:4294967295,colorTr:4294967295,width:s[0].texture?.dimensions?.width||0,height:s[0].texture?.dimensions?.height||0,texture:s[0].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:y,tx:e.tx,ty:e.ty-u+c.y1,ta:e.ta,tb:e.tb,tc:e.tc,td:e.td}),s[1].valid&&this.stage.renderer.addRenderable({alpha:b,clippingRect:r,colorBl:4294967295,colorBr:4294967295,colorTl:4294967295,colorTr:4294967295,width:s[1].texture?.dimensions?.width||0,height:s[1].texture?.dimensions?.height||0,texture:s[1].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:y,tx:e.tx,ty:e.ty-u+c.y1+x,ta:e.ta,tb:e.tb,tc:e.tc,td:e.td}),s[2].valid&&this.stage.renderer.addRenderable({alpha:b,clippingRect:r,colorBl:4294967295,colorBr:4294967295,colorTl:4294967295,colorTr:4294967295,width:s[2].texture?.dimensions?.width||0,height:s[2].texture?.dimensions?.height||0,texture:s[2].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:y,tx:e.tx,ty:e.ty-u+c.y1+x+x,ta:e.ta,tb:e.tb,tc:e.tc,td:e.td})}markForReload(t){t.renderInfo=void 0,this.setStatus(t,"loading")}onFontLoaded(t,e){e===t.fontInfo?.cssString&&t.fontInfo&&(t.fontInfo.loaded=!0,this.updateState(t))}onFontLoadError(t,e,n){e===t.fontInfo?.cssString&&t.fontInfo&&(t.fontInfo.loaded=!0,console.error(`CanvasTextRenderer: Error loading font '${t.fontInfo.cssString}'`,n),this.updateState(t))}}class Te{options;animationManager;txManager;fontManager;textRenderers;shManager;renderer;scene;deltaTime=0;lastFrameTime=0;currentFrameTime=0;constructor(t){this.options=t;const{canvas:e,clearColor:r,rootId:o,debug:i,appWidth:s,appHeight:a}=t;this.txManager=new ue,this.shManager=new le,this.animationManager=new ce,i?.monitorTextureCache&&setInterval((()=>{n(this.txManager);const t=this.txManager.getDebugInfo();console.log("Texture ID Cache Size: ",t.idCacheSize),console.log("Texture Key Cache Size: ",t.keyCacheSize)}),1e3),this.renderer=new w({stage:this,canvas:e,pixelRatio:t.devicePhysicalPixelRatio*t.deviceLogicalPixelRatio,clearColor:r??4278190080,bufferMemory:2e6,txManager:this.txManager,shManager:this.shManager}),this.txManager.renderer=this.renderer,this.textRenderers={canvas:new Se(this),sdf:new ve(this)},this.fontManager=new fe(this.textRenderers);const l=new $t(this,{id:o,x:0,y:0,width:s,height:a,alpha:1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null});this.scene=new Xt(l),(t=>{const e=()=>{t.drawFrame(),requestAnimationFrame(e)};requestAnimationFrame(e)})(this)}drawFrame(){const{renderer:t,scene:e,animationManager:n}=this;e?.root&&(this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=performance?performance.now():Date.now(),this.deltaTime=this.lastFrameTime?this.currentFrameTime-this.lastFrameTime:100/6,n.update(this.deltaTime),t?.reset(),e?.root?.hasUpdates&&e?.root?.update(this.deltaTime),this.addQuads(e.root),t?.sortRenderables(),t?.render())}addQuads(t,e=null){n(this.renderer&&t.globalTransform);const r=t.globalTransform,o=0!==r.tb||0!==r.tc;let i=t.clipping&&!o?{x:r.tx,y:r.ty,width:t.width*r.ta,height:t.height*r.td}:null;e&&i?i=v(e,i):e&&(i=e),t.renderQuads(this.renderer,i),t.children.forEach((t=>{0!==t.worldAlpha&&this.addQuads(t,i)}))}resolveTextRenderer(t,e=null){let r=e,o=!1;if(r){const e=this.textRenderers[r];e?e.canRenderFont(t)||(console.warn(`Cannot use override text renderer '${r}' for font`,t),r=null,o=!0):(console.warn(`Text renderer override '${r}' not found.`),r=null,o=!0)}if(!r){for(const[e,n]of Object.entries(this.textRenderers))if("canvas"!==e&&n.canRenderFont(t)){r=e;break}r||(r="canvas")}o&&console.warn(`Falling back to text renderer ${String(r)}`);const i=this.textRenderers[r];return n(i,"resolvedTextRenderer undefined"),i}get root(){return this.scene?.root||null}}class Ce extends $t{textRenderer;trState;updateScheduled;_textRendererOverride=null;constructor(t,e){super(t,e),this.updateScheduled=!1,this._textRendererOverride=e.textRendererOverride;const{resolvedTextRenderer:n,textRendererState:r}=this.resolveTextRendererAndState({x:this.absX,y:this.absY,width:e.width,height:e.height,textAlign:e.textAlign,color:e.color,zIndex:e.zIndex,contain:e.contain,scaleX:e.scaleX,scaleY:e.scaleY,scrollable:e.scrollable,scrollY:e.scrollY,offsetY:e.offsetY,letterSpacing:e.letterSpacing,debug:e.debug,fontFamily:e.fontFamily,fontSize:e.fontSize,fontStretch:e.fontStretch,fontStyle:e.fontStyle,fontWeight:e.fontWeight,text:e.text},void 0);this.textRenderer=n,this.trState=r}onTextLoaded=()=>{const{contain:t}=this,e=this.trState.props.width,n=this.trState.props.height,r=this.trState.textW||0,o=this.trState.textH||0;"both"===t?(this.props.width=e,this.props.height=n):"width"===t?(this.props.width=e,this.props.height=o):"none"===t&&(this.props.width=r,this.props.height=o),this.updateLocalTransform(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})};onTextFailed=(t,e)=>{this.emit("failed",{type:"text",error:e})};get width(){return this.trState.props.width}set width(t){this.textRenderer.set.width(this.trState,t),this.updateText()}get height(){return this.trState.props.height}set height(t){this.textRenderer.set.height(this.trState,t),this.updateText()}get color(){return this.trState.props.color}set color(t){this.textRenderer.set.color(this.trState,t),this.updateText()}get text(){return this.trState.props.text}set text(t){this.textRenderer.set.text(this.trState,t),this.updateText()}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(t){this._textRendererOverride=t;const{resolvedTextRenderer:e,textRendererState:n}=this.resolveTextRendererAndState(this.trState.props,this.trState);this.textRenderer=e,this.trState=n}get fontSize(){return this.trState.props.fontSize}set fontSize(t){this.textRenderer.set.fontSize(this.trState,t),this.updateText()}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(t){this.textRenderer.set.fontFamily(this.trState,t),this.updateText()}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(t){this.textRenderer.set.fontStretch(this.trState,t),this.updateText()}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(t){this.textRenderer.set.fontStyle(this.trState,t),this.updateText()}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(t){this.textRenderer.set.fontWeight(this.trState,t),this.updateText()}get textAlign(){return this.trState.props.textAlign}set textAlign(t){this.textRenderer.set.textAlign(this.trState,t),this.updateText()}get contain(){return this.trState.props.contain}set contain(t){this.textRenderer.set.contain(this.trState,t),this.updateText()}get scrollable(){return this.trState.props.scrollable}set scrollable(t){this.textRenderer.set.scrollable(this.trState,t),this.updateText()}get scrollY(){return this.trState.props.scrollY}set scrollY(t){this.textRenderer.set.scrollY(this.trState,t),this.updateText()}get offsetY(){return this.trState.props.offsetY}set offsetY(t){this.textRenderer.set.offsetY(this.trState,t),this.updateText()}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(t){this.textRenderer.set.letterSpacing(this.trState,t),this.updateText()}get debug(){return this.trState.props.debug}set debug(t){this.textRenderer.set.debug(this.trState,t),this.updateText()}update(t){super.update(t),n(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty),"loading"===this.trState.status&&this.textRenderer.updateState(this.trState)}updateText(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask((()=>{this.updateScheduled=!1,this.textRenderer.updateState(this.trState)})))}renderQuads(t,e){n(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,e,this.worldAlpha)}resolveTextRendererAndState(t,e){const n=this.stage.resolveTextRenderer(t,this._textRendererOverride),r=n.createState(t);return e&&["loading","loaded","failed"].forEach((t=>{e.emitter.off(t)})),r.emitter.on("loading",(()=>{r.emitter.once("fontLoaded",(()=>{this.updateText()})),r.emitter.once("loaded",(()=>{r.emitter.off("fontLoaded")}))})),r.emitter.on("loaded",this.onTextLoaded),r.emitter.on("failed",this.onTextFailed),this.updateText(),{resolvedTextRenderer:n,textRendererState:r}}}class Re extends Ot{constructor(t,e,n){super(t,e,n,new Ce(n,{id:Yt(),x:t.x,y:t.y,width:t.width,height:t.height,alpha:t.alpha,clipping:t.clipping,color:t.color,colorTop:t.colorTop,colorBottom:t.colorBottom,colorLeft:t.colorLeft,colorRight:t.colorRight,colorTl:t.colorTl,colorTr:t.colorTr,colorBl:t.colorBl,colorBr:t.colorBr,zIndex:t.zIndex,zIndexLocked:t.zIndexLocked,scaleX:t.scaleX,scaleY:t.scaleY,mountX:t.mountX,mountY:t.mountY,mount:t.mount,pivot:t.pivot,pivotX:t.pivotX,pivotY:t.pivotY,rotation:t.rotation,text:t.text,fontSize:t.fontSize,fontFamily:t.fontFamily,fontWeight:t.fontWeight,fontStretch:t.fontStretch,fontStyle:t.fontStyle,contain:t.contain,scrollable:t.scrollable,letterSpacing:t.letterSpacing,textAlign:t.textAlign,scrollY:t.scrollY,offsetY:t.offsetY,textRendererOverride:t.textRendererOverride,debug:t.debug,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null}))}get text(){return this.coreNode.text}set text(t){this.coreNode.text=t}get textRendererOverride(){return this.coreNode.textRendererOverride}set textRendererOverride(t){this.coreNode.textRendererOverride=t}get fontSize(){return this.coreNode.fontSize}set fontSize(t){this.coreNode.fontSize=t}get fontFamily(){return this.coreNode.fontFamily}set fontFamily(t){this.coreNode.fontFamily=t}get fontWeight(){return this.coreNode.fontWeight}set fontWeight(t){this.coreNode.fontWeight=t}get fontStretch(){return this.coreNode.fontStretch}set fontStretch(t){this.coreNode.fontStretch=t}get fontStyle(){return this.coreNode.fontStyle}set fontStyle(t){this.coreNode.fontStyle=t}get textAlign(){return this.coreNode.textAlign}set textAlign(t){this.coreNode.textAlign=t}get contain(){return this.coreNode.contain}set contain(t){this.coreNode.contain=t}get scrollable(){return this.coreNode.scrollable}set scrollable(t){this.coreNode.scrollable=t}get scrollY(){return this.coreNode.scrollY}set scrollY(t){this.coreNode.scrollY=t}get offsetY(){return this.coreNode.offsetY}set offsetY(t){this.coreNode.offsetY=t}get letterSpacing(){return this.coreNode.letterSpacing}set letterSpacing(t){this.coreNode.letterSpacing=t}get debug(){return this.coreNode.debug}set debug(t){this.coreNode.debug=t}}async function Fe(t,n){let r;try{console.log("Loading core extension",t),r=await(o=()=>e.import(t),o())}catch(s){return console.error(`The core extension module at '${t}' could not be loaded.`),void console.error(s)}var o;if(!r.default)return void console.error(`The core extension module at '${t}' does not have a default export.`);const i=r.default;if(i.prototype instanceof b){const e=new i;try{await e.run(n)}catch(s){console.error(`The core extension at '${t}' threw an error.`),console.error(s)}}else console.error(`The core extension at '${t}' does not extend CoreExtension.`)}class Ee{root=null;stage=null;rendererMain=null;async init(t,e,r){this.stage=new Te({rootId:1,appWidth:e.appWidth,appHeight:e.appHeight,deviceLogicalPixelRatio:e.deviceLogicalPixelRatio,devicePhysicalPixelRatio:e.devicePhysicalPixelRatio,clearColor:e.clearColor,canvas:r,debug:{monitorTextureCache:!1}}),this.rendererMain=t,n(this.stage.root);const o=new Ot(t.resolveNodeDefaults({}),this.rendererMain,this.stage,this.stage.root);this.root=o,o.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,o)),this.onCreateNode(o),e.coreExtensionModule&&await Fe(e.coreExtensionModule,this.stage)}createNode(t){n(this.rendererMain),n(this.stage);const e=new Ot(t,this.rendererMain,this.stage);return e.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,e)),this.onCreateNode(e),e}createTextNode(t){n(this.rendererMain),n(this.stage);const e=new Re(t,this.rendererMain,this.stage);return e.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,e)),this.onCreateNode(e),e}destroyNode(t){t.destroy()}releaseTexture(t){const{stage:e}=this;n(e),e.txManager.removeTextureIdFromCache(t)}getRootNode(){return n(this.root),this.root}onCreateNode(t){throw new Error("Method not implemented.")}onBeforeDestroyNode(t){throw new Error("Method not implemented.")}}let Ie,ze;const ke={appWidth:1920,appHeight:1080,deviceLogicalPixelRatio:.6666667,devicePhysicalPixelRatio:1,rootId:"app",threadXCoreWorkerUrl:void 0};function Ne(t={}){const e=new Ee,n={...ke,...t};return Ie=new Mt({appWidth:n.appWidth,appHeight:n.appHeight,deviceLogicalPixelRatio:n.deviceLogicalPixelRatio,devicePhysicalPixelRatio:n.devicePhysicalPixelRatio,clearColor:n.clearColor,coreExtensionModule:n.coreExtensionModule},n.rootId,e),ze=Ie.createShader.bind(Ie),Ie}class Me extends Array{_parent;constructor(t){super(),this._parent=t}get selected(){return this[this._parent.selected||0]}get firstChild(){return this[0]}insert(t,e){if(e){const n=this.indexOf(e);this.splice(n,0,t)}else this.push(t);t.parent=this._parent,this._parent._isDirty=!0}remove(t){const e=this.indexOf(t);e>=0&&this.splice(e,1)}}const Ae={debug:!1,animationSettings:{duration:250,easing:"ease-in-out"},fontSettings:{fontFamily:"Ubuntu",fontSize:100}};function Pe(t){return"function"==typeof t}function Le(t){return Array.isArray(t)}class Be extends Array{onChange;constructor(t,e=[]){return Le(e)?super(...e):"string"==typeof e?super(e):super(...Object.entries(e).filter((([t,e])=>e)).map((([t])=>t))),this.onChange=t,this}has(t){return this.indexOf(t)>=0}is(t){return this.indexOf(t)>=0}add(t){this.push(t),this.onChange()}toggle(t){this.has(t)?this.remove(t):this.add(t)}remove(t){const e=this.indexOf(t);e>=0&&(this.splice(e,1),this.onChange())}}const{animationSettings:$e}=Ae;function De(t=""){return{set(e){"number"==typeof e&&(e={width:e,color:255}),this.effects={...this.effects||{},[`border${t}`]:e},this[`_border${t}`]=e},get(){return this[`_border${t}`]}}}const Ye=["alpha","color","colorTop","colorRight","colorLeft","colorBottom","colorTl","colorTr","colorBl","colorBr","height","fontSize","lineHeight","mount","mountX","mountY","pivot","pivotX","pivotY","rotation","scale","width","worldX","worldY","x","y","zIndex","zIndexLocked"],Oe=["clipping","contain","fontFamily","src","text","textAlign","texture"];class Xe extends Object{name;lng=null;selected;rendered;_undoStates;_renderProps;_effects;_parent=null;_shader;_style;_states;_animationSettings;_updateLayoutOn;_width;_height;_color;_borderRadius;_border;_borderLeft;_borderRight;_borderTop;_borderBottom;_animate;_autosized;_isDirty;_dom;children;constructor(t){super(),this.name=t,this.rendered=!1,this.autofocus=!1,this._renderProps={x:0,y:0},this.children=new Me(this);for(const e of Ye)Object.defineProperty(this,e,{get(){return this[`_${e}`]||this.lng&&this.lng[e]},set(t){this[`_${e}`]=t,this._sendToLightningAnimatable(e,t)}});for(const e of Oe)Object.defineProperty(this,e,{get(){return this[`_${e}`]||this.lng&&this.lng[e]},set(t){this[`_${e}`]=t,this._sendToLightning(e,t)}});Object.defineProperties(this,{borderRadius:{set(t){this._borderRadius=t,this.effects={...this.effects||{},radius:{radius:t}}},get(){return this._borderRadius}},border:De(),borderLeft:De("Left"),borderRight:De("Right"),borderTop:De("Top"),borderBottom:De("Bottom")}),Object.defineProperties(this,{linearGradient:{set(t={}){this._linearGradient=t,this.effects={...this.effects||{},linearGradient:t}},get(){return this._linearGradient}}})}get effects(){return this._effects}set effects(t){this._effects=t,this.shader=function(t){const e=[];for(const[n,r]of Object.entries(t))e.push({type:n,props:r});return ze("DynamicShader",{effects:e})}(t)}get parent(){return this._parent}set parent(t){this._parent=t,this.rendered&&this.lng&&(this.lng.parent=t?.lng??null)}get shader(){return this._shader}set shader(t){Le(t)?this._shader=ze(...t):this._shader=t,this._sendToLightning("shader",this._shader)}_sendToLightningAnimatable(t,e){if(this.rendered&&this.lng){if(Le(e))return this.createAnimation({[t]:e[0]},e[1]).start();if(this._animate)return this.createAnimation({[t]:e}).start();this.lng[t]=e}else Le(e)&&(e=e[0]),this._renderProps[t]=e}_sendToLightning(t,e){this.rendered&&this.lng?this.lng[t]=e:this._renderProps[t]=e}createAnimation(t,e){return n(this.lng,"Node must be rendered before animating"),this.lng.animate(t,e||this.animationSettings)}setFocus(){this.rendered?Ft(this):this.autofocus=!0}isTextNode(){return"text"===this.name}_resizeOnTextLoad(){n(this.lng),this.lng.once("loaded",((t,e)=>{if("text"===e.type){const{dimensions:t}=e;this.width=t.width,this.height=t.height,n(this.parent),this.parent.updateLayout(this,t)}}))}getText(){return this.children.map((t=>t.text)).join("")}destroy(){this.lng&&Ie.destroyNode(this.lng)}set style(t){for(let e in t)"animate"===e&&(e="_animate"),this[e]||(this[e]=t[e]);this._style=t}get style(){return this._style}get hasChildren(){return this.children.length>0}set states(t){this._states=new Be(this._stateChanged.bind(this),t),this.rendered&&this._stateChanged()}get states(){return this._states=this._states||new Be(this._stateChanged.bind(this)),this._states}get animationSettings(){return this._animationSettings||$e}set animationSettings(t){this._animationSettings=t}get updateLayoutOn(){return this._updateLayoutOn}set updateLayoutOn(t){this._updateLayoutOn=t,queueMicrotask((()=>this.updateLayout()))}_applyZIndexToChildren(){const t=this.zIndex;n(t);const e=t>=1&&parseInt(""+t)===t?".":"";this.children.forEach(((n,r)=>{(!n.zIndex||n.zIndex<1)&&(n.zIndex=parseFloat(`${t}${e}${r+1}`))}))}updateLayout(t,e){this.hasChildren&&(Pe(this.onBeforeLayout)&&this.onBeforeLayout.call(this,t,e),"flex"===this.display&&function(t){const e=t.children.filter((t=>"TextNode"!==t.name)),r=t.flexDirection||"row",o="row"===r?"width":"height",i="row"===r?"height":"width",s="row"===r?"marginLeft":"marginTop",a="row"===r?"marginRight":"marginBottom",l="row"===r?"x":"y",c="row"===r?"y":"x",h=t[o]||0,d=t[i]||0,u=e.reduce(((t,e)=>t+(e[o]||0)),0),f=t.gap||0,p=e.length,g=t.justifyContent||"flexStart",m=t.alignItems,x=d&&m?t=>{"flexStart"===m?t[c]=0:"center"===m?t[c]=(d-(t[i]||0))/2:"flexEnd"===m&&(t[c]=d-(t[i]||0))}:t=>t;if("flexStart"===g){let t=0;e.forEach((e=>{e[l]=t+(e[s]||0),t+=(e[o]||0)+f+(e[s]||0)+(e[a]||0),x(e)}))}if("flexEnd"===g){let t=h;for(let r=p-1;r>=0;r--){const i=e[r];n(i),i[l]=t-(i[o]||0)-(i[a]||0),t-=(i[o]||0)+f+(i[s]||0)+(i[a]||0),x(i)}}if("center"===g){let t=(h-(u+f*(p-1)))/2;e.forEach((e=>{e[l]=t,t+=(e[o]||0)+f,x(e)}))}if("spaceBetween"===g){const t=(h-u)/(p-1);let n=0;e.forEach((e=>{e[l]=n,n+=(e[o]||0)+t,x(e)}))}if("spaceEvenly"===g){const t=(h-u)/(p+1);let n=t;e.forEach((e=>{e[l]=n,n+=(e[o]||0)+t,x(e)}))}}(this),Pe(this.onLayout)&&this.onLayout.call(this,t,e))}_stateChanged(){if(this.states,this.forwardStates){const t=this.states.slice();this.children.forEach((e=>e.states=t))}const t=Ae.stateMapperHook?.(this,this.states)||this.states;if(this._undoStates||this.style&&function(t,e){for(const n of e)if(n in t)return!0;return!1}(this.style,t)){this._undoStates=this._undoStates||{};let e={};for(const[n,o]of Object.entries(this._undoStates))t.includes(n)||(e={...e,...o});const r=t.reduce(((t,e)=>{const r=this.style[e];return r&&(t={...t,...r},this._undoStates&&!this._undoStates[e]&&(this._undoStates[e]={},Object.keys(r).forEach((t=>{n(this._undoStates),this._undoStates[e][t]=this[t]})))),t}),{});Object.assign(this,{...e,...r})}}render(){const t=this,e=this.parent;e?._isDirty&&(e.updateLayout(),e._applyZIndexToChildren(),e._isDirty=!1),t.updateLayout(),this.states.length&&this._stateChanged();let r=t._renderProps;e?.lng&&(r.parent=e.lng),t.isTextNode()?(r={...Ae.fontSettings,...r,text:t.getText()},t.lng=Ie.createTextNode(r),Pe(t.onLoad)&&t.lng.once("loaded",t.onLoad),t.width&&t.height||(t._autosized=!0,t._resizeOnTextLoad())):(r.src||r.texture||(n(e),isNaN(r.width)&&(r.width=(e.width||0)-r.x,t._width=r.width),isNaN(r.height)&&(r.height=(e.height||0)-r.y,t._height=r.height),r.color||(t._color=r.color=0)),t.hasChildren&&t._applyZIndexToChildren(),t.lng=Ie.createNode(r),t.onFail&&t.lng.once("failed",t.onFail),t.onLoad&&t.lng.once("loaded",t.onLoad)),t.rendered=!0,t.autofocus&&t.setFocus(),delete this._renderProps}}function je(t){"TextNode"!==t.name&&(n(t instanceof Xe),t.render(),t.children.forEach((t=>je(t))))}const We=t=>{const e=Ne(t.options),r=e.init();let o;return X((()=>{r.then((()=>{n(o),o.lng=e.root,o.children.forEach(je),Pe(t.onFirstRender)&&t.onFirstRender(o)})).catch(console.error)})),(()=>{const e=Je("canvas");return"function"==typeof o?sn(o,e):o=e,rn(e,"zIndex",.1),en(e,(()=>t.children)),e})()};function Ue({createElement:t,createTextNode:e,isTextNode:n,replaceText:r,insertNode:o,removeNode:i,setProperty:s,getParentNode:a,getFirstChild:l,getNextSibling:c}){function h(t,e,n,r){if(void 0===n||r||(r=[]),"function"!=typeof e)return d(t,e,r,n);O((r=>d(t,e(),r,n)),r)}function d(t,i,s,a,c){for(;"function"==typeof s;)s=s();if(i===s)return s;const h=typeof i,x=void 0!==a;if("string"===h||"number"===h)if("number"===h&&(i=i.toString()),x){let o=s[0];o&&n(o)?r(o,i):o=e(i),s=p(t,s,a,o)}else""!==s&&"string"==typeof s?r(l(t),s=i):(p(t,s,a,e(i)),s=i);else if(null==i||"boolean"===h)s=p(t,s,a);else{if("function"===h)return O((()=>{let e=i();for(;"function"==typeof e;)e=e();s=d(t,e,s,a)})),()=>s;if(Array.isArray(i)){const e=[];if(u(e,i,c))return O((()=>s=d(t,e,s,a,!0))),()=>s;if(0===e.length){const e=p(t,s,a);if(x)return s=e}else Array.isArray(s)?0===s.length?g(t,e,a):f(t,s,e):null==s||""===s?g(t,e):f(t,x&&s||[l(t)],e);s=e}else{if(Array.isArray(s)){if(x)return s=p(t,s,a,i);p(t,s,null,i)}else null!=s&&""!==s&&l(t)?m(t,i,l(t)):o(t,i);s=i}}return s}function u(t,n,r){let o=!1;for(let i=0,s=n.length;i<s;i++){let s,a=n[i];if(null==a||!0===a||!1===a);else if(Array.isArray(a))o=u(t,a)||o;else if("string"==(s=typeof a)||"number"===s)t.push(e(a));else if("function"===s)if(r){for(;"function"==typeof a;)a=a();o=u(t,Array.isArray(a)?a:[a])||o}else t.push(a),o=!0;else t.push(a)}return o}function f(t,e,n){let r=n.length,s=e.length,a=r,l=0,h=0,d=c(e[s-1]),u=null;for(;l<s||h<a;)if(e[l]!==n[h]){for(;e[s-1]===n[a-1];)s--,a--;if(s===l){const e=a<r?h?c(n[h-1]):n[a-h]:d;for(;h<a;)o(t,n[h++],e)}else if(a===h)for(;l<s;)u&&u.has(e[l])||i(t,e[l]),l++;else if(e[l]===n[a-1]&&n[h]===e[s-1]){const r=c(e[--s]);o(t,n[h++],c(e[l++])),o(t,n[--a],r),e[s]=n[a]}else{if(!u){u=new Map;let t=h;for(;t<a;)u.set(n[t],t++)}const r=u.get(e[l]);if(null!=r)if(h<r&&r<a){let i,c=l,d=1;for(;++c<s&&c<a&&null!=(i=u.get(e[c]))&&i===r+d;)d++;if(d>r-h){const i=e[l];for(;h<r;)o(t,n[h++],i)}else m(t,n[h++],e[l++])}else l++;else i(t,e[l++])}}else l++,h++}function p(t,n,r,s){if(void 0===r){let e;for(;e=l(t);)i(t,e);return s&&o(t,s),""}const c=s||e("");if(n.length){let e=!1;for(let s=n.length-1;s>=0;s--){const l=n[s];if(c!==l){const n=a(l)===t;e||s?n&&i(t,l):n?m(t,c,l):o(t,c,r)}else e=!0}}else o(t,c,r);return[c]}function g(t,e,n){for(let r=0,i=e.length;r<i;r++)o(t,e[r],n)}function m(t,e,n){o(t,e,n),i(t,n)}function x(t,e,n={},r){return e||(e={}),r||O((()=>n.children=d(t,e.children,n.children))),O((()=>e.ref&&e.ref(t))),O((()=>{for(const r in e){if("children"===r||"ref"===r)continue;const o=e[r];o!==n[r]&&(s(t,r,o,n[r]),n[r]=o)}})),n}return{render(t,e){let n;return $((r=>{n=r,h(e,t())})),n},insert:h,spread(t,e,n){"function"==typeof e?O((r=>x(t,e(),r,n))):x(t,e,void 0,n)},createElement:t,createTextNode:e,insertNode:o,setProp:(t,e,n,r)=>(s(t,e,n,r),n),mergeProps:bt,effect:O,memo:j,createComponent:xt,use:(t,e,n)=>H((()=>t(e,n)))}}const He={createElement(t){const e=new Xe(t);return Ie.root&&X((()=>e.render())),e},createTextNode:t=>({name:"TextNode",text:t,parent:null}),replaceText(t,e){t.text=e;const r=t.parent;n(r),r._autosized&&r._resizeOnTextLoad(),r.text=r.getText()},setProperty(t,e,n=!0){"animate"!==e?t[e]=n:t._animate=n},insertNode(t,e,n){t&&(t.children.insert(e,n),"TextNode"===e.name&&t.isTextNode()&&(t._autosized&&t._resizeOnTextLoad(),t.text=t.getText()))},isTextNode:t=>t.isTextNode(),removeNode(t,e){t.children.remove(e),e instanceof Xe&&e.destroy()},getParentNode:t=>t.parent??void 0,getFirstChild:t=>t.children[0],getNextSibling(t){if(t.parent){const e=t.parent.children||[],n=e.indexOf(t)+1;if(n<e.length)return e[n]}}},Ge=function(t){const e=Ue(t);return e.mergeProps=bt,e}(He),Ke=Ge.render,{effect:Ve,memo:qe,createComponent:Qe,createElement:Je,createTextNode:Ze,insertNode:tn,insert:en,spread:nn,setProp:rn,mergeProps:on,use:sn}=Ge;function an(t=""){return e=t,Number.isInteger(e)?t:"string"==typeof t?t.startsWith("#")?Number(t.replace("#","0x")+(7===t.length?"ff":"")):t.startsWith("0x")?Number(t):Number("0x"+(6===t.length?t+"ff":t)):0;var e}const ln="_$DX_DELEGATE";function cn(t){const e=`$$${t.type}`;let n=t.composedPath&&t.composedPath()[0]||t.target;for(t.target!==n&&Object.defineProperty(t,"target",{configurable:!0,value:n}),Object.defineProperty(t,"currentTarget",{configurable:!0,get:()=>n||document});n;){const r=n[e];if(r&&!n.disabled){const o=n[`${e}Data`];if(void 0!==o?r.call(n,o,t):r.call(n,t),t.cancelBubble)return}n=n._$host||n.parentNode||n.host}}function hn(t,e,n){return t.addEventListener(e,n),()=>t.removeEventListener(e,n)}function dn(t,e){const n=function(t){try{return document.querySelector(t)}catch(e){return null}}(`#${t}`);n?n.scrollIntoView():e&&window.scrollTo(0,0)}function un(t,e,n,r){let o=!1;const i=t=>"string"==typeof t?{value:t}:t,s=function([t,e],n,r){return[n?()=>n(t()):t,r?t=>e(r(t)):e]}(D(i(t()),{equals:(t,e)=>t.value===e.value}),void 0,(t=>(!o&&e(t),t)));return n&&V(n(((e=t())=>{o=!0,s[1](i(e)),o=!1}))),{signal:s,utils:r}}const fn=/^(?:[a-z0-9]+:)?\/\//i,pn=/^\/+|(\/)\/+$/g;function gn(t,e=!1){const n=t.replace(pn,"$1");return n?e||/^[?#]/.test(n)?n:"/"+n:""}function mn(t,e,n){if(fn.test(e))return;const r=gn(t),o=n&&gn(n);let i="";return i=!o||e.startsWith("/")?r:0!==o.toLowerCase().indexOf(r.toLowerCase())?r+o:o,(i||"/")+gn(e,!i)}function xn(t,e){return gn(t).replace(/\/*(\*.*)?$/g,"")+gn(e)}function yn(t,e,n){const[r,o]=t.split("/*",2),i=r.split("/").filter(Boolean),s=i.length;return t=>{const r=t.split("/").filter(Boolean),a=r.length-s;if(a<0||a>0&&void 0===o&&!e)return null;const l={path:s?"":"/",params:{}},c=t=>void 0===n?void 0:n[t];for(let e=0;e<s;e++){const t=i[e],n=r[e],o=":"===t[0],s=o?t.slice(1):t;if(o&&vn(n,c(s)))l.params[s]=n;else if(o||!vn(n,t))return null;l.path+=`/${n}`}if(o){const t=a?r.slice(-a).join("/"):"";if(!vn(t,c(o)))return null;l.params[o]=t}return l}}function vn(t,e){const n=e=>0===e.localeCompare(t,void 0,{sensitivity:"base"});return void 0===e||("string"==typeof e?n(e):"function"==typeof e?e(t):Array.isArray(e)?e.some(n):e instanceof RegExp&&e.test(t))}function _n(t){const[e,n]=t.pattern.split("/*",2),r=e.split("/").filter(Boolean);return r.reduce(((t,e)=>t+(e.startsWith(":")?2:3)),r.length-(void 0===n?0:1))}function wn(t){const e=new Map,n=q();return new Proxy({},{get:(r,o)=>(e.has(o)||function(t,e){const n=k,r=A;k=t,A=null;try{return it(e,!0)}catch(o){ut(o)}finally{k=n,A=r}}(n,(()=>e.set(o,j((()=>t()[o]))))),e.get(o)()),getOwnPropertyDescriptor:()=>({enumerable:!0,configurable:!0}),ownKeys:()=>Reflect.ownKeys(t())})}function bn(t){let e=/(\/?\:[^\/]+)\?/.exec(t);if(!e)return[t];let n=t.slice(0,e.index),r=t.slice(e.index+e[0].length);const o=[n,n+=e[1]];for(;e=/^(\/\:[^\/]+)\?/.exec(r);)o.push(n+=e[1]),r=r.slice(e[0].length);return bn(r).reduce(((t,e)=>[...t,...o.map((t=>t+e))]),[])}const Sn=Q(),Tn=Q(),Cn=()=>function(t,e){if(null==t)throw new Error(e);return t}(J(Sn),"Make sure your app is wrapped in a <Router />");let Rn;const Fn=()=>Rn||J(Tn)||Cn().base,En=()=>Cn().navigatorFactory(),In=()=>Fn().params;function zn(t,e="",n){const{component:r,data:o,children:i}=t,s=!i||Array.isArray(i)&&!i.length,a={key:t,element:r?()=>xt(r,{}):()=>{const{element:e}=t;return void 0===e&&n?xt(n,{}):e},preload:t.component?r.preload:t.preload,data:o};return Nn(t.path).reduce(((n,r)=>{for(const o of bn(r)){const r=xn(e,o),i=s?r:r.split("/*",1)[0];n.push({...a,originalPath:o,pattern:i,matcher:yn(i,!s,t.matchFilters)})}return n}),[])}function kn(t,e=0){return{routes:t,score:1e4*_n(t[t.length-1])-e,matcher(e){const n=[];for(let r=t.length-1;r>=0;r--){const o=t[r],i=o.matcher(e);if(!i)return null;n.unshift({...i,route:o})}return n}}}function Nn(t){return Array.isArray(t)?t:[t]}function Mn(t,e="",n,r=[],o=[]){const i=Nn(t);for(let s=0,a=i.length;s<a;s++){const t=i[s];if(t&&"object"==typeof t&&t.hasOwnProperty("path")){const i=zn(t,e,n);for(const e of i){r.push(e);const i=Array.isArray(t.children)&&0===t.children.length;if(t.children&&!i)Mn(t.children,e.pattern,n,r,o);else{const t=kn([...r],o.length);o.push(t)}r.pop()}}}return r.length?o:o.sort(((t,e)=>e.score-t.score))}function An(t,e="",n,r){const{signal:[o,i],utils:s={}}=function(t){return t?Array.isArray(t)?{signal:t}:t:{signal:D({value:""})}}(t),a=s.parsePath||(t=>t),l=s.renderPath||(t=>t),c=s.beforeLeave||function(){let t=new Set,e=!1;return{subscribe:function(e){return t.add(e),()=>t.delete(e)},confirm:function(n,r){if(e)return!(e=!1);const o={to:n,options:r,defaultPrevented:!1,preventDefault:()=>o.defaultPrevented=!0};for(const i of t)i.listener({...o,from:i.location,retry:t=>{t&&(e=!0),i.navigate(n,r)}});return!o.defaultPrevented}}}(),h=mn("",e);if(void 0===h)throw new Error(`${h} is not a valid base path`);h&&!o().value&&i({value:h,replace:!0,scroll:!1});const[d,u]=D(!1),f=async t=>{u(!0);try{await function(t){const e=A,n=k;return Promise.resolve().then((()=>{A=e,k=n,it(t,!1),A=k=null}))}(t)}finally{u(!1)}},[p,g]=D(o().value),[m,x]=D(o().state),y=function(t,e){const n=new URL("http://sar"),r=j((e=>{const r=t();try{return new URL(r,n)}catch(o){return console.error(`Invalid path ${r}`),e}}),n,{equals:(t,e)=>t.href===e.href}),o=j((()=>r().pathname)),i=j((()=>r().search),!0),s=j((()=>r().hash)),a=j((()=>""));return{get pathname(){return o()},get search(){return i()},get hash(){return s()},get state(){return e()},get key(){return a()},query:wn(G(i,(()=>function(t){const e={};return t.searchParams.forEach(((t,n)=>{e[n]=t})),e}(r()))))}}(p,m),v=[],_={pattern:h,params:{},path:()=>h,outlet:()=>null,resolvePath:t=>mn(h,t)};if(n)try{Rn=_,_.data=n({data:void 0,params:{},location:y,navigate:b(_)})}finally{Rn=void 0}function w(t,e,n){H((()=>{if("number"==typeof e)return void(e&&(s.go?c.confirm(e,n)&&s.go(e):console.warn("Router integration does not support relative routing")));const{replace:r,resolve:o,scroll:a,state:l}={replace:!1,resolve:!0,scroll:!0,...n},h=o?t.resolvePath(e):mn("",e);if(void 0===h)throw new Error(`Path '${e}' is not a routable path`);if(v.length>=100)throw new Error("Too many redirects");const d=p();if((h!==d||l!==m())&&c.confirm(h,n)){const t=v.push({value:d,replace:r,scroll:a,state:m()});f((()=>{g(h),x(l)})).then((()=>{v.length===t&&function(t){const e=v[0];e&&(t.value===e.value&&t.state===e.state||i({...t,replace:e.replace,scroll:e.scroll}),v.length=0)}({value:h,state:l})}))}}))}function b(t){return t=t||J(Tn)||_,(e,n)=>w(t,e,n)}O((()=>{const{value:t,state:e}=o();H((()=>{t!==p()&&f((()=>{g(t),x(e)}))}))}));{function S(t){if(t.defaultPrevented||0!==t.button||t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)return;const e=t.composedPath().find((t=>t instanceof Node&&"A"===t.nodeName.toUpperCase()));if(!e||!e.hasAttribute("link"))return;const n=e.href;if(e.target||!n&&!e.hasAttribute("state"))return;const r=(e.getAttribute("rel")||"").split(/\s+/);if(e.hasAttribute("download")||r&&r.includes("external"))return;const o=new URL(n);if(o.origin!==window.location.origin||h&&o.pathname&&!o.pathname.toLowerCase().startsWith(h.toLowerCase()))return;const i=a(o.pathname+o.search+o.hash),s=e.getAttribute("state");t.preventDefault(),w(_,i,{resolve:!1,replace:e.hasAttribute("replace"),scroll:!e.hasAttribute("noscroll"),state:s&&JSON.parse(s)})}!function(t,e=window.document){const n=e[ln]||(e[ln]=new Set);for(let r=0,o=t.length;r<o;r++){const o=t[r];n.has(o)||(n.add(o),e.addEventListener(o,cn))}}(["click"]),document.addEventListener("click",S),V((()=>document.removeEventListener("click",S)))}return{base:_,out:void 0,location:y,isRouting:d,renderPath:l,parsePath:a,navigatorFactory:b,beforeLeave:c}}function Pn(t,e,n,r,o){const{base:i,location:s,navigatorFactory:a}=t,{pattern:l,element:c,preload:h,data:d}=r().route,u=j((()=>r().path));h&&h();const f={parent:e,pattern:l,get child(){return n()},path:u,params:o,data:e.data,outlet:c,resolvePath:t=>mn(i.path(),t,u())};if(d)try{Rn=f,f.data=d({data:e.data,params:o,location:s,navigate:a(f)})}finally{Rn=void 0}return f}const Ln=t=>{const{source:e,url:n,base:r,data:o,out:i}=t,s=An(e||un((()=>({value:window.location.pathname+window.location.search+window.location.hash,state:history.state})),(({value:t,replace:e,scroll:n,state:r})=>{e?window.history.replaceState(r,"",t):window.history.pushState(r,"",t),dn(window.location.hash.slice(1),n)}),(t=>hn(window,"popstate",(()=>t()))),{go:t=>window.history.go(t)}),r,o);return Qe(Sn.Provider,{value:s,get children(){return t.children}})},Bn=t=>{const e=Cn(),n=Fn(),r=Z((()=>t.children)),o=j((()=>Mn(r(),xn(n.pattern,t.base||""),Dn))),i=j((()=>function(t,e){for(let n=0,r=t.length;n<r;n++){const r=t[n].matcher(e);if(r)return r}return[]}(o(),e.location.pathname))),s=wn((()=>{const t=i(),e={};for(let n=0;n<t.length;n++)Object.assign(e,t[n].params);return e}));e.out&&e.out.matches.push(i().map((({route:t,path:e,params:n})=>({originalPath:t.originalPath,pattern:t.pattern,path:e,params:n}))));const a=[];let l;const c=j(G(i,((t,r,o)=>{let h=r&&t.length===r.length;const d=[];for(let l=0,u=t.length;l<u;l++){const u=r&&r[l],f=t[l];o&&u&&f.route.key===u.route.key?d[l]=o[l]:(h=!1,a[l]&&a[l](),$((t=>{a[l]=t,d[l]=Pn(e,d[l-1]||n,(()=>c()[l+1]),(()=>i()[l]),s)})))}return a.splice(t.length).forEach((t=>t())),o&&h?o:(l=d[0],d)})));return Qe(Ct,{get when(){return c()&&l},keyed:!0,children:t=>Qe(Tn.Provider,{value:t,get children(){return t.outlet()}})})},$n=t=>{const e=Z((()=>t.children));return bt(t,{get children(){return e()}})},Dn=()=>{const t=Fn();return Qe(Ct,{get when(){return t.child},keyed:!0,children:t=>Qe(Tn.Provider,{value:t,get children(){return t.outlet()}})})};var Yn=V;function On(t,e=q()){let n,r,o=0;return()=>(o++,V((()=>{o--,queueMicrotask((()=>{!o&&r&&(r(),r=n=void 0)}))})),r||$((e=>n=t(r=e)),e),n)}var Xn=On((()=>{const[t,e]=D(null);var n,r,o,i;return n=window,r="keydown",o=t=>{e(t),setTimeout((()=>e(null)))},n.addEventListener(r,o,i),Yn(n.removeEventListener.bind(n,r,o,i)),t}));function jn(t){return"function"==typeof t}function Wn(t,e){if(!t)throw new Error(e||"Assertion failed")}let Un={Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Enter:"Enter",Last:"l"};const[Hn,Gn]=D([]);function Kn(t,e){const n=e();let r,o,i,s;Array.isArray(n)?2===n.length?(r=s=n[0],o=i=n[1]):3===n.length?(r=n[0],o=i=n[1],s=n[2]):[r,i,s,o]=n:r=i=s=o=n,t.onBeforeLayout=(e,n)=>{if(n){t.width=t.children.reduce(((t,e)=>t+(e.width||0)),0)+o+i;const e=t.children[0];e&&(e.x=o,e.marginLeft=o),t.height=t.children.reduce(((t,e)=>(e.y=(e.y||0)+r,e.marginTop=r,t+(e.height||0))),0)+r+s}}}function Vn(t){return new Promise((e=>{setTimeout(e,t)}))}function qn(t,e,n="en-US"){const r=window.speechSynthesis;return new Promise(((o,i)=>{const s=new SpeechSynthesisUtterance(t);s.lang=n,s.onend=()=>{o()},s.onerror=t=>{i(t)},e.push(s),r.speak(s)}))}function Qn(t,e,n=!0){const r=window.speechSynthesis,o=function(t=[]){const e=[];let n;for(n=0;n<t.length;n++){const r=t[n];if("string"!=typeof r||r.includes("PAUSE-"))break;e.push(t[n])}return[e.join(",\b ")].concat(t.slice(n))}(Array.isArray(t)?t:[t]),i=[],s=[];let a=!0;return{series:(async()=>{try{for(;a&&o.length;){const n=await Promise.resolve(o.shift());if(!a)break;if("string"==typeof n&&n.includes("PAUSE-")){let t=1e3*Number(n.split("PAUSE-")[1]);isNaN(t)&&(t=0),await Vn(t)}else if("string"==typeof n&&n.length){const r=3;let o=r;for(;a&&o>0;)try{await qn(n,s,e),o=0}catch(t){if(!(t instanceof SpeechSynthesisErrorEvent))throw t;if("network"===t.error)o--,console.warn(`Speech synthesis network error. Retries left: ${o}`),await Vn(500*(r-o));else{if("canceled"!==t.error&&"interrupted"!==t.error)throw new Error(`SpeechSynthesisErrorEvent: ${t.error}`);o=0}}}else if("function"==typeof n){const t=Qn(n(),e,!1);i.push(t),await t.series}else if(Array.isArray(n)){const t=Qn(n,e,!1);i.push(t),await t.series}}}finally{a=!1}})(),get active(){return a},append:t=>{o.push(t)},cancel:()=>{a&&(n&&r.cancel(),i.forEach((t=>{t.cancel()})),a=!1)}}}let Jn;function Zn(t,e="en-US"){return Jn&&Jn.cancel(),Jn=Qn(t,e),Jn}let tr,er,nr=[],rr=!1;function or(t,e){const n=((t,e)=>{let n;const r=()=>clearTimeout(n);return q()&&V(r),Object.assign(((...o)=>{void 0!==n&&r(),n=setTimeout((()=>t(...o)),e)}),{clear:r})})(t,e);let r;const o=t=>{r=t,n(t)};return o.flush=()=>{n.clear(),t(r)},o.clear=n.clear,o}function ir(t){return t.id||t.name}function sr(t=[]){if(!ar.onFocusChange)return;const e=t.every((t=>!t.loading)),n=t.filter((t=>!nr.includes(t)));if(tr(),!e&&ar.onFocusChange)return void ar.onFocusChange([]);nr=t.slice(0);const r=[],o=n.reduce(((t,e)=>(e.announce?(t.push([ir(e),"Announce",e.announce]),r.push(e.announce)):e.title?(t.push([ir(e),"Title",e.title]),r.push(e.title)):t.push([ir(e),"No Announce",""]),t)),[]);return n.reverse().reduce(((t,e)=>(e.announceContext?(t.push([ir(e),"Context",e.announceContext]),r.push(e.announceContext)):t.push([ir(e),"No Context",""]),t)),o),ar.debug&&console.table(o),r.length?ar.speak(r.reduce(((t,e)=>t.concat(e)),[])):void 0}const ar={debug:!1,cancel:function(){er&&er.cancel()},clearPrevFocus:function(t=0){nr=nr.slice(0,t),tr()},speak:function(t,{append:e=!1,notification:n=!1}={}){return ar.onFocusChange&&(ar.onFocusChange.flush(),e&&er&&er.active?er.append(t):(ar.cancel(),r=t,rr||(er=Zn(r))),n&&(rr=!0,er?.series.finally((()=>{rr=!1})).catch(console.error))),er;var r},setupTimers:function({focusDebounce:t=400,focusChangeTimeout:e=3e5}={}){ar.onFocusChange=or(sr,t),tr=or((()=>{nr=[]}),e)}};function lr(t){return function(){const e=this.children.length,n=this.wrap,r=this.selected;if("right"===t||"down"===t){do{if(this.selected=(this.selected||0)%e+1,this.selected>=e){if(!n){this.selected=null;break}this.selected=0}}while(this.children[this.selected]?.skipFocus)}else if("left"===t||"up"===t)do{if(this.selected=(this.selected||0)%e-1,this.selected<0){if(!n){this.selected=null;break}this.selected=e-1}}while(this.children[this.selected]?.skipFocus);if(null===this.selected)return this.selected=r,!1;const o=this.children[this.selected];if(Wn(o instanceof Xe),this.onSelectedChanged&&this.onSelectedChanged.call(this,this,o,this.selected,r),this.plinko&&null!==r){const t=this.children[r];Wn(t instanceof Xe);const e=t.selected;o.selected=e}return Ft(o),!0}}function cr(t){const e=lr("left"),n=lr("right");return(()=>{const r=Je("node");return rn(r,"onLeft",e),rn(r,"onRight",n),rn(r,"selected",0),nn(r,on({get onFocus(){return t.onFocus||(t=>{if(!t||!t.selected)return;const e=t.children[t.selected];e instanceof Xe&&e.setFocus()})}},t),!0),en(r,(()=>t.children)),r})()}function hr(t){const e=lr("up"),n=lr("down");return(()=>{const r=Je("node");return rn(r,"onUp",e),rn(r,"onDown",n),rn(r,"selected",0),nn(r,on({get onFocus(){return t.onFocus||(t=>{if(!t||!t.selected)return;const e=t.children[t.selected];e instanceof Xe&&e.setFocus()})}},t),!0),en(r,(()=>t.children)),r})()}const dr={flexRow:{display:"flex",flexDirection:"row",justifyContent:"flexStart"},flexColumn:{display:"flex",flexDirection:"column",justifyContent:"flexStart"},layout:{screenW:1920,screenH:1080,marginX:120,marginY:120,gutterX:24,gutterY:72,focusScale:1.1},color:{primary:"#00315c",focus:"#bdbdbd",container:"#004882"},typography:{display1:{fontFamily:"Ubuntu",fontSize:72,lineHeight:88,fontStyle:"600",verticalAlign:"middle",textBaseline:"bottom",maxLineSuffix:"..."},display2:{fontFamily:"Ubuntu",fontSize:56,lineHeight:72},headline1:{fontFamily:"Ubuntu",fontSize:36,fontStyle:"600",lineHeight:48,verticalAlign:"middle",textBaseline:"bottom",maxLineSuffix:"..."},headline2:{fontFamily:"Ubuntu",fontSize:32,lineHeight:44},headline3:{fontFamily:"Ubuntu",fontSize:28,lineHeight:40},body1:{fontFamily:"Ubuntu",fontSize:32,lineHeight:40},body2:{fontFamily:"Ubuntu",fontSize:28,lineHeight:34},button1:{fontFamily:"Ubuntu",fontSize:32,lineHeight:40}}},ur={Page:{width:1920,height:1080},headlineText:{width:1200,height:240,x:360,y:455,contain:"both",fontSize:66,textAlign:"center"},headlineSubText:{width:960,height:170,x:530,y:655,contain:"both",fontSize:48,textAlign:"center"},itemsContainer:{width:dr.layout.screenW,height:600,y:560,x:0},Thumbnail:{borderRadius:16,width:185,height:278,scale:1,zIndex:2,focus:{scale:1.1}},FocusRing:{borderRadius:16,width:194,height:286,y:-5,x:-5},showHeadline:{x:70,y:20},headlineBlur:{width:1920,height:150,x:0,y:0,zIndex:14,alpha:.9,color:an("#000000")},RowTitle:{height:60,width:300,marginTop:20,fontSize:36,color:an("#f0f0f0"),zIndex:2},Row:{display:"flex",justifyContent:"spaceBetween",height:300},Column:{display:"flex",flexDirection:"column",justifyContent:"flexStart",gap:20,width:dr.layout.screenW-2*dr.layout.marginX,x:dr.layout.marginX+dr.layout.gutterX,y:48},Rect:{width:250,height:100,y:10,x:300,color:an("#0000ff")},peopleBio:{...dr.typography.body1,contain:"both",width:1500,height:400}},fr={width:386,height:136,color:an("#000000"),alpha:.3,borderRadius:30,border:{width:5,color:an("#cc33ff")},scale:1,focus:{color:[an("#58807d"),{duration:2e3}],scale:1.2,border:{width:5,color:an("#ff0000")},alpha:[1,{duration:1500,delay:200,timing:"easy-in"}]},active:{color:an("#33ff55")},disabled:{alpha:1}},pr={container:fr,topBar:{color:an("#00A699"),height:8,y:2,x:-4,width:fr.width+8},text:{fontSize:32,contain:"width",textAlign:"center",mountY:-.35,color:an("#F6F6F9"),height:fr.height,width:fr.width,focus:{fontSize:64}}},gr=386,mr=136,xr=(an("#715cab"),an("#5a39a2"),an("#291d43"),{fontSize:32,contain:"width",textAlign:"center",mountY:-.35,color:an("#FFFFFF"),height:mr,width:gr,focus:{fontSize:40},disabled:{color:an("#909090")}});function yr(t){return Qe(It,on(t,{animate:!0,get style(){return ur.Thumbnail}}))}function vr(t){return Qe(It,on(t,{get style(){return ur.FocusRing}}))}function _r(t){const[e,n]=function(t,...e){if(S in t){const n=new Set(e.length>1?e.flat():e[0]),r=e.map((e=>new Proxy({get:n=>e.includes(n)?t[n]:void 0,has:n=>e.includes(n)&&n in t,keys:()=>e.filter((e=>e in t))},vt)));return r.push(new Proxy({get:e=>n.has(e)?void 0:t[e],has:e=>!n.has(e)&&e in t,keys:()=>Object.keys(t).filter((t=>!n.has(t)))},vt)),r}const n={},r=e.map((()=>({})));for(const o of Object.getOwnPropertyNames(t)){const i=Object.getOwnPropertyDescriptor(t,o),s=!i.get&&!i.set&&i.enumerable&&i.writable&&i.configurable;let a=!1,l=0;for(const t of e)t.includes(o)&&(a=!0,s?r[l][o]=i.value:Object.defineProperty(r[l],o,i)),++l;a||(s?n[o]=i.value:Object.defineProperty(n,o,i))}return[...r,n]}(t,["items"]);return Qe(cr,on(n,{get style(){return ur.Row},get children(){return Qe(Tt,{get each(){return e.items},children:t=>Qe(yr,t)})}}))}const[wr,br]=D(""),Sr="https://api.themoviedb.org/3";let Tr,Cr;const Rr="w185",Fr={headers:{"Content-Type":"application/json",Authorization:"Bearer eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIyZDE4YjEwMTA0YjdiZTlkNjFiMWYwYjVlMGEwNzM2OCIsInN1YiI6IjYwZTVjMTdlNGNhNjc2MDA3NTA4Njc3MSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.D_nqH9kd-bhhWzeVsTDPYhHnsUaNAuyAa6YATmKHqsA"}};function Er(t,e=Rr){return Cr+e+t}function Ir(t,e={}){return fetch(Sr+t,{...Fr,...e}).then((t=>t.json()))}function zr(){return Ir("/configuration").then((t=>(Tr=t,Cr=t.images?.secure_base_url,t)))}const kr={get:function(t,e={}){return Tr?Ir(t,e):zr().then((()=>Ir(t,e)))},loadConfig:zr};function Nr(t=[]){return t.map((t=>{return{src:Er(t.poster_path||t.profile_path),tileSrc:Er(t.backdrop_path||t.profile_path,"w300"),backdrop:Er(t.backdrop_path,"w1280"),href:`/solid-demo-app/entity/${t.media_type||"people"}/${t.id}`,shortTitle:(e=t.title||t.name,n=30,e.length>n?e.substring(0,n-3)+"...":e),title:t.title||t.name,data:t,entityInfo:{type:t.media_type||"people",id:t.id},heroContent:{title:t.title||t.name,description:t.overview}};var e,n}))}let Mr=new Map;const Ar=new Map;function Pr(t){const[e,n]=D([]),[r,o]=D(1),[i,s]=D(!1),[a]=W(r,t);return Y((()=>{const t=a();t&&it((()=>{0===t.length&&s(!0),n((e=>[...e,...t]))}),!1)})),{pages:e,page:r,setPage:o,setPages:n,end:i,setEnd:s}}const Lr=1100,Br={...dr.typography.display2,width:Lr,height:58,contain:"both"},$r=t=>Qe(Et,on(t,{style:Br,get children(){return t.children}})),Dr={...dr.typography.body1,width:Lr,height:72,contain:"both"},Yr={fontSize:20,lineHeight:20},Or=t=>Qe(Et,on(t,{style:Dr,get children(){return t.children}})),Xr=t=>(()=>{const e=Je("node");return sn(Kn,e,(()=>[8,15,13,15])),nn(e,on(t,{style:{color:"0x00000099",borderRadius:8,border:{width:3,color:"0xffffffff"}}}),!0),en(e,Qe(Et,{style:Yr,get children(){return t.children}})),e})(),jr=dr.typography.body2,Wr=t=>Qe(It,{get style(){return{...dr.flexRow,gap:12,width:Lr,height:48}},get children(){return[Qe(Et,{style:jr,get children(){return t.metaText}}),Qe(Tt,{get each(){return t.badges},children:t=>Qe(Xr,{y:-5,children:t})}),qe((()=>{return e=t.reviews,[Qe(Ct,{get when(){return e?.rtCrit&&"0"!==e?.rtCrit},get children(){return[Qe(It,{src:"https://upload.wikimedia.org/wikipedia/commons/b/b6/Tomato-Torrent-Icon.png",title:"Rotten Tomatoes Rating",style:{width:30,height:30,marginRight:-6}}),Qe(Et,{style:jr,get children(){return e.rtCrit+"%"}})]}}),Qe(Ct,{get when(){return e?.rtFan&&"0"!==e?.rtFan},get children(){return[Qe(It,{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/da/Rotten_Tomatoes_positive_audience.svg/80px-Rotten_Tomatoes_positive_audience.svg.png",title:"Rotten Tomatoes Rating",style:{width:24,height:30,marginRight:-6}}),Qe(Et,{style:jr,get children(){return e.rtFan+"%"}})]}})];var e}))]}}),Ur=t=>Qe(It,on(t,{get style(){return{...dr.flexColumn,width:Lr,height:160,gap:16}},get children(){return[Qe($r,{get children(){return t.title}}),Qe(Or,{get children(){return t.description}}),Qe(Wr,{get metaText(){return t.metaText},get badges(){return t.badges},get reviews(){return t.reviews}})]}}));function Hr(t){const e=t%60;return Math.floor(t/60)+"h "+(e<10?"0":"")+e+"m"}function Gr(t){return t.split("-")[0]}function Kr({type:t,id:e}){return kr.get(`/${t}/${e}/recommendations`).then((({results:e})=>e.length?Nr(e.slice(0,7)):kr.get(`/trending/${t}/week?page=1`).then((({results:t})=>Nr(t.slice(0,7))))))}function Vr({type:t,id:e}){return kr.get(`/${t}/${e}/credits`).then((({cast:t})=>Nr(t.slice(0,7))))}function qr({type:t,id:e}){let n="movie"===t?{rtCrit:86,rtFan:92}:{};return kr.get(`/${t}/${e}`).then((e=>({backgroundImage:Er(e.backdrop_path,"original"),heroContent:{title:e.title||e.name,description:e.overview,badges:["HD"],metaText:"movie"===t?Hr(e.runtime)+" - "+e.release_date:`${Gr(e.first_air_date)} - ${Gr(e.last_air_date)}`,reviews:n},...e})))}const Qr=()=>{const t=In(),[e,r]=D(0),[o,i]=D();W(o,qr);const[s,a]=D({}),l=En(),c=U((()=>0)),h=j((()=>{return Pr((e=t.filter||"all",t=>{const n=`/trending/${e}/week?page=${t}`;if(Mr.has(n))return Mr.get(n);let r=kr.get(n).then((t=>{let n=t.results.filter((t=>!t.adult)),r=function(t,e=7){let n=[];for(let r=0,o=t.length;r<o;r+=e)n.push(t.slice(r,r+e));return n}((Ar.has(e)?Ar.get(e):[]).concat(Nr(n)));return r[r.length-1].length<7?Ar.set(e,r.pop()):Ar.delete(e),r}));return Mr.set(n,r),r}));var e}));function d(){this.children.selected?.setFocus(),r(-1*(this.y||0)+24);let t=h().pages().length;(0===t||this.parent.selected&&this.parent.selected>=t-2)&&h().setPage((t=>t+1))}function u(){let t=this.children.selected;n(t&&t.href),l(t.href)}return X(G(Rt,(t=>{t.backdrop&&br(t.backdrop),t.heroContent&&a(t.heroContent)}),{defer:!0})),Qe(Ct,{get when(){return h().pages().length},get children(){return[Qe(Ur,on({y:360,x:150},s)),Qe(It,{clipping:!0,get style(){return ur.itemsContainer},get children(){return Qe(hr,{plinko:!0,announce:"All Trending - Week",animate:!0,get y(){return e()},get style(){return ur.Column},get children(){return Qe(Tt,{get each(){return h().pages()},children:(t,e)=>Qe(_r,{get autofocus(){return c(e())},items:t,onFocus:d,onEnter:u})})}})}})]}})},Jr=()=>{const t=En(),e=U((()=>0));function r(){let e=this.children.selected;n(e&&e.id),t("/"+e.id)}const o=[{title:"Flex Row",id:"flex",description:"Flex Row Implementation"},{title:"Flex Column",id:"flexcolumn",description:"Flex Column Implementation"},{title:"Flex Row Vertical Align",id:"flexsize",description:"Flex Row Vertical Align Implementation"},{title:"Flex Column Vertical Align",id:"flexcolumnsize",description:"Flex Column Vertical Align Implementation"},{title:"Buttons",id:"buttons",description:"Demo a few buttons"},{title:"Text",id:"text",description:"Text layout with flexbox"}];function i(t){const[e,n]=D(4294967295);return Qe(It,on(t,{onFocus:()=>n(255),onBlur:()=>n(4294967295),animate:!0,style:{width:370,height:320,borderRadius:6,scale:1,color:405488895,focus:{scale:1.1,color:4294967295}},get children(){return Qe(It,{x:30,get children(){return[Qe(Et,{y:30,fontSize:84,get color(){return e()},get children(){return t.index}}),Qe(Et,{y:140,fontSize:42,width:340,height:42,contain:"both",get color(){return e()},get children(){return t.title}}),Qe(Et,{y:200,fontSize:28,width:330,contain:"width",get color(){return e()},get children(){return t.description}})]}})}}))}const[s,a]=D(140);function l(t){a(-400*t.selected+140)}return Qe(It,{colorTop:1147903743,colorBottom:743406847,get children(){return[Qe(It,{x:120,get children(){return[Qe(It,{src:"/assets/solidjs.png",width:101,height:90,y:40}),Qe(Et,{fontSize:90,x:110,y:40,children:"Examples"}),Qe(It,{y:140,height:1,width:1800,color:3906468351})]}}),Qe(cr,{onSelectedChanged:l,onEnter:r,animationSettings:{delay:20,duration:300},animate:!0,get x(){return s()},y:300,width:4400,get style(){return ur.Row},justifyContent:"flexStart",gap:40,get children(){return Qe(Tt,{each:o,children:(t,n)=>Qe(i,on({get autofocus(){return e(n())},get index(){return n()}},t))})}})]}})},Zr=()=>{const t={width:900,height:500,y:350,x:150,gap:25,display:"flex",flexDirection:"column",justifyContent:"flexStart",color:an("00000000")},e={width:900,height:36,gap:6,display:"flex",flexDirection:"row",justifyContent:"flexStart",color:an("00000000")},n={fontSize:42},r={width:t.width,fontSize:26,contain:"width"},o={fontSize:26};return K((()=>{br("0x000000ff")})),Qe(It,{autofocus:!0,style:t,get children(){return[Qe(Et,{style:n,children:"Title of the Page"}),Qe(Et,{style:r,children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer vel tempor tellus. Sed eu leo purus. Vestibulum sollicitudin eget tellus a varius. Phasellus est turpis, volutpat sed blandit sit amet, rutrum sit amet mauris. In dignissim elit orci, a sollicitudin ipsum faucibus et. Quisque vel quam rutrum, faucibus augue sed, scelerisque nunc."}),Qe(It,{style:e,get children(){return[Qe(Et,{style:o,children:"Subline Text"}),Qe(It,{width:28,height:28,src:"/assets/rt-popcorn.png"}),Qe(Et,{style:o,children:"More Text"})]}})]}})},to=()=>{function t(t,e){this.states.toggle("disabled")}const e={display:"flex",justifyContent:"flexStart",width:1500,height:300,color:an("00000000"),gap:26,y:400};function n(t){return Qe(It,on(t,{forwardStates:!0,animate:!0,get style(){return pr.container},get children(){return Qe(Et,{get style(){return pr.text},get children(){return t.children}})}}))}const r=t=>(()=>{const e=Je("node");return sn(Kn,e,(()=>[10,15])),nn(e,on(t,{get style(){return{color:an("#000000be"),borderRadius:8,border:{width:2,color:an("#ffffff")}}}}),!0),en(e,Qe(Et,{style:{fontSize:20},get children(){return t.children}})),e})();return[Qe(cr,{x:100,y:200,gap:5,style:e,get children(){return[Qe(r,{children:"HD"}),Qe(r,{children:"PG13"}),Qe(r,{children:"NC17"}),Qe(Et,{fontSize:30,children:"I like bananas"}),Qe(r,{children:"DOLBY"})]}}),Qe(cr,{x:100,gap:40,style:e,get children(){return[Qe(n,{autofocus:!0,onEnter:t,children:"TV Shows"}),Qe(n,{states:{active:!0,disabled:!1},children:"Movies"}),Qe(n,{states:"active",children:"Sports"}),Qe(n,{states:"disabled",children:"News"})]}})]},eo=()=>{const t={display:"flex",justifyContent:"flexStart",width:1600,height:110,color:an("#4dabf5")},e={fontSize:44,marginTop:25,marginBottom:-20,skipFocus:!0};function n(t){return Qe(It,on(t,{style:{width:200,height:100,y:5,color:392801023}}))}const[r,o]=D(50);function i(){this.children.selected?.setFocus(),o(150+-1*(this.y||0))}K((()=>{br("#333333")}));const s=50;return Qe(hr,{x:160,get y(){return r()},animate:!0,gap:30,height:850,get width(){return t.width},get style(){return ur.Column},get children(){return[Qe(Et,{style:e,children:"Flex Start"}),Qe(cr,{gap:s,style:t,onFocus:i,get children(){return[Qe(n,{autofocus:!0}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}}),Qe(Et,{style:e,children:"Flex Start - Margin Left"}),Qe(cr,{gap:s,style:t,onFocus:i,get children(){return[Qe(n,{marginLeft:100}),Qe(n,{}),Qe(n,{marginLeft:100}),Qe(n,{}),Qe(n,{})]}}),Qe(Et,{style:e,children:"Flex End"}),Qe(cr,{gap:s,justifyContent:"flexEnd",style:t,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}}),Qe(Et,{style:e,children:"Flex End - Margin Right"}),Qe(cr,{gap:s,justifyContent:"flexEnd",style:t,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{marginRight:100}),Qe(n,{}),Qe(n,{}),Qe(n,{marginRight:100})]}}),Qe(Et,{style:e,children:"Center - No Margin Support"}),Qe(cr,{gap:s,justifyContent:"center",style:t,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}}),Qe(Et,{style:e,children:"Space Between - No Margin Support"}),Qe(cr,{gap:s,justifyContent:"spaceBetween",style:t,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}}),Qe(Et,{style:e,children:"Space Evenly - No Margin Support"}),Qe(cr,{gap:s,justifyContent:"spaceEvenly",style:t,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}})]}})},no=()=>{const t={display:"flex",justifyContent:"flexStart",width:1600,height:110,color:an("#4dabf5")},e={fontSize:44,marginTop:25,marginBottom:-20,skipFocus:!0};function n(t){return Qe(It,on(t,{style:{width:200,height:100,y:5,color:392801023}}))}function r(){return Math.floor(91*Math.random())+10}const[o,i]=D(50);function s(){this.children.selected?.setFocus(),i(150+-1*(this.y||0))}K((()=>{br("#333333")}));const a=50;return Qe(hr,{x:160,get y(){return o()},animate:!0,gap:30,height:850,get width(){return t.width},get style(){return ur.Column},get children(){return[Qe(Et,{style:e,children:"Flex Start - AlignItems: center"}),Qe(cr,{alignItems:"center",gap:a,style:t,onFocus:s,get children(){return[Qe(n,{autofocus:!0,get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}})]}}),Qe(Et,{style:e,children:"Flex Start - Margin Left - AlignItems: flexStart"}),Qe(cr,{gap:a,alignItems:"flexStart",style:t,onFocus:s,get children(){return[Qe(n,{marginLeft:100,get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{marginLeft:100,get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}})]}}),Qe(Et,{style:e,children:"Flex End - AlignItems: flexEnd"}),Qe(cr,{gap:a,justifyContent:"flexEnd",alignItems:"flexEnd",style:t,onFocus:s,get children(){return[Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}})]}}),Qe(Et,{style:e,children:"Flex End - Margin Right"}),Qe(cr,{gap:a,justifyContent:"flexEnd",style:t,onFocus:s,get children(){return[Qe(n,{get height(){return r()}}),Qe(n,{marginRight:100,get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{marginRight:100,get height(){return r()}})]}}),Qe(Et,{style:e,children:"Center - No Margin Support"}),Qe(cr,{gap:a,justifyContent:"center",style:t,onFocus:s,get children(){return[Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}})]}}),Qe(Et,{style:e,children:"Space Between - No Margin Support"}),Qe(cr,{gap:a,justifyContent:"spaceBetween",style:t,onFocus:s,get children(){return[Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}})]}}),Qe(Et,{style:e,children:"Space Evenly - No Margin Support"}),Qe(cr,{gap:a,justifyContent:"spaceEvenly",style:t,onFocus:s,get children(){return[Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}}),Qe(n,{get height(){return r()}})]}})]}})},ro=()=>{const t={display:"flex",justifyContent:"spaceEvenly",width:1920,y:100,height:880,color:an("00000000")},e={display:"flex",flexDirection:"column",justifyContent:"flexStart",color:an("#4dabf5"),height:850,width:80};function n(t){const e={width:Math.floor(61*Math.random())+10,height:80,x:5,color:an("#1769aa")};return Qe(It,on(t,{style:e}))}const[r,o]=D(50);function i(){this.children.selected?.setFocus(),o(150+-1*(this.y||0))}K((()=>{br("#333333")}));const s=50;return[Qe(Et,{style:{fontSize:44,y:20,x:150},children:"Start, MarginTop, End, MarginBottom, Center, Between, Evenly"}),Qe(cr,{gap:s,style:t,onFocus:i,get children(){return[Qe(hr,{gap:30,style:e,alignItems:"center",get children(){return[Qe(n,{autofocus:!0}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}}),Qe(hr,{gap:s,style:e,onFocus:i,alignItems:"flexStart",get children(){return[Qe(n,{marginTop:100}),Qe(n,{}),Qe(n,{marginTop:100}),Qe(n,{}),Qe(n,{})]}}),Qe(hr,{gap:s,alignItems:"flexEnd",justifyContent:"flexEnd",style:e,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}}),Qe(hr,{gap:s,justifyContent:"flexEnd",style:e,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{marginBottom:100}),Qe(n,{}),Qe(n,{}),Qe(n,{marginBottom:100})]}}),Qe(hr,{gap:s,justifyContent:"center",style:e,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}}),Qe(hr,{gap:s,justifyContent:"spaceBetween",style:e,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}}),Qe(hr,{gap:s,justifyContent:"spaceEvenly",style:e,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}})]}})]},oo=()=>{const t={display:"flex",justifyContent:"spaceEvenly",width:1920,y:100,height:880,color:an("00000000")},e={display:"flex",flexDirection:"column",justifyContent:"flexStart",color:an("#4dabf5"),height:850,width:60};function n(t){const e={width:50,height:80,x:5,color:an("#1769aa")};return Qe(It,on(t,{style:e}))}const[r,o]=D(50);function i(){this.children.selected?.setFocus(),o(150+-1*(this.y||0))}K((()=>{br("#333333")}));const s=50;return[Qe(Et,{style:{fontSize:44,y:20,x:150},children:"Start, MarginTop, End, MarginBottom, Center, Between, Evenly"}),Qe(cr,{gap:s,style:t,onFocus:i,get children(){return[Qe(hr,{gap:30,style:e,get children(){return[Qe(n,{autofocus:!0}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}}),Qe(hr,{gap:s,style:e,onFocus:i,get children(){return[Qe(n,{marginTop:100}),Qe(n,{}),Qe(n,{marginTop:100}),Qe(n,{}),Qe(n,{})]}}),Qe(hr,{gap:s,justifyContent:"flexEnd",style:e,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}}),Qe(hr,{gap:s,justifyContent:"flexEnd",style:e,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{marginBottom:100}),Qe(n,{}),Qe(n,{}),Qe(n,{marginBottom:100})]}}),Qe(hr,{gap:s,justifyContent:"center",style:e,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}}),Qe(hr,{gap:s,justifyContent:"spaceBetween",style:e,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}}),Qe(hr,{gap:s,justifyContent:"spaceEvenly",style:e,onFocus:i,get children(){return[Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{}),Qe(n,{})]}})]}})]},io=()=>{function t(t,e){this.states.toggle("disabled")}const e={display:"flex",justifyContent:"flexStart",width:1500,height:300,color:an("00000000"),gap:26,y:400,x:100},n={width:386,height:136,color:"0x715cabff",focus:{color:"0x5a39a2ff"},disabled:{color:"0x291d43ff"}},r=["RoundedRectangle",{radius:65}];function o(t){return Qe(It,on(t,{forwardStates:!0,animate:!0,style:n,shader:r,get children(){return Qe(Et,{style:xr,get children(){return t.children}})}}))}return Qe(cr,{style:e,get children(){return[Qe(o,{autofocus:!0,onEnter:t,children:"Focused"}),Qe(o,{states:{active:!0,disabled:!1},children:"Normal"}),Qe(o,{states:"disabled",children:"Disabled"})]}})},so=()=>{const t=In(),e=En(),[r]=W((()=>({...t})),qr),[o]=W((()=>({...t})),Vr),[i]=W((()=>({...t})),Kr);X(G(r,(t=>{br(t.backgroundImage)}),{defer:!0}));const s=600,a={color:an("#000000"),alpha:0,width:1900,height:890,x:10,y:s,borderRadius:30};function l(){this.children.selected?.setFocus(),d.y=s,u.y=s,u.alpha=0}function c(){this.children.selected?.setFocus(),d.y=200,u.y=160,u.alpha=.9}function h(){let t=this.children.selected;n(t&&t.href),e(t.href)}let d,u;return Qe(Ct,{get when(){return r()},keyed:!0,get children(){return[Qe(Ur,on({y:360,x:150},(()=>r().heroContent))),Qe(hr,{animate:!0,ref(t){"function"==typeof d?d(t):d=t},y:s,x:140,get style(){return ur.Column},get children(){return Qe(Ct,{get when(){return qe((()=>!!i()))()&&o()},get children(){return[Qe(Et,{skipFocus:!0,get style(){return ur.RowTitle},children:"Recommendations"}),Qe(_r,{autofocus:!0,onFocus:l,onEnter:h,get items(){return i()}}),Qe(Et,{skipFocus:!0,get style(){return ur.RowTitle},children:"Cast and Crew"}),Qe(_r,{onFocus:c,onEnter:h,get items(){return o()}})]}})}}),Qe(It,{ref(t){"function"==typeof u?u(t):u=t},animate:!0,style:a})]}})};function ao({id:t}){return kr.get(`/person/${t}/combined_credits`).then((({cast:t})=>Nr(t.slice(0,7))))}function lo({id:t}){return kr.get(`/person/${t}`).then((t=>({backgroundImage:Er(t.profile_path,"original"),heroContent:{title:t.title||t.name,description:t.biography},...t})))}const co=()=>{const t=In(),e=En(),[r]=W((()=>({...t})),lo),[o]=W((()=>({...t})),ao);X(G(r,(t=>{br(t.backgroundImage)}),{defer:!0}));const i={color:an("#000000"),alpha:.8,width:1540,height:440,x:130,y:180,borderRadius:30};function s(){let t=this.children.selected;n(t&&t.href),e(t.href)}return Qe(Ct,{get when(){return r()},keyed:!0,get children(){return[Qe(It,{x:150,y:200,get style(){return ur.Column},zIndex:3,get children(){return[Qe(Et,{get style(){return dr.typography.display2},get children(){return r().name}}),Qe(Et,{get style(){return ur.peopleBio},get children(){return r().biography}})]}}),Qe(It,{style:i}),Qe(hr,{y:670,x:140,get style(){return ur.Column},get children(){return Qe(Ct,{get when(){return o()},get children(){return[Qe(Et,{skipFocus:!0,get style(){return ur.RowTitle},children:"Credits"}),Qe(_r,{autofocus:!0,onEnter:s,get items(){return o()}})]}})}})]}})},ho=()=>(()=>{const t=Je("node");return rn(t,"style",{width:1920,height:1080,color:868483072}),t})();function uo(){let t,e,n=0;const r={alpha:1,color:4294967295},o={duration:1e3,easing:"ease-in-out"};return X(G(wr,(r=>r.startsWith("#")?(t.color=r,t.src="",t.alpha=1,n=1,void(e.alpha=0)):(t.color=4294967295,0===n?(t.src=r,void(n=1)):1===n?(e.src=r,n=2,e.alpha=[1],void(t.alpha=[0])):void(2===n&&(t.src=r,n=1,t.alpha=1,e.alpha=0)))),{defer:!0})),Qe(It,{width:1920,height:1080,get children(){return[Qe(It,{ref(e){"function"==typeof t?t(e):t=e},animate:!0,animationSettings:o,style:r}),Qe(It,{ref(t){"function"==typeof e?e(t):e=t},animate:!0,animationSettings:o,style:r,alpha:0}),Qe(It,{get effects(){return{radialGradient:{colors:[124,124,an(dr.color.container)],stops:[0,.4,.9],height:800,width:1920,pivot:[.8,0]}}}})]}})}const fo={Column:{...dr.flexColumn,width:320,height:600,y:360,gap:20,zIndex:101,x:[8,{duration:250,easing:"ease-in-out"}],focus:{x:[dr.layout.marginX,{duration:250,easing:"ease-in-out"}]}},Gradient:{zIndex:99,linearGradient:{angle:(po=270,po*Math.PI/180),stops:[0,.4,.8],colors:[an(dr.color.primary),an(dr.color.primary),an("#00000000")]},alpha:[0],focus:{width:1600,alpha:[1]},width:100,height:1080},NavButton:{zIndex:102,height:70,width:100,borderRadius:8,focus:{color:an(dr.color.container)},active:{width:328,height:70}}};var po;const go="/solid-demo-app/",mo=[{name:"experiment",width:81,height:100,x:0,y:0},{name:"trending",width:100,height:56,x:81,y:0},{name:"tv",width:100,height:68,x:181,y:0},{name:"movie",width:94,height:100,x:282,y:0}];function xo(t){const e=function(t,e){const n=Ie.createTexture("ImageTexture",{src:t});return e.reduce(((t,e)=>{const{x:r,y:o,width:i,height:s}=e;return t[e.name]=Ie.createTexture("SubTexture",{texture:n,x:r,y:o,width:i,height:s}),t}),{})}(go+"assets/icons_white.png",mo);return Qe(It,on(t,{get texture(){return e[t.name]},get width(){return e[t.name].props.width},get height(){return e[t.name].props.height},get x(){return(100-(e[t.name].props.width||0))/2},get y(){return(100-(e[t.name].props.height||0))/2}}))}function yo(t){return Qe(It,on(t,{forwardStates:!0,get style(){return fo.NavButton},get children(){return[Qe(It,{y:-16,get children(){return Qe(xo,{scale:.5,get name(){return t.icon}})}}),Qe(Et,{get style(){return{...dr.typography.button1,fontSize:38,x:116,y:16,height:50,alpha:0,active:{alpha:1}}},get children(){return t.children}})]}}))}function vo(t){let e;const n=En(),r="/solid-demo-app/";return[Qe(hr,on(t,{onFocus:function(){e.states.add("focus"),this.children.forEach((t=>t.states.add("active"))),this.children.selected.setFocus()},onBlur:function(){e.states.remove("focus"),this.selected=0,this.children.forEach((t=>t.states.remove("active")))},get style(){return fo.Column},animate:!0,get children(){return[Qe(yo,{onEnter:()=>n(r+"browse/all"),icon:"trending",children:"Trending"}),Qe(yo,{icon:"movie",onEnter:()=>n(r+"browse/movie"),children:"Movies"}),Qe(yo,{icon:"tv",onEnter:()=>n(r+"browse/tv"),children:"TV"}),Qe(yo,{icon:"experiment",onEnter:()=>n(r+"examples"),children:"Examples"})]}})),Qe(It,{ref(t){"function"==typeof e?e(t):e=t},get style(){return fo.Gradient}})]}const _o=()=>{((t={})=>{const e=Xn();Un={...Un,...t};const n=Object.entries(Un);X(G(Rt,((t,e,n=[])=>{let r=t;const o=[];for(;r;)r.states.has("focus")||(r.states.add("focus"),jn(r.onFocus)&&r.onFocus.call(r,t,e??null)),o.push(r),r=r.parent??null;return n.forEach((n=>{o.includes(n)||(n.states.remove("focus"),jn(n.onBlur)&&n.onBlur.call(n,t,e??null))})),Gn(o),o}),{defer:!0})),X((()=>{const t=e();if(t){const e=n.find((([e,n])=>n===t.key));H((()=>{const n=Hn();for(const r of n){const n=e?e[0]:void 0;if(n){const e=r[`on${n}`];if(jn(e)&&!0===e.call(r,t,r))break}if(jn(r.onKeyPress)&&!0===r.onKeyPress.call(r,t,n,r))break}return!1}))}}))})({Menu:"m"}),ar.setupTimers(),X(G(Hn,ar.onFocusChange,{defer:!0}));const t=En();let e,r,o;return X(G(Rt,(t=>{n(t),setTimeout((()=>{t.heroContent?(e.parent=t,e.alpha=1,e.width=t.width+10,e.height=t.height+10,e.zIndex=t.zIndex-1e-8):e.alpha=0}),10)}),{defer:!0})),Qe(It,{ref(t){const e=window.APP;"function"==typeof e?e(t):window.APP=t},onLast:()=>history.back(),onMenu:()=>t("/"),style:{width:1920,height:1080},onLeft:()=>{if(r.states.has("focus"))return!1;o=Rt(),r.setFocus()},onRight:()=>r.states.has("focus")&&o.setFocus(),get children(){return[Qe(uo,{}),Qe(vr,{get color(){return an(dr.color.focus)},ref(t){"function"==typeof e?e(t):e=t}}),Qe(Bn,{get children(){return[Qe($n,{path:"",component:Qr}),Qe($n,{path:"examples",component:Jr}),Qe($n,{path:"browse/:filter",component:Qr}),Qe($n,{path:"text",component:Zr}),Qe($n,{path:"buttons",component:to}),Qe($n,{path:"flex",component:eo}),Qe($n,{path:"flexsize",component:no}),Qe($n,{path:"flexcolumnsize",component:ro}),Qe($n,{path:"flexcolumn",component:oo}),Qe($n,{path:"buttonsmaterial",component:io}),Qe($n,{path:"entity/people/:id",component:co}),Qe($n,{path:"entity/:type/:id",component:so}),Qe($n,{path:"*all",component:ho})]}}),Qe(vo,{ref(t){"function"==typeof r?r(t):r=t}})]}})},wo=new URL("AppCoreExtensions-legacy-282736df.js",e.meta.url).href;Ae.debug=!1,Ae.fontSettings.fontFamily="Ubuntu",Ae.fontSettings.color=an("#ffffff"),Ae.fontSettings.fontSize=100,Ke((()=>Qe(We,{options:{coreExtensionModule:wo,threadXCoreWorkerUrl:void 0},get children(){return Qe(Ln,{get source(){return un((()=>window.location.hash.slice(1)),(({value:t,replace:e,scroll:n,state:r})=>{e?window.history.replaceState(r,"","#"+t):window.location.hash=t;const o=t.indexOf("#");dn(o>=0?t.slice(o+1):"",n)}),(t=>hn(window,"hashchange",(()=>t()))),{go:t=>window.history.go(t),renderPath:t=>`#${t}`,parsePath:t=>{const e=t.replace(/^.*?#/,"");if(!e.startsWith("/")){const[,t="/"]=window.location.hash.split("#",2);return`${t}#${e}`}return e}})},get children(){return Qe(_o,{})}})}})))}}}));
//# sourceMappingURL=index-legacy-94b88794.js.map
