var ge=Object.defineProperty;var me=(a,s,t)=>s in a?ge(a,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):a[s]=t;var n=(a,s,t)=>(me(a,typeof s!="symbol"?s+"":s,t),t);import{E as zt,g as xe,m as Nt,a as z,b as _t,c as V,T as ee,d as ye,e as ve,i as _e,S as Gt,f as se,B as be,h as we,j as Te,k as Ft,W as Kt,l as re,n as Se,C as Ce}from"./CoreExtension-d763954d.js";class qe extends zt{constructor(t,e,r){super();n(this,"node");n(this,"props");n(this,"settings");n(this,"propStartValues",{});n(this,"restoreValues",{});n(this,"progress",0);n(this,"timingFunction");this.node=t,this.props=e,this.settings=r,this.propStartValues={},Object.keys(e).forEach(o=>{this.propStartValues[o]=t[o]}),this.timingFunction=o=>o,r.easing&&typeof r.easing=="string"&&(this.timingFunction=xe(r.easing))}reset(){this.progress=0,this.update(0)}restore(){this.reset(),Object.keys(this.props).forEach(t=>{this.node[t]=this.propStartValues[t]})}reverse(){this.progress=0,Object.keys(this.props).forEach(t=>{const e=this.props[t],r=this.propStartValues[t];this.props[t]=r,this.propStartValues[t]=e}),this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(t,e,r){return(this.timingFunction(t)||t)*(r-e)+e}update(t){const{duration:e,loop:r,easing:o}=this.settings;if(!e){this.emit("finished",{});return}this.progress+=t/e,this.progress>1&&(this.progress=r?0:1,this.emit("finished",{})),Object.keys(this.props).forEach(i=>{const l=this.props[i],c=this.propStartValues[i],h=l;if(i.indexOf("color")!==-1){const f=o?this.timingFunction(this.progress)||this.progress:this.progress,g=Nt(c,h,f);this.node[i]=o?g:Nt(c,h,this.progress)}else this.node[i]=o?this.applyEasing(this.progress,c,h):c+(h-c)*this.progress})}}class Ze{constructor(s,t){n(this,"manager");n(this,"animation");n(this,"stoppedPromise",null);n(this,"stoppedResolve",null);n(this,"state");this.manager=s,this.animation=t,this.state="stopped"}start(){return this.makeStoppedPromise(),this.animation.once("finished",this.finished.bind(this)),this.manager.activeAnimations.has(this.animation)||this.manager.registerAnimation(this.animation),this.state="running",this}stop(){return this.manager.unregisterAnimation(this.animation),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null),this.animation.reset(),this.state="stopped",this}pause(){return this.manager.unregisterAnimation(this.animation),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){this.makeStoppedPromise();const s=this.stoppedPromise;return z(s),s}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(s=>{this.stoppedResolve=s}))}finished(){z(this.stoppedResolve);const{loop:s,stopMethod:t}=this.animation.settings;if(t==="reverse"){this.animation.reverse(),this.start();return}this.stoppedResolve(),this.stoppedResolve=null,!s&&this.manager.unregisterAnimation(this.animation)}}class Ie{constructor(){n(this,"alpha",1);n(this,"px",0);n(this,"py",0);n(this,"ta",1);n(this,"tb",0);n(this,"tc",0);n(this,"td",1)}isIdentity(){return this.alpha===1&&this.px===0&&this.py===0&&this.isIdentityMatrix()}isIdentityMatrix(){return this.ta===1&&this.tb===0&&this.tc===0&&this.td===1}isSquare(){return this.tb===0&&this.tc===0}}class oe extends zt{constructor(t,e){var r,o,i,l,c,h;super();n(this,"stage");n(this,"children",[]);n(this,"props");n(this,"recalculationType",6);n(this,"hasUpdates",!0);n(this,"worldContext",new Ie);n(this,"localPx",0);n(this,"localPy",0);n(this,"isComplex",!1);n(this,"onTextureLoaded",(t,e)=>{this.emit("txLoaded",e)});n(this,"onTextureFailed",(t,e)=>{this.emit("txFailed",e)});this.stage=t,this.props={...e,parent:null,ta:(r=e.ta)!=null?r:1,tb:(o=e.tb)!=null?o:0,tc:(i=e.tc)!=null?i:0,td:(l=e.td)!=null?l:1,worldX:(c=e.worldX)!=null?c:0,worldY:(h=e.worldY)!=null?h:0},this.parent=e.parent,this.updateLocalTransform()}loadTexture(t,e,r=null){this.props.texture&&this.unloadTexture();const{txManager:o}=this.stage,i=o.loadTexture(t,e,r);this.props.texture=i,this.props.textureOptions=r,queueMicrotask(()=>{i.state==="loaded"?this.onTextureLoaded(i,i.dimensions):i.state==="failed"&&this.onTextureFailed(i,i.error),i.on("loaded",this.onTextureLoaded),i.on("failed",this.onTextureFailed)})}unloadTexture(){this.props.texture&&(this.props.texture.off("loaded",this.onTextureLoaded),this.props.texture.off("failed",this.onTextureFailed)),this.props.texture=null,this.props.textureOptions=null}loadShader(t,e){const r=this.stage.renderer.getShaderManager();z(r);const{shader:o,props:i}=r.loadShader(t,e);this.props.shader=o,this.props.shaderProps=i}setHasUpdates(){if(!this.props.alpha)return;this.hasUpdates=!0;let t=this==null?void 0:this.props.parent;for(;t;)t.hasUpdates=!0,t=t==null?void 0:t.props.parent}setRecalculationType(t){this.recalculationType|=t,this.setHasUpdates()}updateLocalTransform(){if(this.props.rotation!==0&&this.props.rotation%(Math.PI*2)){const t=Math.sin(this.props.rotation),e=Math.cos(this.props.rotation);this.setLocalTransform(e*this.props.scale,-t*this.props.scale,t*this.props.scale,e*this.props.scale)}else this.setLocalTransform(this.props.scale,0,0,this.props.scale);this.updateLocalTranslate()}setLocalTransform(t,e,r,o){this.setRecalculationType(4),this.props.ta=t,this.props.tb=e,this.props.tc=r,this.props.td=o,this.isComplex=e!==0||r!==0||t<0||o<0}updateLocalTranslate(){this.setRecalculationType(2);const t=this.props.pivotX*this.props.width,e=this.props.pivotY*this.props.height;let r=this.props.x-(t*this.props.ta+e*this.props.tb)+t,o=this.props.y-(t*this.props.tc+e*this.props.td)+e;r-=this.props.mountX*this.props.width,o-=this.props.mountY*this.props.height,this.localPx=r,this.localPy=o}update(t){var o;const e=(o=this.props.parent)==null?void 0:o.worldContext,r=this.worldContext;r.px=((e==null?void 0:e.px)||0)+this.localPx*((e==null?void 0:e.ta)||1),r.py=((e==null?void 0:e.py)||0)+this.localPy*((e==null?void 0:e.td)||1),(e==null?void 0:e.tb)!==0&&(r.px+=this.localPy*((e==null?void 0:e.tb)||0)),(e==null?void 0:e.tc)!==0&&(r.py+=this.localPx*((e==null?void 0:e.tc)||0)),r.ta=this.props.ta*((e==null?void 0:e.ta)||1),r.tb=this.props.td*((e==null?void 0:e.tb)||0),r.tc=this.props.ta*((e==null?void 0:e.tc)||0),r.td=this.props.td*((e==null?void 0:e.td)||1),this.isComplex&&(r.ta+=this.props.tc*((e==null?void 0:e.tb)||0),r.tb+=this.props.tb*((e==null?void 0:e.ta)||1),r.tc+=this.props.tc*((e==null?void 0:e.td)||1),r.td+=this.props.tb*((e==null?void 0:e.tc)||0)),this.worldX=r.px,this.worldY=r.py,this.children.length&&this.children.forEach(i=>{i.update(t)}),this.hasUpdates=!1,this.recalculationType=0}renderQuads(t,e){const{width:r,height:o,colorTl:i,colorTr:l,colorBl:c,colorBr:h,texture:f,textureOptions:g,shader:m,shaderProps:d,scale:x}=this.props,{zIndex:p,alpha:y,worldScale:u}=this;t.addRenderable({width:r,height:o,colorTl:i,colorTr:l,colorBl:c,colorBr:h,texture:f,textureOptions:g,zIndex:p,shader:m,shaderProps:d,alpha:y,scale:x,clippingRect:e,wpx:this.worldContext.px,wpy:this.worldContext.py,worldScale:u,ta:this.worldContext.ta,tb:this.worldContext.tb,tc:this.worldContext.tc,td:this.worldContext.td})}get id(){return this.props.id}get x(){return this.props.x}set x(t){this.props.x!==t&&(this.props.x=t,this.updateLocalTranslate())}get worldX(){return this.props.worldX||0}set worldX(t){this.props.worldX=t}get worldY(){return this.props.worldY||0}set worldY(t){this.props.worldY=t}get absX(){var t,e;return this.props.x+(((t=this.props.parent)==null?void 0:t.absX)||((e=this.props.parent)==null?void 0:e.worldContext.px)||0)}get absY(){var t,e;return this.props.y+((e=(t=this.props.parent)==null?void 0:t.absY)!=null?e:0)}get y(){return this.props.y}set y(t){this.props.y!==t&&(this.props.y=t,this.updateLocalTranslate())}get width(){return this.props.width}set width(t){this.props.width!==t&&(this.props.width=t,this.updateLocalTransform())}get height(){return this.props.height}set height(t){this.props.height!==t&&(this.props.height=t,this.updateLocalTransform())}get scale(){return this.props.scale}set scale(t){this.props.scale!==t&&(this.props.scale=t,this.updateLocalTransform())}get worldScale(){var t,e;return this.props.scale*((e=(t=this.props.parent)==null?void 0:t.worldScale)!=null?e:1)||this.props.scale}get mount(){return this.props.mount}set mount(t){this.props.mountX=t,this.props.mountY=t,this.props.mount=t,this.updateLocalTranslate()}get mountX(){return this.props.mountX}set mountX(t){this.props.mountX=t,this.updateLocalTranslate()}get mountY(){return this.props.mountY}set mountY(t){this.props.mountY=t,this.updateLocalTranslate()}get pivot(){return this.props.pivot}set pivot(t){(this.props.pivotX!==t||this.props.pivotY!==t)&&(this.props.pivotX=t,this.props.pivotY=t,this.updateLocalTranslate())}get pivotX(){return this.props.pivotX}set pivotX(t){this.props.pivotX=t,this.updateLocalTranslate()}get pivotY(){return this.props.pivotY}set pivotY(t){this.props.pivotY=t,this.updateLocalTranslate()}get rotation(){return this.props.rotation}set rotation(t){this.props.rotation!==t&&(this.props.rotation=t,this.updateLocalTransform())}get alpha(){const t=this.props,e=t.parent;return e?t.alpha*e.alpha:1}set alpha(t){this.props.alpha=t}get clipping(){return this.props.clipping}set clipping(t){this.props.clipping=t}get color(){return this.props.color}set color(t){(this.props.colorTl!==t||this.props.colorTr!==t||this.props.colorBl!==t||this.props.colorBr!==t)&&(this.colorTl=t,this.colorTr=t,this.colorBl=t,this.colorBr=t),this.props.color=t}get colorTop(){return this.props.colorTop}set colorTop(t){(this.props.colorTl!==t||this.props.colorTr!==t)&&(this.colorTl=t,this.colorTr=t),this.props.colorTop=t}get colorBottom(){return this.props.colorBottom}set colorBottom(t){(this.props.colorBl!==t||this.props.colorBr!==t)&&(this.colorBl=t,this.colorBr=t),this.props.colorBottom=t}get colorLeft(){return this.props.colorLeft}set colorLeft(t){(this.props.colorTl!==t||this.props.colorBl!==t)&&(this.colorTl=t,this.colorBl=t),this.props.colorLeft=t}get colorRight(){return this.props.colorRight}set colorRight(t){(this.props.colorTr!==t||this.props.colorBr!==t)&&(this.colorTr=t,this.colorBr=t),this.props.colorRight=t}get colorTl(){return this.props.colorTl}set colorTl(t){this.props.colorTl=t}get colorTr(){return this.props.colorTr}set colorTr(t){this.props.colorTr=t}get colorBl(){return this.props.colorBl}set colorBl(t){this.props.colorBl=t}get colorBr(){return this.props.colorBr}set colorBr(t){this.props.colorBr=t}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(t){this.props.zIndexLocked=t}get zIndex(){var o,i;const t=this.props,e=t.zIndex||0,r=((o=t.parent)==null?void 0:o.zIndex)||0;return(i=t.parent)!=null&&i.zIndexLocked?e<r?e:r:e}set zIndex(t){this.props.zIndex=t}get parent(){return this.props.parent}set parent(t){const e=this.props.parent;if(e!==t){if(this.props.parent=t,e){const r=e.children.indexOf(this);z(r!==-1,"CoreNode.parent: Node not found in old parent's children!"),e.children.splice(r,1)}t&&t.children.push(this),this.updateLocalTransform()}}}class Re{constructor(s){n(this,"root");this.root=s}getNodeByType(s){return[]}getNodeById(s){return null}update(s){this.root.update(s)}}const Me=a=>{const s=()=>{a.drawFrame(),requestAnimationFrame(s)};requestAnimationFrame(s)},ke=()=>performance?performance.now():Date.now();class ie extends _t{constructor(s){super({renderer:s,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(s){const{gl:t}=this;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,s[0].ctxTexture)}}n(ie,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n          vec4 color = texture2D(u_texture, v_textureCoordinate);\n          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);\n      }\n    "});class ne extends _t{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]});n(this,"supportsIndexedTextures",!0)}bindTextures(t){const{renderer:e,gl:r}=this;if(t.length>e.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error("DefaultShaderBatched: Cannot bind more than ".concat(e.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS," textures"));t.forEach((i,l)=>{r.activeTexture(r.TEXTURE0+l),r.bindTexture(r.TEXTURE_2D,i.ctxTexture)});const o=Array.from(Array(t.length).keys());this.setUniform("u_textures[0]",o)}}n(ne,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      void main(){\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_textureIndex = a_textureIndex;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:t=>"\n      #define txUnits ".concat(t,"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textures[txUnits];\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      vec4 sampleFromTexture(sampler2D textures[").concat(t,"], int idx, vec2 uv) {\n        ").concat(Array.from(Array(t).keys()).map(e=>"\n          ".concat(e!==0?"else ":"","if (idx == ").concat(e,") {\n            return texture2D(textures[").concat(e,"], uv);\n          }\n        ")).join(""),"\n        return texture2D(textures[0], uv);\n      }\n\n      void main(){\n        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);\n      }\n    ")});class j{constructor(s){n(this,"priority",1);n(this,"name","");n(this,"ref");n(this,"target");n(this,"passParameters","");n(this,"declaredUniforms","");n(this,"uniformInfo",{});const{ref:t,target:e,props:r={}}=s;this.ref=t,this.target=e;const o={},i=[];let l="";const c=this.constructor.uniforms||{};for(const h in c){const f=c[h],g=f.type,m="".concat(t,"_").concat(h);let d="";f.size&&(d="[".concat(f.size(r),"]")),i.push(m),l+="uniform ".concat(g," ").concat(m).concat(d,";"),o[h]={name:m,uniform:c[h].method}}this.passParameters=i.join(","),this.declaredUniforms=l,this.uniformInfo=o}static getEffectKey(s){return""}static getMethodParameters(s,t){const e=[];for(const r in s){const o=s[r];let i="";o.size&&(i="[".concat(o.size(t),"]")),e.push("".concat(o.type," ").concat(r).concat(i))}return e.join(",")}static resolveDefaults(s){return{}}static makeEffectKey(s){return!1}}n(j,"uniforms",{}),n(j,"methods"),n(j,"onShaderMask"),n(j,"onColorize"),n(j,"onEffectMask");class tt extends j{constructor(){super(...arguments);n(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(t){var e;return{radius:(e=t.radius)!=null?e:10}}}n(tt,"z$__type__Props"),n(tt,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",validator:t=>{let e=t;return Array.isArray(e)?e.length===2?e=[e[0],e[1],e[0],e[1]]:e.length===3?e=[e[0],e[1],e[2],e[0]]:e.length!==4&&(e=[e[0],e[0],e[0],e[0]]):typeof e=="number"&&(e=[e,e,e,e]),e}}}),n(tt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),n(tt,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);\n  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);\n  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);\n  "),n(tt,"onEffectMask","\n  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));\n  ");class ct extends j{constructor(){super(...arguments);n(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(t){var e,r;return{width:(e=t.width)!=null?e:10,color:(r=t.color)!=null?r:4294967295}}}n(ct,"z$__type__Props"),n(ct,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>V(t),method:"uniform4fv",type:"vec4"}}),n(ct,"onEffectMask","\n  float mask = clamp(shaderMask + width, 0.0, 1.0) - clamp(shaderMask, 0.0, 1.0);\n  return mix(shaderColor, maskColor, mask);\n  "),n(ct,"onColorize","\n    return color;\n  ");class et extends j{constructor(){super(...arguments);n(this,"name","linearGradient")}static getEffectKey(t){return"linearGradient".concat(t.colors.length)}static resolveDefaults(t){var o,i;const e=(o=t.colors)!=null?o:[4278190080,4294967295];let r=t.stops;if(!r){r=[];const l=e.length-1;for(let c=0;c<e.length;c++)r.push(c*(1/l))}return{colors:e,stops:r,angle:(i=t.angle)!=null?i:0}}}n(et,"z$__type__Props"),n(et,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:t=>t.map(r=>V(r)).reduce((r,o)=>r.concat(o),[]),size:t=>t.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],validator:(t,e)=>{var l;const r=(l=e.colors)!=null?l:[];let o=t;const i=t;if(o.length===0||o&&o.length!==r.length){for(let c=0;c<r.length;c++)o[c]?(i[c]=o[c],o[c-1]===void 0&&i[c-2]!==void 0&&(i[c-1]=i[c-2]+(o[c]-i[c-2])/2)):i[c]=c*(1/(r.length-1));o=i}return i},size:t=>t.colors.length,method:"uniform1fv",type:"float"}}),n(et,"methods",{fromLinear:"\n      vec4 function(vec4 linearRGB) {\n        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);\n        vec4 lower = linearRGB * vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",toLinear:"\n      vec4 function(vec4 sRGB) {\n        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));\n        vec4 lower = sRGB/vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",calcPoint:"\n      vec2 function(float d, float angle) {\n        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);\n      }\n    "}),n(et,"ColorLoop",t=>{let e="";for(let r=2;r<t;r++)e+="colorOut = mix(colorOut, colors[".concat(r,"], clamp((dist - stops[").concat(r-1,"]) / (stops[").concat(r,"] - stops[").concat(r-1,"]), 0.0, 1.0));");return e}),n(et,"onColorize",t=>{const e=t.colors.length||1;return"\n      float a = angle - (PI / 180.0 * 90.0);\n      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));\n      vec2 f = $calcPoint(lineDist * 0.5, a);\n      vec2 t = $calcPoint(lineDist * 0.5, a + PI);\n      vec2 gradVec = t - f;\n      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));\n      for(int i = 1; i < ".concat(e,"-1; i++) {\n        stopCalc = (dist - stops[i]) / (stops[i + 1] - stops[i]);\n        colorOut = mix(colorOut, colors[i + 1], clamp(stopCalc, 0.0, 1.0));\n      }\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    ")});class Yt extends j{constructor(){super(...arguments);n(this,"name","grayscale")}static getEffectKey(){return"grayscale"}}n(Yt,"onColorize","\n    vec3 color = pow(maskColor.rgb, vec3(2.0));\n    float gray = dot(color, vec3(0.2126, 0.7152, 0.0722));\n    float gammaGray = sqrt(gray);\n    return vec4(gammaGray, gammaGray, gammaGray, 1.0);\n  ");class st extends j{constructor(){super(...arguments);n(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(t){var e,r;return{width:(e=t.width)!=null?e:10,color:(r=t.color)!=null?r:4294967295}}}n(st,"z$__type__Props"),n(st,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>V(t),method:"uniform4fv",type:"vec4"}}),n(st,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),n(st,"onEffectMask","\n  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),n(st,"onColorize","\n    return color;\n  ");class rt extends j{constructor(){super(...arguments);n(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(t){var e,r;return{width:(e=t.width)!=null?e:10,color:(r=t.color)!=null?r:4294967295}}}n(rt,"z$__type__Props"),n(rt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>V(t),method:"uniform4fv",type:"vec4"}}),n(rt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),n(rt,"onEffectMask","\n  vec2 pos = vec2(0.0, width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),n(rt,"onColorize","\n    return color;\n  ");class ot extends j{constructor(){super(...arguments);n(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(t){var e,r;return{width:(e=t.width)!=null?e:10,color:(r=t.color)!=null?r:4294967295}}}n(ot,"z$__type__Props"),n(ot,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>V(t),method:"uniform4fv",type:"vec4"}}),n(ot,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),n(ot,"onEffectMask","\n  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),n(ot,"onColorize","\n    return color;\n  ");class it extends j{constructor(){super(...arguments);n(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(t){var e,r;return{width:(e=t.width)!=null?e:10,color:(r=t.color)!=null?r:4294967295}}}n(it,"z$__type__Props"),n(it,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>V(t),method:"uniform4fv",type:"vec4"}}),n(it,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),n(it,"onEffectMask","\n  vec2 pos = vec2(width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),n(it,"onColorize","\n    return color;\n  ");class ht extends j{constructor(){super(...arguments);n(this,"name","glitch")}static getEffectKey(t){return"glitch"}static resolveDefaults(t){var e,r,o,i,l;return{amplitude:(e=t.amplitude)!=null?e:.2,narrowness:(r=t.narrowness)!=null?r:4,blockiness:(o=t.blockiness)!=null?o:2,minimizer:(i=t.minimizer)!=null?i:8,time:(l=t.time)!=null?l:Date.now()}}}n(ht,"z$__type__Props"),n(ht,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",validator:t=>(Date.now()-t)%1e3,type:"float"}}),n(ht,"methods",{rand:"\n      float function(vec2 p, float time) {\n        float t = floor(time * 20.) / 10.;\n        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);\n      }\n    ",noise:"\n      float function(vec2 uv, float blockiness, float time) {\n        vec2 lv = fract(uv);\n        vec2 id = floor(uv);\n\n        float n1 = rand(id, time);\n        float n2 = rand(id+vec2(1,0), time);\n        float n3 = rand(id+vec2(0,1), time);\n        float n4 = rand(id+vec2(1,1), time);\n        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);\n        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);\n      }\n    ",fbm:"\n      float function(vec2 uv, int count, float blockiness, float complexity, float time) {\n        float val = 0.0;\n        float amp = 0.5;\n        const int MAX_ITERATIONS = 10;\n\n        for(int i = 0; i < MAX_ITERATIONS; i++) {\n          if(i >= count) {break;}\n          val += amp * noise(uv, blockiness, time);\n          amp *= 0.5;\n          uv *= complexity;\n        }\n        return val;\n      }\n    "}),n(ht,"onColorize","\n    vec2 uv = v_textureCoordinate.xy;\n    float aspect = u_dimensions.x / u_dimensions.y;\n    vec2 a = vec2(uv.x * aspect , uv.y);\n    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));\n\n    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);\n    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);\n    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);\n    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);\n\n    vec3 f = vec3(colR, colG, colB);\n    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);\n  ");class gt extends j{constructor(){super(...arguments);n(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(t){var e;return{fade:(e=t.fade)!=null?e:10}}}n(gt,"z$__type__Props"),n(gt,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:t=>{let e=t;return Array.isArray(e)?e.length===2?e=[e[0],e[1],e[0],e[1]]:e.length===3?e=[e[0],e[1],e[2],e[0]]:e.length!==4&&(e=[e[0],e[0],e[0],e[0]]):typeof e=="number"&&(e=[e,e,e,e]),e}}}),n(gt,"onColorize","\n  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;\n  vec2 pos1;\n  vec2 pos2;\n  vec2 d;\n  float c;\n  vec4 result = maskColor;\n\n\n  if(fade[0] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x, point.y + fade[0]);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[1] > 0.0) {\n    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);\n    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[2] > 0.0) {\n    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);\n    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[3] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x + fade[3], point.y);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  return result;\n  ");class mt extends j{constructor(){super(...arguments);n(this,"name","radialGradient")}static getEffectKey(t){return"radialGradient".concat(t.colors.length)}static resolveDefaults(t){var o,i,l,c,h;const e=(o=t.colors)!=null?o:[4278190080,4294967295];let r=t.stops;if(!r){r=[];const f=e.length-1;for(let g=0;g<e.length;g++)r.push(g*(1/f))}return{colors:e,stops:r,width:(i=t.width)!=null?i:0,height:(c=(l=t.height)!=null?l:t.width)!=null?c:0,pivot:(h=t.pivot)!=null?h:[.5,.5]}}}n(mt,"z$__type__Props"),n(mt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:t=>t.map(r=>V(r)).reduce((r,o)=>r.concat(o),[]),size:t=>t.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],validator:(t,e)=>{var l;const r=(l=e.colors)!=null?l:[];let o=t;const i=t;if(o.length===0||o&&o.length!==r.length){for(let c=0;c<r.length;c++)o[c]?(i[c]=o[c],o[c-1]===void 0&&i[c-2]!==void 0&&(i[c-1]=i[c-2]+(o[c]-i[c-2])/2)):i[c]=c*(1/(r.length-1));o=i}return i},size:t=>t.colors.length,method:"uniform1fv",type:"float"}}),n(mt,"onColorize",t=>{const e=t.colors.length||1;return"\n      vec2 point = v_textureCoordinate.xy * u_dimensions;\n      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);\n\n      float dist = length((point - projection) / vec2(width, height));\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = mix(colors[0], colors[1], stopCalc);\n      for(int i = 1; i < ".concat(e,"-1; i++) {\n        stopCalc = (dist - stops[i]) / (stops[i + 1] - stops[i]);\n        colorOut = mix(colorOut, colors[i + 1], clamp(stopCalc, 0.0, 1.0));\n      }\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    ")});const Dt={radius:tt,border:ct,borderBottom:ot,borderLeft:it,borderRight:st,borderTop:rt,fadeOut:gt,linearGradient:et,radialGradient:mt,grayscale:Yt,glitch:ht},K=class K extends _t{constructor(t,e,r){const o=K.createShader(e,r);super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...o.uniforms],shaderSources:{vertex:o.vertex,fragment:o.fragment}});n(this,"effects",[]);this.effects=o.effects}bindTextures(t){const{gl:e}=this;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t[0].ctxTexture)}bindProps(t){var e;(e=t.effects)==null||e.forEach((r,o)=>{var f;const i=this.effects[o],l=Dt[i.name],c=(f=r.props)!=null?f:{},h=i.uniformInfo;Object.keys(c).forEach(g=>{const m=l.uniforms[g],d=h[g];let x=m.validator?m.validator(c[g],c):c[g];Array.isArray(x)&&(x=new Float32Array(x)),this.setUniform(d.name,x)})})}static createShader(t,e){const r={},o={};let i="";const l=[],c=[],h=t.effects.map(x=>{const p=e[x.type],y=p.getEffectKey(x.props||{});r[y]=r[y]?++r[y]:1;const u=r[y];u===1&&c.push({key:y,type:x.type,props:x.props});const _=new p({ref:"".concat(y).concat(u===1?"":u),target:y,props:x.props});return i+=_.declaredUniforms,l.push(...Object.values(_.uniformInfo)),_});let f="";c==null||c.forEach(x=>{var P;const p=e[x.type],y=p.resolveDefaults((P=x.props)!=null?P:{}),u=[];for(const v in p.methods){let I=v;const S=p.methods[v];o[v]&&o[v]!==S&&(I=K.resolveMethodDuplicate(v,S,o)),o[I]=S.replace("function",I),u.push({m:v,cm:I})}let _=p.onShaderMask instanceof Function?p.onShaderMask(y):p.onShaderMask,C=p.onColorize instanceof Function?p.onColorize(y):p.onColorize,b=p.onEffectMask instanceof Function?p.onEffectMask(y):p.onEffectMask;u.forEach(v=>{const{m:I,cm:S}=v,O=new RegExp("\\$".concat(I),"g");_&&(_=_.replace(O,S)),C&&(C=C.replace(O,S)),b&&(b=b.replace(O,S))});const k=p.getMethodParameters(p.uniforms,y),D=k.length>0?", ".concat(k):"";_&&(f+="\n        float fx_".concat(x.key,"_onShaderMask(float shaderMask ").concat(D,") {\n          ").concat(_,"\n        }\n        ")),C&&(f+="\n          vec4 fx_".concat(x.key,"_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(D,") {\n            ").concat(C,"\n          }\n        ")),b&&(f+="\n          vec4 fx_".concat(x.key,"_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(D,") {\n            ").concat(b,"\n          }\n        "))});let g="";for(const x in o)g+=o[x];let m="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",d="\n\n    ";for(let x=0;x<h.length;x++){const p=h[x],y=p.passParameters.length>0?", ".concat(p.passParameters):"",u=Dt[p.name];u.onShaderMask&&(d+="\n        shaderMask = fx_".concat(p.target,"_onShaderMask(shaderMask ").concat(y,");\n        ")),u.onColorize&&(d+="\n        maskColor = fx_".concat(p.target,"_onColorize(shaderMask, maskColor, shaderColor").concat(y,");\n        ")),u.onEffectMask&&(m="fx_".concat(p.target,"_onEffectMask(shaderMask, maskColor, shaderColor").concat(y,")"));const _=h[x+1];(_===void 0||Dt[_.name].onEffectMask)&&(d+="\n          shaderColor = ".concat(m,";\n        "))}return{effects:h,uniforms:l,fragment:K.fragment(i,g,f,d),vertex:K.vertex()}}static resolveMethodDuplicate(t,e,r,o=0){const i=t+(o>0?o:"");return r[i]&&r[i]!==e?this.resolveMethodDuplicate(t,e,r,++o):i}static resolveDefaults(t,e){var r;return{effects:((r=t.effects)!=null?r:[]).map(o=>({type:o.type,props:e[o.type].resolveDefaults(o.props||{})})),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(t,e){var o;let r="";return(o=t.effects)==null||o.forEach(i=>{const c=e[i.type].getEffectKey(i.props||{});r+=",".concat(c)}),"DynamicShader".concat(r)}};n(K,"z$__type__Props"),n(K,"vertex",()=>"\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    attribute vec2 a_textureCoordinate;\n    attribute vec2 a_position;\n    attribute vec4 a_color;\n    attribute float a_textureIndex;\n\n    uniform vec2 u_resolution;\n    uniform float u_pixelRatio;\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying float v_textureIndex;\n\n    void main(){\n      vec2 normalized = a_position * u_pixelRatio / u_resolution;\n      vec2 zero_two = normalized * 2.0;\n      vec2 clip_space = zero_two - 1.0;\n\n      // pass to fragment\n      v_color = a_color;\n      v_textureCoordinate = a_textureCoordinate;\n      v_textureIndex = a_textureIndex;\n\n      // flip y\n      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n    }\n  "),n(K,"fragment",(t,e,r,o)=>"\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    #define PI 3.14159265359\n\n    uniform vec2 u_resolution;\n    uniform vec2 u_dimensions;\n    uniform float u_alpha;\n    uniform float u_radius;\n    uniform sampler2D u_texture;\n    uniform float u_pixelRatio;\n\n    ".concat(t,"\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n\n    ").concat(e,"\n\n    ").concat(r,"\n\n    void main() {\n      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;\n      vec2 d = abs(p) - (u_dimensions) * 0.5;\n      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n\n      vec4 shaderColor = vec4(0.0);\n      float shaderMask = lng_DefaultMask;\n\n      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;\n\n      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));\n\n      ").concat(o,"\n\n      gl_FragColor = shaderColor * u_alpha;\n    }\n  "));let ft=K;class Pt extends _t{constructor(s){super({renderer:s,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(s){return{radius:s.radius||10,$dimensions:{width:0,height:0}}}bindTextures(s){const{gl:t}=this;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,s[0].ctxTexture)}bindProps(s){this.setUniform("u_radius",s.radius)}canBatchShaderProps(s,t){return s.radius===t.radius&&s.$dimensions.width===t.$dimensions.width&&s.$dimensions.height===t.$dimensions.height}}n(Pt,"z$__type__Props"),n(Pt,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform vec2 u_dimensions;\n      uniform float u_radius;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      float boxDist(vec2 p, vec2 size, float radius){\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n\n      float fillMask(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n\n      void main() {\n        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;\n        vec2 halfDimensions = u_dimensions * 0.5;\n\n        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);\n        gl_FragColor = mix(vec4(0.0), color, fillMask(d));\n      }\n    "});const Ot=class Ot extends _t{constructor(s){super({renderer:s,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_offset",uniform:"uniform2fv"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(s){const{gl:t}=this;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,s[0].ctxTexture)}bindProps(s){const t=Ot.resolveDefaults(s);for(const e in t)if(e==="offset")this.setUniform("u_offset",t[e]);else if(e==="color"){const r=V(t.color);this.setUniform("u_color",r)}else e==="size"?this.setUniform("u_size",t[e]):e==="distanceRange"?this.setUniform("u_distanceRange",t[e]):e==="debug"&&this.setUniform("u_debug",t[e]?1:0)}static resolveDefaults(s={}){var t,e,r,o,i;return{offset:(t=s.offset)!=null?t:[0,0],color:(e=s.color)!=null?e:4294967295,size:(r=s.size)!=null?r:16,distanceRange:(o=s.distanceRange)!=null?o:1,debug:(i=s.debug)!=null?i:!1}}};n(Ot,"shaderSources",{vertex:"\n      // an attribute is an input (in) to a vertex shader.\n      // It will receive data from a buffer\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n\n      uniform vec2 u_offset;\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n      uniform float u_size;\n\n      varying vec2 v_texcoord;\n\n      void main() {\n        gl_Position = vec4(((a_position * u_size + u_offset) * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1), 0, 1);\n        v_texcoord = a_textureCoordinate;\n      }\n    ",fragment:"\n      precision highp float;\n\n      uniform vec4 u_color;\n      uniform sampler2D u_texture;\n      uniform float u_distanceRange;\n      uniform float u_pixelRatio;\n      uniform int u_debug;\n\n      varying vec2 v_texcoord;\n\n      float median(float r, float g, float b) {\n          return max(min(r, g), min(max(r, g), b));\n      }\n\n      void main() {\n          vec3 sample = texture2D(u_texture, v_texcoord).rgb;\n          if (u_debug == 1) {\n            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);\n            return;\n          }\n          float scaledDistRange = u_distanceRange * u_pixelRatio;\n          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);\n          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;\n\n          // Build the final color.\n          // IMPORTANT: We must premultiply the color by the alpha value before returning it.\n          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);\n      }\n    "});let At=Ot;class Ee{constructor(){n(this,"shCache",new Map);n(this,"shConstructors",{});n(this,"attachedShader",null);n(this,"effectConstructors",{});n(this,"renderer");this.registerShaderType("DefaultShader",ie),this.registerShaderType("DefaultShaderBatched",ne),this.registerShaderType("RoundedRectangle",Pt),this.registerShaderType("DynamicShader",ft),this.registerShaderType("SdfShader",At),this.registerEffectType("border",ct),this.registerEffectType("borderBottom",ot),this.registerEffectType("borderLeft",it),this.registerEffectType("borderRight",st),this.registerEffectType("borderTop",rt),this.registerEffectType("fadeOut",gt),this.registerEffectType("linearGradient",et),this.registerEffectType("radialGradient",mt),this.registerEffectType("grayscale",Yt),this.registerEffectType("glitch",ht),this.registerEffectType("radius",tt)}registerShaderType(s,t){this.shConstructors[s]=t}registerEffectType(s,t){this.effectConstructors[s]=t}loadShader(s,t){if(!this.renderer)throw new Error("Renderer is not been defined");const e=this.shConstructors[s];if(!e)throw new Error('Shader type "'.concat(s,'" is not registered'));if(s==="DynamicShader")return this.loadDynamicShader(t);const r=e.resolveDefaults(t),o=e.makeCacheKey(r)||e.name;if(o&&this.shCache.has(o))return{shader:this.shCache.get(o),props:r};const i=new e(this.renderer,t);return o&&this.shCache.set(o,i),{shader:i,props:r}}loadDynamicShader(s){if(!this.renderer)throw new Error("Renderer is not been defined");const t=ft.resolveDefaults(s,this.effectConstructors),e=ft.makeCacheKey(t,this.effectConstructors);if(e&&this.shCache.has(e))return{shader:this.shCache.get(e),props:t};const r=new ft(this.renderer,s,this.effectConstructors);return e&&this.shCache.set(e,r),{shader:r,props:t}}useShader(s){this.attachedShader!==s&&(this.attachedShader&&this.attachedShader.detach(),s.attach(),this.attachedShader=s)}}class Oe{constructor(){n(this,"activeAnimations",new Set)}registerAnimation(s){this.activeAnimations.add(s)}unregisterAnimation(s){this.activeAnimations.delete(s)}update(s){this.activeAnimations.forEach(t=>{t.update(s)})}}const xt=class xt extends ee{constructor(t,e){super(t);n(this,"props");this.props=xt.resolveDefaults(e)}async getTextureData(){const{src:t,premultiplyAlpha:e}=this.props;if(!t)return{data:null};if(t instanceof ImageData)return{data:t,premultiplyAlpha:e};const o=await(await fetch(t)).blob();return{data:await createImageBitmap(o,{premultiplyAlpha:e?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"})}}static makeCacheKey(t){const e=xt.resolveDefaults(t);return e.src instanceof ImageData?!1:"ImageTexture,".concat(e.src,",").concat(e.premultiplyAlpha)}static resolveDefaults(t){var e,r;return{src:(e=t.src)!=null?e:"",premultiplyAlpha:(r=t.premultiplyAlpha)!=null?r:!0}}};n(xt,"z$__type__Props");let Lt=xt;const yt=class yt extends ee{constructor(t,e){super(t);n(this,"props");this.props=yt.resolveDefaults(e)}async getTextureData(){const{width:t,height:e}=this.props,r=t*e*4,o=new Uint8ClampedArray(r);for(let i=0;i<r;i+=4){const l=Math.floor(Math.random()*256);o[i]=l,o[i+1]=l,o[i+2]=l,o[i+3]=255}return{data:new ImageData(o,t,e)}}static makeCacheKey(t){const e=yt.resolveDefaults(t);return"NoiseTexture,".concat(e.width,",").concat(e.height,",").concat(e.cacheId)}static resolveDefaults(t){var e,r,o;return{width:(e=t.width)!=null?e:128,height:(r=t.height)!=null?r:128,cacheId:(o=t.cacheId)!=null?o:0}}};n(yt,"z$__type__Props");let $t=yt;class ze{constructor(){n(this,"usedMemory",0);n(this,"txConstructors",{});n(this,"textureKeyCache",new Map);n(this,"textureIdCache",new Map);n(this,"ctxTextureCache",new WeakMap);n(this,"textureRefCountMap",new WeakMap);n(this,"renderer");this.registerTextureType("ImageTexture",Lt),this.registerTextureType("ColorTexture",ye),this.registerTextureType("NoiseTexture",$t),this.registerTextureType("SubTexture",ve)}registerTextureType(s,t){this.txConstructors[s]=t}loadTexture(s,t,e=null){var i;const r=this.txConstructors[s];if(!r)throw new Error('Texture type "'.concat(s,'" is not registered'));let o;if((e==null?void 0:e.id)!==void 0&&this.textureIdCache.has(e.id)&&(o=this.textureIdCache.get(e.id)),!o){const l=e==null?void 0:e.id,c=(i=e==null?void 0:e.cacheKey)!=null?i:r.makeCacheKey(t);c&&this.textureKeyCache.has(c)?o=this.textureKeyCache.get(c):o=new r(this,t),l&&this.addTextureIdToCache(l,c,o)}return e!=null&&e.preload&&this.getCtxTexture(o).load(),o}addTextureIdToCache(s,t,e){const{textureIdCache:r,textureRefCountMap:o}=this;r.set(s,e),o.has(e)?o.get(e).count++:(o.set(e,{cacheKey:t,count:1}),t&&this.textureKeyCache.set(t,e))}removeTextureIdFromCache(s){const{textureIdCache:t,textureRefCountMap:e}=this,r=t.get(s);if(r&&(t.delete(s),e.has(r))){const o=e.get(r);z(o),o.count--,o.count===0&&(e.delete(r),o.cacheKey&&this.textureKeyCache.delete(o.cacheKey))}}getDebugInfo(){return{keyCacheSize:this.textureKeyCache.size,idCacheSize:this.textureIdCache.size}}getCtxTexture(s){if(this.ctxTextureCache.has(s))return this.ctxTextureCache.get(s);const t=this.renderer.createCtxTexture(s);return this.ctxTextureCache.set(s,t),t}}class ae{constructor(s){n(this,"textRenderers");this.textRenderers=s}addFontFace(s){for(const t in this.textRenderers){const e=this.textRenderers[t];e&&e.isFontFaceSupported(s)&&e.addFontFace(s)}}static resolveFontFace(s,t){const e=[];return s.reduce((o,i)=>{if(o)return o;const l=i[t.fontFamily];if(!l)return;const c=new Set(l);for(const h of c)(h.descriptors.stretch!==t.fontStretch||h.descriptors.style!==t.fontStyle||h.descriptors.weight!==t.fontWeight)&&c.delete(h);return c.values().next().value},void 0)||e[0]}}const Fe={x:(a,s)=>{a.props.x=s},y:(a,s)=>{a.props.y=s},width:(a,s)=>{a.props.width=s},height:(a,s)=>{a.props.height=s},color:(a,s)=>{a.props.color=s},alpha:(a,s)=>{a.props.alpha=s},zIndex:(a,s)=>{a.props.zIndex=s},fontFamily:(a,s)=>{a.props.fontFamily=s},fontWeight:(a,s)=>{a.props.fontWeight=s},fontStyle:(a,s)=>{a.props.fontStyle=s},fontStretch:(a,s)=>{a.props.fontStretch=s},fontSize:(a,s)=>{a.props.fontSize=s},text:(a,s)=>{a.props.text=s},textAlign:(a,s)=>{a.props.textAlign=s},contain:(a,s)=>{a.props.contain=s},offsetY:(a,s)=>{a.props.offsetY=s},scrollable:(a,s)=>{a.props.scrollable=s},scrollY:(a,s)=>{a.props.scrollY=s},letterSpacing:(a,s)=>{a.props.letterSpacing=s},debug:(a,s)=>{a.props.debug=s}};class le{constructor(s){n(this,"stage");n(this,"set");this.stage=s,this.set=Object.freeze({...Fe,...this.getPropertySetters()})}setStatus(s,t,e){s.status!==t&&(s.status=t,s.emitter.emit(t,e))}}const De=24;function Pe(a,s,t,e,r,o,i){let l=0;r&&(l=Math.min(Math.max(Math.floor(r.y1/a),0),o.length));const c=0,h=s/t+l*e;if(!(i&&h>=i/t))return{x:c,y:h,lineIndex:l}}class Mt{constructor(s,t=0){n(this,"iterator");n(this,"peekBuffer",[]);n(this,"_lastIndex");this.iterator=s,this.iterator=s,this._lastIndex=t-1,this.peekBuffer=[]}next(){const s=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return s.done?this._lastIndex=-1:this._lastIndex++,s}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const s=this.iterator.next();return this.peekBuffer.push(s),s}get lastIndex(){return this._lastIndex}}function*kt(a,s=0){let t=s;for(;t<a.length;){const e=a.codePointAt(t);if(e===void 0)throw new Error("Invalid Unicode code point");yield e,t+=e<=65535?1:2}}function Ae(a,s,t){const e=t.shapeText(s,new Mt(kt(a,0),0));let r=0;for(const o of e)o.mapped&&(r+=o.xAdvance);return r}function Le(a,s,t,e,r,o,i,l,c,h,f,g,m,d,x,p){z(d,"Font face must be loaded"),z(d.loaded,"Font face must be loaded"),z(d.data,"Font face must be loaded"),z(d.shaper,"Font face must be loaded");const y=d.data.info.size,u=l/y,_=o/u,C=c/u,b=g[a],k=(b==null?void 0:b.codepointIndex)||0,D=(b==null?void 0:b.maxX)||0,P=(b==null?void 0:b.maxY)||0;let v=D,I=P,S=s,O=t,T=0;const R={codepointIndex:-1,bufferOffset:-1,xStart:-1},A=d.shaper,$={letterSpacing:C};let nt=A.shapeText($,new Mt(kt(e,k),k)),L,N=-1;const Q=[],Wt="...",fe=i/u,ue=Ae(Wt,$,A);let bt=!0;for(;bt;){const Z=f!=="both"||p||O+y+y<=fe,G=Z?_:_-ue;let X=0;for(;(L=nt.next())&&!L.done;){const F=L.value;if(a===g.length)g.push({codepointIndex:F.cluster,maxY:I,maxX:v});else if(a>g.length)throw new Error("Unexpected lineCache length");if(F.codepoint===32||F.codepoint===10?R.codepointIndex!==-1&&(R.codepointIndex=-1,X=S):R.codepointIndex===-1&&(R.codepointIndex=F.cluster,R.bufferOffset=T,R.xStart=X),F.mapped){const ut=S+F.xOffset+F.width;if(f!=="none"&&ut>=G&&R.codepointIndex!==-1&&R.codepointIndex<F.cluster&&R.xStart>0)if(Z){nt=A.shapeText($,new Mt(kt(e,R.codepointIndex),R.codepointIndex)),T=R.bufferOffset;break}else nt=A.shapeText($,new Mt(kt(Wt,0),0)),S=R.xStart,T=R.bufferOffset;else{const W=S+F.xOffset,dt=O+F.yOffset,de=m?O+y>=m.y1/u:!0,pe=m?O<=m.y2/u:!0;if(de&&pe){N===-1&&(N=T);const wt=d.getAtlasEntry(F.glyphId),Tt=wt.x/d.data.common.scaleW,St=wt.y/d.data.common.scaleH,Ht=wt.width/d.data.common.scaleW,Ut=wt.height/d.data.common.scaleH;h[T++]=W,h[T++]=dt,h[T++]=Tt,h[T++]=St,h[T++]=W+F.width,h[T++]=dt,h[T++]=Tt+Ht,h[T++]=St,h[T++]=W,h[T++]=dt+F.height,h[T++]=Tt,h[T++]=St+Ut,h[T++]=W+F.width,h[T++]=dt+F.height,h[T++]=Tt+Ht,h[T++]=St+Ut}I=Math.max(I,dt+F.height),S+=F.xAdvance,v=Math.max(v,S)}}else if(F.codepoint===10)break}N!==-1&&(Q.push({bufferStart:N,bufferEnd:T}),N=-1),S=0,O+=y,a++,R.codepointIndex=-1,X=0,(!x&&f==="both"&&m&&O>m.y2/u||L&&L.done||f==="both"&&!p&&!Z)&&(bt=!1)}if(r==="center"){const Z=f==="none"?v:_;for(let G=0;G<Q.length;G++){const X=Q[G],F=h[X.bufferEnd-4]-h[X.bufferStart],ut=(Z-F)/2;for(let W=X.bufferStart;W<X.bufferEnd;W+=4)h[W]+=ut}}else if(r==="right"){const Z=f==="none"?v:_;for(let G=0;G<Q.length;G++){const X=Q[G],F=X.bufferEnd===X.bufferStart?0:h[X.bufferEnd-4]-h[X.bufferStart],ut=Z-F;for(let W=X.bufferStart;W<X.bufferEnd;W+=4)h[W]+=ut}}return z(L),{bufferNumFloats:T,bufferNumQuads:T/16,layoutNumCharacters:L.done?e.length-k:L.value.cluster-k+1,fullyProcessed:!!L.done,maxX:v,maxY:I}}function $e(a,s,t,e,r,o){const i=e*r,l=o.x1-a,c=o.y1-s;return _e(o)?{x1:l,y1:c+t-i,x2:l+(o.x2-o.x1),y2:c+t+(o.y2-o.y1)+i}:{x1:0,y1:0,x2:0,y2:0}}class je extends le{constructor(t){super(t);n(this,"ssdfFontFamilies",{});n(this,"msdfFontFamilies",{});n(this,"sdfShader");this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader}getPropertySetters(){return{fontFamily:(t,e)=>{t.props.fontFamily=e,t.trFontFace=void 0,this.invalidateCache(t)},fontWeight:(t,e)=>{t.props.fontWeight=e,t.trFontFace=void 0,this.invalidateCache(t)},fontStyle:(t,e)=>{t.props.fontStyle=e,t.trFontFace=void 0,this.invalidateCache(t)},fontStretch:(t,e)=>{t.props.fontStretch=e,t.trFontFace=void 0,this.invalidateCache(t)},fontSize:(t,e)=>{t.props.fontSize=e,this.invalidateCache(t)},text:(t,e)=>{t.props.text=e,this.invalidateCache(t)},textAlign:(t,e)=>{t.props.textAlign=e,this.invalidateCache(t)},color:(t,e)=>{t.props.color=e},alpha:(t,e)=>{t.props.alpha=e},x:(t,e)=>{t.props.x=e},y:(t,e)=>{t.props.y=e},contain:(t,e)=>{t.props.contain=e,this.invalidateCache(t)},width:(t,e)=>{t.props.width=e,this.invalidateCache(t)},height:(t,e)=>{t.props.height=e,this.invalidateCache(t)},offsetY:(t,e)=>{t.props.offsetY=e,this.invalidateCache(t)},scrollable:(t,e)=>{t.props.scrollable=e,this.invalidateCache(t)},scrollY:(t,e)=>{t.props.scrollY=e},letterSpacing:(t,e)=>{t.props.letterSpacing=e,this.invalidateCache(t)},debug:(t,e)=>{t.props.debug=e}}}canRenderFont(t){const{fontFamily:e}=t;return e in this.ssdfFontFamilies||e in this.msdfFontFamilies||e==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(t){return t instanceof Gt}addFontFace(t){z(t instanceof Gt);const e=t.fontFamily,r=t.type==="ssdf"?this.ssdfFontFamilies:t.type==="msdf"?this.msdfFontFamilies:void 0;if(!r){console.warn("Invalid font face type: ".concat(t.type));return}let o=r[e];o||(o=new Set,r[e]=o),o.add(t)}createState(t){return{props:t,status:"initialState",emitter:new zt,lineCache:[],forceFullLayoutCalc:!1,renderWindow:void 0,bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(t){performance.now();let{trFontFace:e}=t;const{textH:r,lineCache:o,debugData:i,forceFullLayoutCalc:l}=t;if(i.updateCount++,t.status==="initialState"&&this.setStatus(t,"loading"),!e&&(e=this.resolveFontFace(t.props),t.trFontFace=e,!e)){const A="SdfTextRenderer: Could not resolve font face for family: '".concat(t.props.fontFamily,"'");console.error(A),this.setStatus(t,"failed",new Error(A));return}if(!e.loaded){e.on("loaded",function A(){t.emitter.emit("fontLoaded",{}),e==null||e.off("fontLoaded",A)});return}z(e.data,"Font face data should be loaded");const{text:c,fontSize:h,x:f,y:g,contain:m,width:d,height:x,scrollable:p}=t.props,y=m==="both"&&p?t.props.scrollY:0;let{renderWindow:u}=t;const _=e.data.info.size,C=h/_;t.distanceRange=C*e.data.distanceField.distanceRange;const b=c.length*De;let k=t.vertexBuffer;(!k||k.length<b)&&(k=new Float32Array(b*2));const D={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight},P={x1:f,y1:g,x2:m!=="none"?f+d:1/0,y2:m==="both"?g+x:1/0},v=se(D,P);if(!l&&u){if(f+u.x1<=v.x1&&f+u.x2>=v.x2&&g-y+u.y1<=v.y1&&g-y+u.y2>=v.y2)return;t.renderWindow=u=void 0}const{offsetY:I,textAlign:S}=t.props;if(!u){const A=v.y2-v.y1,$=Math.ceil(A/_);u=$e(f,g,y,_,$,v)}const O=Pe(h,I,C,_,u,o,r);if(!O){this.setStatus(t,"loaded");return}const{letterSpacing:T}=t.props,R=Le(O.lineIndex,O.x,O.y,c,S,d,x,h,T,k,m,o,u,e,l,p);t.bufferUploaded=!1,t.bufferNumFloats=R.bufferNumFloats,t.bufferNumQuads=R.bufferNumQuads,t.vertexBuffer=k,t.renderWindow=u,i.lastLayoutNumCharacters=R.layoutNumCharacters,i.bufferSize=k.byteLength,R.fullyProcessed&&(t.textW=R.maxX*C,t.textH=R.maxY*C),this.setStatus(t,"loaded")}renderQuads(t,e){var A,$,nt;if(!t.vertexBuffer)return;performance.now();const{renderer:r}=this.stage;this.stage.options;const{fontSize:o,color:i,alpha:l,x:c,y:h,contain:f,width:g,height:m,scrollable:d,zIndex:x,debug:p}=t.props,y=f==="both"&&d?t.props.scrollY:0,{textW:u=0,textH:_=0,distanceRange:C,vertexBuffer:b,bufferNumFloats:k,bufferUploaded:D,renderWindow:P,debugData:v,trFontFace:I}=t;let{webGlBuffers:S}=t;if(!S){const L=r.gl,N=4*Float32Array.BYTES_PER_ELEMENT,Q=L.createBuffer();z(Q),t.webGlBuffers=new be([{buffer:Q,attributes:{a_position:{name:"a_position",size:2,type:L.FLOAT,normalized:!1,stride:N,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:L.FLOAT,normalized:!1,stride:N,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),t.bufferUploaded=!1,z(t.webGlBuffers),S=t.webGlBuffers}if(!D){const L=r.gl,N=(A=S==null?void 0:S.getBuffer("a_textureCoordinate"))!=null?A:null;L.bindBuffer(L.ARRAY_BUFFER,N),L.bufferData(L.ARRAY_BUFFER,b,L.STATIC_DRAW),t.bufferUploaded=!0}z(I);const O=new we(r.gl,r.options,S,this.sdfShader,{color:Te(i,l),size:o/((($=I.data)==null?void 0:$.info.size)||0),offset:[c,h-y],distanceRange:C,debug:p.sdfShaderDebug},l,e,{height:_,width:u},0,x),T=(nt=t.trFontFace)==null?void 0:nt.texture;z(T);const R=this.stage.txManager.getCtxTexture(T);O.addTexture(R),O.length=t.bufferNumFloats,O.numQuads=t.bufferNumQuads,r.addRenderable(O)}resolveFontFace(t){return ae.resolveFontFace([this.msdfFontFamilies,this.ssdfFontFamilies],t)}invalidateCache(t){t.renderWindow=void 0,t.textH=void 0,t.textW=void 0,t.lineCache=[],this.setStatus(t,"loading")}}const Vt=2048;class Xe{constructor(s,t){n(this,"_canvas");n(this,"_context");n(this,"_settings");n(this,"renderInfo");this._canvas=s,this._context=t,this._settings=this.mergeDefaults({})}set settings(s){this._settings=this.mergeDefaults(s)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const s=[this._settings.fontFace],t=[];for(let e=0,r=s.length;e<r;e++)s[e]==="serif"||s[e]==="sans-serif"?t.push(s[e]):t.push('"'.concat(s[e],'"'));return"".concat(this._settings.fontStyle," ").concat(this._settings.fontSize*this.getPrecision(),"px ").concat(t.join(","))}_load(){if(document.fonts){const s=this._getFontSetting();try{if(!document.fonts.check(s,this._settings.text))return document.fonts.load(s,this._settings.text).catch(t=>{console.warn("[Lightning] Font load error",t,s)}).then(()=>{document.fonts.check(s,this._settings.text)||console.warn("[Lightning] Font not found",s)})}catch(t){console.warn("[Lightning] Can't check font loading for "+s)}}}calculateRenderInfo(){const s={},t=this.getPrecision(),e=this._settings.paddingLeft*t,r=this._settings.paddingRight*t,o=this._settings.fontSize*t;let i=this._settings.offsetY===null?null:this._settings.offsetY*t,l=(this._settings.lineHeight||o)*t;const c=this._settings.w*t,h=this._settings.h*t;let f=this._settings.wordWrapWidth*t;const g=this._settings.cutSx*t,m=this._settings.cutEx*t,d=this._settings.cutSy*t,x=this._settings.cutEy*t,p=(this._settings.letterSpacing||0)*t,y=this._settings.textIndent*t;this.setFontProperties();let u=c||2048/this.getPrecision(),_=u-e;if(_<10&&(u+=10-_,_=10),f||(f=_),this._settings.textOverflow&&!this._settings.wordWrap){let v;switch(this._settings.textOverflow){case"clip":v="";break;case"ellipsis":v=this._settings.maxLinesSuffix;break;default:v=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,f-y,v)}let C;if(this._settings.wordWrap)C=this.wrapText(this._settings.text,f,p,y);else{C={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const v=C.l.length;for(let I=0;I<v-1;I++)C.n.push(I)}let b=C.l;if(this._settings.maxLines&&b.length>this._settings.maxLines){const v=b.slice(0,this._settings.maxLines);let I=null;if(this._settings.maxLinesSuffix){const A=this._settings.maxLinesSuffix?this.measureText(this._settings.maxLinesSuffix):0,$=this.wrapText(v[v.length-1],f-A,p,y);v[v.length-1]="".concat($.l[0]).concat(this._settings.maxLinesSuffix),I=[$.l.length>1?$.l[1]:""]}else I=[""];let S;const O=b.length;let T=0;const R=C.n.length;for(S=this._settings.maxLines;S<O;S++)I[T]+="".concat(I[T]?" ":"").concat(b[S]),S+1<R&&C.n[S+1]&&T++;s.remainingText=I.join("\n"),s.moreTextLines=!0,b=v}else s.moreTextLines=!1,s.remainingText="";let k=0;const D=[];for(let v=0;v<b.length;v++){const I=this.measureText(b[v],p)+(v===0?y:0);D.push(I),k=Math.max(k,I)}s.lineWidths=D,c||(u=k+e+r,_=k),l=l||o;let P;if(h)P=h;else{const v=this._settings.textBaseline!="bottom"?.5*o:0;P=l*(b.length-1)+v+Math.max(l,o)+(i||0)}return i===null&&(i=o),s.w=u,s.h=P,s.lines=b,s.precision=t,u||(u=1),P||(P=1),(g||m)&&(u=Math.min(u,m-g)),(d||x)&&(P=Math.min(P,x-d)),s.width=u,s.innerWidth=_,s.height=P,s.fontSize=o,s.cutSx=g,s.cutSy=d,s.cutEx=m,s.cutEy=x,s.lineHeight=l,s.lineWidths=D,s.offsetY=i,s.paddingLeft=e,s.paddingRight=r,s.letterSpacing=p,s.textIndent=y,s}draw(s,t){const e=this.getPrecision(),r=(t==null?void 0:t.lines)||s.lines,o=(t==null?void 0:t.lineWidths)||s.lineWidths,i=t?t.lines.length*s.lineHeight:s.height;this._canvas.width=Math.min(Math.ceil(s.width+this._settings.textRenderIssueMargin),Vt),this._canvas.height=Math.min(Math.ceil(i),Vt),this.setFontProperties(),s.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(s.cutSx||s.cutSy)&&this._context.translate(-s.cutSx,-s.cutSy);let l,c;const h=[];for(let g=0,m=r.length;g<m;g++)l=g===0?s.textIndent:0,c=g*s.lineHeight+s.offsetY,this._settings.verticalAlign=="middle"?c+=(s.lineHeight-s.fontSize)/2:this._settings.verticalAlign=="bottom"&&(c+=s.lineHeight-s.fontSize),this._settings.textAlign==="right"?l+=s.innerWidth-o[g]:this._settings.textAlign==="center"&&(l+=(s.innerWidth-o[g])/2),l+=s.paddingLeft,h.push({text:r[g],x:l,y:c,w:o[g]});if(this._settings.highlight){const g=this._settings.highlightColor,m=this._settings.highlightHeight*e||s.fontSize*1.5,d=this._settings.highlightOffset*e,x=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*e:s.paddingLeft,p=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*e:s.paddingRight;this._context.fillStyle=Ft(g);for(let y=0;y<h.length;y++){const u=h[y];this._context.fillRect(u.x-x,u.y-s.offsetY+d,u.w+p+x,m)}}let f=null;this._settings.shadow&&(f=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=Ft(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*e,this._context.shadowOffsetY=this._settings.shadowOffsetY*e,this._context.shadowBlur=this._settings.shadowBlur*e),this._context.fillStyle=Ft(this._settings.textColor);for(let g=0,m=h.length;g<m;g++){const d=h[g];if(s.letterSpacing===0)this._context.fillText(d.text,d.x,d.y);else{const x=d.text.split("");let p=d.x;for(let y=0,u=x.length;y<u;y++)this._context.fillText(x[y],p,d.y),p+=this.measureText(x[y],s.letterSpacing)}}f&&(this._context.shadowColor=f[0],this._context.shadowOffsetX=f[1],this._context.shadowOffsetY=f[2],this._context.shadowBlur=f[3]),(s.cutSx||s.cutSy)&&this._context.translate(s.cutSx,s.cutSy),this.renderInfo=s}wrapWord(s,t,e){const r=this._context.measureText(e).width,o=s.length,i=this._context.measureText(s).width;if(i<=t)return s;let l=Math.floor(t*o/i),c=this._context.measureText(s.substring(0,l)).width+r;if(c>t)for(;l>0&&(c=this._context.measureText(s.substring(0,l)).width+r,c>t);)l-=1;else for(;l<o;)if(c=this._context.measureText(s.substring(0,l)).width+r,c<t)l+=1;else{l-=1;break}return s.substring(0,l)+(t>=r?e:"")}wrapText(s,t,e,r=0){const o=s.split(/\r?\n/g);let i=[];const l=[];for(let c=0;c<o.length;c++){const h=[];let f="",g=t-r;const m=o[c].split(" ");for(let d=0;d<m.length;d++){const x=this.measureText(m[d],e),p=x+this.measureText(" ",e);d===0||p>g?(d>0&&(h.push(f),f=""),f+=m[d],g=t-x-(d===0?r:0)):(g-=p,f+=" ".concat(m[d]))}h.push(f),f="",i=i.concat(h),c<o.length-1&&l.push(i.length)}return{l:i,n:l}}measureText(s,t=0){return t?s.split("").reduce((e,r)=>e+this._context.measureText(r).width+t,0):this._context.measureText(s).width}mergeDefaults(s){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxLinesSuffix:"..",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...s}}}const Qt=typeof self>"u"?globalThis:self;var te;const qt=((te=Qt.document)==null?void 0:te.fonts)||Qt.fonts;function Ye(a){const{fontFamily:s,fontStyle:t,fontWeight:e,fontStretch:r,fontSize:o}=a;return[t,e,r,"".concat(o,"px"),s].join(" ")}class Be extends le{constructor(t){super(t);n(this,"canvas");n(this,"context");typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let e=this.canvas.getContext("2d");e||(this.canvas=document.createElement("canvas"),e=this.canvas.getContext("2d")),z(e),this.context=e}getPropertySetters(){return{fontFamily:(t,e)=>{t.props.fontFamily=e,t.fontInfo=void 0,this.markForReload(t)},fontWeight:(t,e)=>{t.props.fontWeight=e,t.fontInfo=void 0,this.markForReload(t)},fontStyle:(t,e)=>{t.props.fontStyle=e,t.fontInfo=void 0,this.markForReload(t)},fontStretch:(t,e)=>{t.props.fontStretch=e,t.fontInfo=void 0,this.markForReload(t)},fontSize:(t,e)=>{t.props.fontSize=e,t.fontInfo=void 0,this.markForReload(t)},text:(t,e)=>{t.props.text=e,this.markForReload(t)},textAlign:(t,e)=>{t.props.textAlign=e,this.markForReload(t)},color:(t,e)=>{t.props.color=e,this.markForReload(t)},x:(t,e)=>{t.props.x=e},y:(t,e)=>{t.props.y=e},contain:(t,e)=>{t.props.contain=e,this.markForReload(t)},width:(t,e)=>{t.props.width=e,this.markForReload(t)},height:(t,e)=>{t.props.height=e,this.markForReload(t)},offsetY:(t,e)=>{t.props.offsetY=e,this.markForReload(t)},scrollY:(t,e)=>{t.props.scrollY=e},letterSpacing:(t,e)=>{t.props.letterSpacing=e,this.markForReload(t)}}}canRenderFont(t){return!0}isFontFaceSupported(t){return t instanceof Kt}addFontFace(t){z(t instanceof Kt),qt.add(t.fontFace)}createState(t){return{props:t,status:"initialState",emitter:new zt,canvasPages:void 0,lightning2TextRenderer:new Xe(this.canvas,this.context),renderWindow:void 0,renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,fontFaceLoadedHandler:void 0,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(t){if(t.status==="initialState"&&this.setStatus(t,"loading"),!t.fontInfo){const u=Ye(t.props);if(t.fontInfo={cssString:u,loaded:!1},!t.fontInfo.loaded){qt.load(u).then(this.onFontLoaded.bind(this,t,u)).catch(this.onFontLoadError.bind(this,t,u));return}}if(!t.fontInfo.loaded)return;if(!t.renderInfo){t.lightning2TextRenderer.settings={text:t.props.text,textAlign:t.props.textAlign,fontFace:t.props.fontFamily,fontSize:t.props.fontSize,fontStyle:[t.props.fontStretch,t.props.fontStyle,t.props.fontWeight].join(" "),textColor:V(t.props.color),offsetY:t.props.fontSize+t.props.offsetY,wordWrap:t.props.contain!=="none",wordWrapWidth:t.props.contain==="none"?void 0:t.props.width,letterSpacing:t.props.letterSpacing};const u=performance.now();t.renderInfo=t.lightning2TextRenderer.calculateRenderInfo(),console.log("Render info calculated in",performance.now()-u,"ms"),t.textH=t.renderInfo.lineHeight*t.renderInfo.lines.length,t.textW=t.renderInfo.width,t.renderWindow=void 0}const{x:e,y:r,width:o,height:i,scrollY:l,contain:c}=t.props;let{renderWindow:h,canvasPages:f}=t;const g={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight},m={x1:e,y1:r,x2:c!=="none"?e+o:1/0,y2:c==="both"?r+i:1/0},d=se(g,m),x=d.y2-d.y1,p=Math.ceil(x/t.renderInfo.lineHeight);if(h&&f){const u=e+h.x1,_=r-l+h.y1,C=e+h.x2,b=r-l+h.y2;if(u<=d.x1&&C>=d.x2&&_<=d.y1&&b>=d.y2)return;b<d.y2?(h.y1+=p*t.renderInfo.lineHeight,h.y2+=p*t.renderInfo.lineHeight,f.push(f.shift()),f[2].lineNumStart=f[1].lineNumStart+p,f[2].lineNumEnd=f[2].lineNumStart+p,f[2].valid=!1):_>d.y1&&(h.y1-=p*t.renderInfo.lineHeight,h.y2-=p*t.renderInfo.lineHeight,f.unshift(f.pop()),f[0].lineNumStart=f[1].lineNumStart-p,f[0].lineNumEnd=f[0].lineNumStart+p,f[0].valid=!1)}else{const u=t.renderInfo.lineHeight*p,C=Math.ceil(l/u)*p,b=C-p,k=C+p;f=[{texture:f==null?void 0:f[0].texture,lineNumStart:b,lineNumEnd:b+p,valid:!1},{texture:f==null?void 0:f[1].texture,lineNumStart:C,lineNumEnd:C+p,valid:!1},{texture:f==null?void 0:f[2].texture,lineNumStart:k,lineNumEnd:k+p,valid:!1}],t.canvasPages=f;const D=Math.ceil(l/u)*u;h={x1:0,y1:D-u,x2:o,y2:D+u*2}}t.renderWindow=h;const y=performance.now();for(const u of f)if(!u.valid){if(u.lineNumStart<0){u.texture=this.stage.txManager.loadTexture("ImageTexture",{src:""}),u.valid=!0;continue}t.lightning2TextRenderer.draw(t.renderInfo,{lines:t.renderInfo.lines.slice(u.lineNumStart,u.lineNumEnd),lineWidths:t.renderInfo.lineWidths.slice(u.lineNumStart,u.lineNumEnd)}),this.canvas.width===0||this.canvas.height===0||(u.texture=this.stage.txManager.loadTexture("ImageTexture",{src:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)},{preload:!0})),u.valid=!0}console.log("pageDrawTime",performance.now()-y,"ms"),this.setStatus(t,"loaded")}renderQuads(t,e){var b,k,D,P,v,I,S,O,T,R,A,$;const{stage:r}=this,{canvasPages:o,textW:i=0,textH:l=0,renderWindow:c}=t;if(!o||!c)return;const{x:h,y:f,scrollY:g,contain:m,width:d,height:x}=t.props,p={x:h,y:f,width:m!=="none"?d:i,height:m==="both"?x:l};re({x:0,y:0,width:r.options.appWidth,height:r.options.appHeight},p),z(o,"canvasPages is not defined"),z(c,"renderWindow is not defined");const u=(c.y2-c.y1)/3,{zIndex:_,alpha:C}=t.props;o[0].valid&&this.stage.renderer.addRenderable({alpha:C,clippingRect:e,colorBl:4294967295,colorBr:4294967295,colorTl:4294967295,colorTr:4294967295,width:((k=(b=o[0].texture)==null?void 0:b.dimensions)==null?void 0:k.width)||0,height:((P=(D=o[0].texture)==null?void 0:D.dimensions)==null?void 0:P.height)||0,texture:o[0].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:_,worldScale:1,scale:1,wpx:h,wpy:f-g+c.y1,ta:1,tb:0,tc:0,td:1}),o[1].valid&&this.stage.renderer.addRenderable({alpha:C,clippingRect:e,colorBl:4294967295,colorBr:4294967295,colorTl:4294967295,colorTr:4294967295,width:((I=(v=o[1].texture)==null?void 0:v.dimensions)==null?void 0:I.width)||0,height:((O=(S=o[1].texture)==null?void 0:S.dimensions)==null?void 0:O.height)||0,texture:o[1].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:_,worldScale:1,scale:1,wpx:h,wpy:f-g+c.y1+u,ta:1,tb:0,tc:0,td:1}),o[2].valid&&this.stage.renderer.addRenderable({alpha:C,clippingRect:e,colorBl:4294967295,colorBr:4294967295,colorTl:4294967295,colorTr:4294967295,width:((R=(T=o[2].texture)==null?void 0:T.dimensions)==null?void 0:R.width)||0,height:(($=(A=o[2].texture)==null?void 0:A.dimensions)==null?void 0:$.height)||0,texture:o[2].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:_,worldScale:1,scale:1,wpx:h,wpy:f-g+c.y1+u+u,ta:1,tb:0,tc:0,td:1})}markForReload(t){t.renderInfo=void 0,this.setStatus(t,"loading")}onFontLoaded(t,e){var r;e!==((r=t.fontInfo)==null?void 0:r.cssString)||!t.fontInfo||(t.fontInfo.loaded=!0,this.updateState(t))}onFontLoadError(t,e,r){var o;e!==((o=t.fontInfo)==null?void 0:o.cssString)||!t.fontInfo||(t.fontInfo.loaded=!0,console.error("CanvasTextRenderer: Error loading font '".concat(t.fontInfo.cssString,"'"),r),this.updateState(t))}}const We=2e6;class Je{constructor(s){n(this,"options");n(this,"animationManager");n(this,"txManager");n(this,"fontManager");n(this,"textRenderers");n(this,"shManager");n(this,"renderer");n(this,"scene");n(this,"deltaTime",0);n(this,"lastFrameTime",0);n(this,"currentFrameTime",0);this.options=s;const{canvas:t,clearColor:e,rootId:r,debug:o,appWidth:i,appHeight:l}=s;this.txManager=new ze,this.shManager=new Ee,this.animationManager=new Oe,o!=null&&o.monitorTextureCache&&setInterval(()=>{z(this.txManager);const h=this.txManager.getDebugInfo();console.log("Texture ID Cache Size: ",h.idCacheSize),console.log("Texture Key Cache Size: ",h.keyCacheSize)},1e3),this.renderer=new Se({stage:this,canvas:t,pixelRatio:s.devicePhysicalPixelRatio*s.deviceLogicalPixelRatio,clearColor:e!=null?e:4278190080,bufferMemory:We,txManager:this.txManager,shManager:this.shManager}),this.txManager.renderer=this.renderer,this.textRenderers={canvas:new Be(this),sdf:new je(this)},this.fontManager=new ae(this.textRenderers);const c=new oe(this,{id:r,x:0,y:0,width:i,height:l,alpha:1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scale:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null});this.scene=new Re(c),Me(this)}drawFrame(){var r,o;const{renderer:s,scene:t,animationManager:e}=this;t!=null&&t.root&&(this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=ke(),this.deltaTime=this.lastFrameTime?this.currentFrameTime-this.lastFrameTime:100/6,e.update(this.deltaTime),s==null||s.reset(),(r=t==null?void 0:t.root)!=null&&r.hasUpdates&&((o=t==null?void 0:t.root)==null||o.update(this.deltaTime)),this.addQuads(t.root),s==null||s.sortRenderables(),s==null||s.render())}addQuads(s,t=null){z(this.renderer);let e=s.clipping?{x:s.worldContext.px,y:s.worldContext.py,width:s.width,height:s.height}:null;t&&e?e=re(t,e):t&&(e=t),s.renderQuads(this.renderer,e),s.children.forEach(r=>{r.alpha!==0&&this.addQuads(r,e)})}resolveTextRenderer(s,t=null){let e=t,r=!1;if(e){const i=this.textRenderers[e];i?i.canRenderFont(s)||(console.warn("Cannot use override text renderer '".concat(e,"' for font"),s),e=null,r=!0):(console.warn("Text renderer override '".concat(e,"' not found.")),e=null,r=!0)}if(!e){for(const[i,l]of Object.entries(this.textRenderers))if(i!=="canvas"&&l.canRenderFont(s)){e=i;break}e||(e="canvas")}r&&console.warn("Falling back to text renderer ".concat(String(e)));const o=this.textRenderers[e];return z(o,"resolvedTextRenderer undefined"),o}get root(){var s;return((s=this.scene)==null?void 0:s.root)||null}}class ts extends oe{constructor(t,e){super(t,e);n(this,"textRenderer");n(this,"trState");n(this,"updateScheduled");n(this,"_textRendererOverride",null);n(this,"onTextLoaded",()=>{this.emit("textLoaded",{width:this.trState.textW,height:this.trState.textH})});n(this,"onTextFailed",(t,e)=>{this.emit("textFailed",e)});this.updateScheduled=!1,this._textRendererOverride=e.textRendererOverride;const{resolvedTextRenderer:r,textRendererState:o}=this.resolveTextRendererAndState({x:this.absX,y:this.absY,width:e.width,height:e.height,textAlign:e.textAlign,color:e.color,alpha:e.alpha,zIndex:e.zIndex,contain:e.contain,scrollable:e.scrollable,scrollY:e.scrollY,offsetY:e.offsetY,letterSpacing:e.letterSpacing,debug:e.debug,fontFamily:e.fontFamily,fontSize:e.fontSize,fontStretch:e.fontStretch,fontStyle:e.fontStyle,fontWeight:e.fontWeight,text:e.text},void 0);this.textRenderer=r,this.trState=o}get width(){return this.trState.props.width}set width(t){this.textRenderer.set.width(this.trState,t),this.updateText()}get height(){return this.trState.props.height}set height(t){this.textRenderer.set.height(this.trState,t),this.updateText()}get alpha(){return this.trState.props.alpha}set alpha(t){this.textRenderer.set.alpha(this.trState,t),this.updateText()}get color(){return this.trState.props.color}set color(t){this.textRenderer.set.color(this.trState,t),this.updateText()}get text(){return this.trState.props.text}set text(t){this.textRenderer.set.text(this.trState,t),this.updateText()}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(t){this._textRendererOverride=t;const{resolvedTextRenderer:e,textRendererState:r}=this.resolveTextRendererAndState(this.trState.props,this.trState);this.textRenderer=e,this.trState=r}get fontSize(){return this.trState.props.fontSize}set fontSize(t){this.textRenderer.set.fontSize(this.trState,t),this.updateText()}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(t){this.textRenderer.set.fontFamily(this.trState,t),this.updateText()}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(t){this.textRenderer.set.fontStretch(this.trState,t),this.updateText()}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(t){this.textRenderer.set.fontStyle(this.trState,t),this.updateText()}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(t){this.textRenderer.set.fontWeight(this.trState,t),this.updateText()}get textAlign(){return this.trState.props.textAlign}set textAlign(t){this.textRenderer.set.textAlign(this.trState,t),this.updateText()}get contain(){return this.trState.props.contain}set contain(t){this.textRenderer.set.contain(this.trState,t),this.updateText()}get scrollable(){return this.trState.props.scrollable}set scrollable(t){this.textRenderer.set.scrollable(this.trState,t),this.updateText()}get scrollY(){return this.trState.props.scrollY}set scrollY(t){this.textRenderer.set.scrollY(this.trState,t),this.updateText()}get offsetY(){return this.trState.props.offsetY}set offsetY(t){this.textRenderer.set.offsetY(this.trState,t),this.updateText()}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(t){this.textRenderer.set.letterSpacing(this.trState,t),this.updateText()}get debug(){return this.trState.props.debug}set debug(t){this.textRenderer.set.debug(this.trState,t),this.updateText()}update(t){super.update(t),this.textRenderer.set.x(this.trState,this.worldContext.px),this.textRenderer.set.y(this.trState,this.worldContext.py),this.trState.status==="loading"&&this.updateText()}updateText(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>{this.updateScheduled=!1,this.textRenderer.updateState(this.trState)}))}renderQuads(t,e){this.textRenderer.renderQuads(this.trState,e)}resolveTextRendererAndState(t,e){const r=this.stage.resolveTextRenderer(t,this._textRendererOverride),o=r.createState(t);return e&&["loading","loaded","failed"].forEach(l=>{e.emitter.off(l)}),o.emitter.on("loading",()=>{o.emitter.once("fontLoaded",()=>{this.updateText()}),o.emitter.once("loaded",()=>{o.emitter.off("fontLoaded")})}),o.emitter.on("loaded",this.onTextLoaded),o.emitter.on("failed",this.onTextFailed),this.updateText(),{resolvedTextRenderer:r,textRendererState:o}}}const He="modulepreload",Ue=function(a){return"/solid-demo-app/"+a},Zt={},Ne=function(s,t,e){if(!t||t.length===0)return s();const r=document.getElementsByTagName("link");return Promise.all(t.map(o=>{if(o=Ue(o),o in Zt)return;Zt[o]=!0;const i=o.endsWith(".css"),l=i?'[rel="stylesheet"]':"";if(!!e)for(let f=r.length-1;f>=0;f--){const g=r[f];if(g.href===o&&(!i||g.rel==="stylesheet"))return}else if(document.querySelector('link[href="'.concat(o,'"]').concat(l)))return;const h=document.createElement("link");if(h.rel=i?"stylesheet":He,i||(h.as="script",h.crossOrigin=""),h.href=o,document.head.appendChild(h),i)return new Promise((f,g)=>{h.addEventListener("load",f),h.addEventListener("error",()=>g(new Error("Unable to preload CSS for ".concat(o))))})})).then(()=>s()).catch(o=>{const i=new Event("vite:preloadError",{cancelable:!0});if(i.payload=o,window.dispatchEvent(i),!i.defaultPrevented)throw o})};function Ge(a){return a.prototype instanceof Ce}async function es(a,s){let t;try{console.log("Loading core extension",a),t=await Ne(()=>import(a),[])}catch(r){console.error("The core extension module at '".concat(a,"' could not be loaded.")),console.error(r);return}if(!t.default){console.error("The core extension module at '".concat(a,"' does not have a default export."));return}const e=t.default;if(Ge(e)){const r=new e;try{await r.run(s)}catch(o){console.error("The core extension at '".concat(a,"' threw an error.")),console.error(o)}}else console.error("The core extension at '".concat(a,"' does not extend CoreExtension."))}const H=self;function jt(a,s){if(!a)throw new Error(s||"Assertion failed")}class Bt{constructor(s,t){n(this,"threadx");n(this,"sharedObjectStruct");n(this,"mutations");n(this,"waitPromise",null);n(this,"mutationsQueued",!1);n(this,"_id");n(this,"_typeId");n(this,"initialized",!1);n(this,"destroying",!1);n(this,"curProps");n(this,"eventListeners",{});this.curProps=t,this.threadx=vt.instance,this.sharedObjectStruct=s,this._id=s.id,this._typeId=s.typeId;const e=this.constructor;if(!Object.prototype.hasOwnProperty.call(e,"staticInitialized")||!e.staticInitialized){e.staticInitialized=!0;const r=Object.getPrototypeOf(this);Object.keys(t).forEach(o=>{Object.defineProperty(r,o,{get:function(){return this.curProps[o]},set:function(i){this.curProps[o]=i,this.mutations[o]=!0,this.queueMutations()}})})}this.mutations={},this._executeMutations(),this.initialized=!0}static extractBuffer(s){if(s.destroying||!s.sharedObjectStruct)throw new Error("SharedObject.extractBuffer(): SharedObject is or was being destroyed.");return s.sharedObjectStruct.buffer}get typeId(){return this._typeId}get id(){return this._id}processDirtyProperties(){if(!this.sharedObjectStruct)throw new Error("SharedObject was destroyed");const{sharedObjectStruct:s,mutations:t,curProps:e}=this;s.constructor.propDefs.forEach((r,o)=>{if(s.isDirty(o)){const i=r.name;delete t[i];const l=e[i];e[i]=s[i],this.initialized&&this.onPropertyChange(i,s[i],l)}}),s.resetDirty()}onPropertyChange(s,t,e){}queueMutations(){this.mutationsQueued||(this.mutationsQueued=!0,queueMicrotask(()=>{this.mutationsQueued=!1,this.sharedObjectStruct&&this.mutationMicrotask().catch(console.error)}))}async mutationMicrotask(){if(!this.sharedObjectStruct)throw new Error("SharedObject was destroyed");await this.sharedObjectStruct.lockAsync(async()=>{this._executeMutations()}),this.destroying&&this.finishDestroy()}flush(){if(this.destroying||!this.sharedObjectStruct)throw new Error("SharedObject was destroyed");this.sharedObjectStruct.lock(()=>{this._executeMutations()})}onDestroy(){}destroy(){const s=this.sharedObjectStruct;this.destroying||!s||(this.emit("beforeDestroy",{},{localOnly:!0}),this.destroying=!0,this.onDestroy(),this.queueMutations())}finishDestroy(){const s=this.sharedObjectStruct;!this.destroying||!s||(this.threadx.forgetObjects([this],{silent:!0}).catch(console.error),this.sharedObjectStruct=null,s.notify(),this.emit("afterDestroy",{},{localOnly:!0}),this.eventListeners={})}get isDestroyed(){return this.sharedObjectStruct===null}_executeMutations(){if(!this.sharedObjectStruct)return;this.sharedObjectStruct.notifyValue!==this.threadx.workerId&&this.sharedObjectStruct.isDirty()&&this.processDirtyProperties();const{mutations:s}=this;this.mutations={};for(const r in s)if(Object.prototype.hasOwnProperty.call(s,r)){const o=this.curProps[r];this.sharedObjectStruct[r],this.sharedObjectStruct[r]=o}this.waitPromise&&(this.waitPromise=null);let t=this.sharedObjectStruct.notifyValue;this.sharedObjectStruct.isDirty()&&(this.sharedObjectStruct.notify(this.threadx.workerId),t=this.threadx.workerId);const e=this.sharedObjectStruct.waitAsync(t).then(async r=>{this.waitPromise===e&&this.sharedObjectStruct&&(jt(r==="ok"),this.waitPromise=null,await this.mutationMicrotask())});this.waitPromise=e}on(s,t){let e=this.eventListeners[s];e||(e=[]),e.push(t),this.eventListeners[s]=e}off(s,t){const e=this.eventListeners[s];if(!e)return;const r=e.indexOf(t);r>=0&&e.splice(r,1)}once(s,t){const e=(r,o)=>{this.off(s,e),t(r,o)};this.on(s,e)}emit(s,t,e={}){const r=this.eventListeners[s];e.localOnly||vt.instance.__sharedObjectEmit(this,s,t),r&&[...r].forEach(o=>{o(this,t)})}}n(Bt,"staticInitialized",!1);function ce(a){return a>=65&&a<=90||a>=48&&a<=57}function he(a){let s=0;if(a.length===0)throw new Error("genTypeId: Type ID string must be at least 1 character");if(a.length>4)throw new Error("genTypeId: Type ID string must be 4 characters or less");for(let t=0;t<a.length;t++){let e=a.charCodeAt(t);if(e!==e)e=0;else if(!ce(e))throw new Error("genTypeId: Invalid character '".concat(a[t],"' (char code: ").concat(e,") in type ID string. A-Z and 0-9 only."));s|=e<<t*8}return s}function Et(a){const s=[];for(let t=0;t<4;t++){const e=a&255;if(ce(e))s.push(String.fromCharCode(e));else if(e!==0||t===0)return"????";a>>>=8}return s.join("")}function at(a,s){return typeof s=="object"&&s!==null&&"threadXMessageType"in s&&s.threadXMessageType===a}function Ke(a){return typeof a.DedicatedWorkerGlobalScope=="function"}class vt{constructor(s){n(this,"workerId");n(this,"workerName");n(this,"sharedObjectFactory");n(this,"onSharedObjectCreated");n(this,"onBeforeObjectForgotten");n(this,"onUserMessage");n(this,"sharedObjects",new Map);n(this,"sharedObjectData",new WeakMap);n(this,"workers",new Map);n(this,"workerReadyPromises",new Map);n(this,"pendingAsyncMsgs",new Map);n(this,"nextAsyncMsgId",0);n(this,"nextUniqueId",0);n(this,"suppressSharedObjectEmit",!1);this.workerId=s.workerId,this.workerName=s.workerName,this.nextUniqueId=s.workerId*1e13+1,this.sharedObjectFactory=s.sharedObjectFactory,this.onSharedObjectCreated=s.onObjectShared,this.onBeforeObjectForgotten=s.onBeforeObjectForgotten,this.onUserMessage=s.onMessage;const t=H;Ke(t)&&(this.registerWorker("parent",t),this.sendMessage("parent",{threadXMessageType:"ready"}))}static init(s){if(H.THREADX)throw new Error("ThreadX.init(): ThreadX already initialized.");const t=new vt(s);return H.THREADX=t,t}static destroy(){if(!H.THREADX){console.warn("ThreadX.destroy(): ThreadX is not initialized.");return}delete H.THREADX}static get workerId(){if(!H.THREADX)throw new Error("ThreadX not initialized");return H.THREADX.workerId}static get workerName(){if(!H.THREADX)throw new Error("ThreadX not initialized");return H.THREADX.workerName}static get instance(){if(!H.THREADX)throw new Error("ThreadX not initialized");return H.THREADX}registerWorker(s,t){this.workers.set(s,t);let e,r;s==="parent"?(r=Promise.resolve(),e=()=>{}):r=new Promise(o=>{e=o}),this.workerReadyPromises.set(s,{promise:r,resolve:e}),this.listenForWorkerMessages(s,t)}closeWorker(s){if(!this.workers.has(s))throw new Error("Worker ".concat(s," not registered."));this.closeWorkerAsync(s).catch(console.error)}async closeWorkerAsync(s,t=5e3){var o;const e=this.workers.get(s);if(!e)throw new Error("Worker ".concat(s," not registered."));const r=await Promise.race([new Promise(i=>{setTimeout(()=>{i(!1)},t)}),this.sendMessageAsync(s,{threadXMessageType:"close"})]);return this.workers.delete(s),this.workerReadyPromises.delete(s),r?"graceful":(console.warn('threadX.closeWorkerAsync(): Worker "'.concat(s,'" did not respond to "close" message within ').concat(t,"ms. Forcing termination.")),(o=e.terminate)==null||o.call(e),"forced")}listenForWorkerMessages(s,t){t.addEventListener("message",e=>{const{data:r}=e,o=r.__asyncMsgId;this.onMessage(s,r).then(i=>{o!==void 0&&t.postMessage({threadXMessageType:"response",asyncMsgId:o,data:i})}).catch(i=>{o!==void 0&&t.postMessage({threadXMessageType:"response",asyncMsgId:o,error:!0,data:i})})})}async shareObjects(s,t){for(const e of t)this.sharedObjects.get(e.id)?console.warn("ThreadX.shareObject(): SharedObject ".concat(e.id," (TypeID: ").concat(Et(e.typeId),") is already shared.")):(this.sharedObjects.set(e.id,e),this.sharedObjectData.set(e,{workerName:s,shareConfirmed:!1,emitQueue:null}));await this.sendMessageAsync(s,{threadXMessageType:"shareObjects",buffers:t.map(e=>Bt.extractBuffer(e))});for(const e of t){const r=this.sharedObjectData.get(e);if(r){r.shareConfirmed=!0;const{emitQueue:o}=r;if(o){for(const i of o)this.__sharedObjectEmit(e,i[0],i[1]);r.emitQueue=null}}}}async forgetObjects(s,t={}){const e=new Map;for(const o of s)if(!this.sharedObjects.has(o.id))t.silent||console.warn("ThreadX.forgetObject(): SharedObject ".concat(o.id," (TypeID: ").concat(Et(o.typeId),") is not shared."));else{const i=this.sharedObjectData.get(o);jt(i);let l=e.get(i.workerName);l||(l=[],e.set(i.workerName,l)),l.push(o),this.sharedObjects.delete(o.id),this.sharedObjectData.delete(o)}const r=[];for(const[o,i]of e)r.push(this.sendMessageAsync(o,{threadXMessageType:"forgetObjects",objectIds:i.map(l=>l.id)}));await Promise.all(r)}sendMessage(s,t,e){if(!this.workers.get(s))throw new Error("ThreadX.sendMessage(): Worker '".concat(s,"' not registered."));this.sendMessageAsync(s,t,e,{skipResponseWait:!0}).catch(console.error)}async sendMessageAsync(s,t,e,r={}){const o=this.workers.get(s);if(!o)throw new Error("ThreadX.execMessage(): Worker '".concat(s,"' not registered."));if(await this.workerReadyPromises.get(s).promise,r.skipResponseWait){o.postMessage(t,e);return}const i=this.nextAsyncMsgId++,l=new Promise((c,h)=>{this.pendingAsyncMsgs.set(i,{resolve:c,reject:h})});return t.__asyncMsgId=i,o.postMessage(t,e),l}async onMessage(s,t){var e;if(at("shareObjects",t))t.buffers.forEach(r=>{var i,l;const o=(i=this.sharedObjectFactory)==null?void 0:i.call(this,r);if(!o)throw new Error("ThreadX.onMesasge(): Failed to create shared object.");this.sharedObjects.set(o.id,o),this.sharedObjectData.set(o,{workerName:s,shareConfirmed:!0,emitQueue:null}),(l=this.onSharedObjectCreated)==null||l.call(this,o)});else if(at("forgetObjects",t))t.objectIds.forEach(r=>{var i;const o=this.sharedObjects.get(r);o&&((i=this.onBeforeObjectForgotten)==null||i.call(this,o),this.sharedObjects.delete(r),o.destroy())});else if(at("sharedObjectEmit",t)){const r=this.sharedObjects.get(t.sharedObjectId);if(!r)return;this.suppressSharedObjectEmit=!0,r.emit(t.eventName,t.data),this.suppressSharedObjectEmit=!1}else if(at("response",t)){const r=this.pendingAsyncMsgs.get(t.asyncMsgId);if(!r)throw new Error("ThreadX.onMessage(): Received response for unknown request (ID: ".concat(t.asyncMsgId,")"));this.pendingAsyncMsgs.delete(t.asyncMsgId),t.error?r.reject(t.data):r.resolve(t.data)}else{if(at("close",t))return H.close(),!0;if(at("ready",t))return(e=this.workerReadyPromises.get(s))==null||e.resolve(),!0;if(this.onUserMessage)return await this.onUserMessage(t)}}getSharedObjectById(s){return this.sharedObjects.get(s)||null}generateUniqueId(){return this.nextUniqueId++}__sharedObjectEmit(s,t,e){if(this.suppressSharedObjectEmit)return;const r=this.sharedObjectData.get(s);if(!r)return;if(!r.shareConfirmed){r.emitQueue||(r.emitQueue=[]),r.emitQueue.push([t,e]);return}const o=this.workers.get(r.workerName);jt(o,"Worker not found"),o.postMessage({threadXMessageType:"sharedObjectEmit",sharedObjectId:s.id,eventName:t,data:e})}}const pt=0,lt=1,U=2,J=6,Jt=2,Ct=255;function It(a,s,t){return a===s}function Rt(a,s){return a===s}function w(a,s){return function(t,e,r){const o=t.constructor;(!Object.prototype.hasOwnProperty.call(o,"staticInitialized")||!o.staticInitialized)&&o.initStatic();let i=o.size,l=0,c=0;a==="string"?(i+=i%2,l=i/2,c=(Ct+1)*2):a==="int32"||a==="boolean"?(i+=i%4,l=i/4,c=4):a==="number"&&(i+=i%8,l=i/8,c=8);const h=o.propDefs,f=h.length,g={propNum:f,name:e,type:a,byteOffset:i,offset:l,byteSize:c};h.push(g),o.size=i+c,r.get=function(){let m;if(a==="string"){const d=this.uint16array[l];if(!d)return"";if(d>Ct)throw new Error("get SharedObject.".concat(e,": Text length is too long. Length: ").concat(d));m=String.fromCharCode(...this.uint16array.slice(l+1,l+1+d))}else a==="int32"?m=this.int32array[l]:a==="boolean"?m=!!this.int32array[l]:a==="number"&&(m=this.float64array[l]);return s!=null&&s.bufferToProp&&(m=s.bufferToProp(m)),m},r.set=function(m){if(s!=null&&s.propToBuffer&&(m=s.propToBuffer(m)),It("string",a)){if(!Rt(m,this[e])){this.setDirty(f);let d=m.length;d>Ct&&(console.error("set SharedObject.".concat(e,": Text length is too long. Truncating..."),d),d=Ct),this.uint16array[l]=d;const x=l+1,p=x+d;let y=0;for(let u=x;u<p;u++)this.uint16array[u]=m.charCodeAt(y++)}}else It("int32",a)?Rt(m,this[e])||(this.setDirty(f),this.int32array[l]=m):It("boolean",a)?Rt(m,this[e])||(this.setDirty(f),this.int32array[l]=m?1:0):It("number",a)&&(Rt(m,this[e])||(this.setDirty(f),this.float64array[l]=m))}}}const q=class q{constructor(s){n(this,"buffer");n(this,"lockId",Math.floor(Math.random()*4294967295));n(this,"uint16array");n(this,"int32array");n(this,"float64array");const t=this.constructor;(!Object.prototype.hasOwnProperty.call(t,"staticInitialized")||!t.staticInitialized)&&t.initStatic();const e=!s;s||(s=new SharedArrayBuffer(Math.ceil(t.size/8)*8)),this.buffer=s,this.uint16array=new Uint16Array(s),this.int32array=new Int32Array(s),this.float64array=new Float64Array(s);const r=t.typeId;if(e)this.int32array[pt]=r,this.float64array[Jt]=vt.instance.generateUniqueId();else if(this.int32array[pt]!==r)throw new Error("BufferStruct: TypeId mismatch. Expected '".concat(t.typeIdStr,"', got '").concat(Et(this.int32array[pt]),"'"))}static extractTypeId(s){return s.byteLength<q.size||s.byteLength%8!==0?0:new Int32Array(s)[pt]||0}static initStatic(){const s=Et(this.typeId);if(s==="????")throw new Error("BufferStruct.typeId must be set to a valid 32-bit integer");this.typeIdStr=s,this.propDefs=[...this.propDefs],this.staticInitialized=!0}setDirty(s){const t=Math.floor(s/32),e=s-t*32;this.int32array[J+t]=this.int32array[J+t]|1<<e}resetDirty(){this.int32array[lt]=0,this.int32array[J]=0,this.int32array[J+1]=0}isDirty(s){if(s!==void 0){const t=Math.floor(s/32),e=s-t*32;return!!(this.int32array[J+t]&1<<e)}return!!(this.int32array[J]||this.int32array[J+1])}get typeId(){return this.int32array[pt]}get id(){return this.float64array[Jt]}get notifyValue(){return Atomics.load(this.int32array,lt)}get isLocked(){return Atomics.load(this.int32array,U)!==0}lock(s){let t=Atomics.compareExchange(this.int32array,U,0,this.lockId);for(;t!==0;){try{Atomics.wait(this.int32array,U,t)}catch(r){if(!(r instanceof TypeError&&r.message==="Atomics.wait cannot be called in this context"))throw r}t=Atomics.compareExchange(this.int32array,U,0,this.lockId)}let e;try{e=s()}finally{Atomics.store(this.int32array,U,0),Atomics.notify(this.int32array,U)}return e}async lockAsync(s){let t=Atomics.compareExchange(this.int32array,U,0,this.lockId);for(;t!==0;)await Atomics.waitAsync(this.int32array,U,t).value,t=Atomics.compareExchange(this.int32array,U,0,this.lockId);let e;try{e=await s()}finally{Atomics.store(this.int32array,U,0),Atomics.notify(this.int32array,U)}return e}notify(s){return s!==void 0&&Atomics.store(this.int32array,lt,s),Atomics.notify(this.int32array,lt)}wait(s,t=1/0){return Atomics.wait(this.int32array,lt,s,t)}async waitAsync(s,t=1/0){return Atomics.waitAsync(this.int32array,lt,s,t).value}};n(q,"staticInitialized",!1),n(q,"typeId",0),n(q,"typeIdStr",""),n(q,"size",8*4),n(q,"propDefs",[]);let Xt=q;var E=globalThis&&globalThis.__decorate||function(a,s,t,e){var r=arguments.length,o=r<3?s:e===null?e=Object.getOwnPropertyDescriptor(s,t):e,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(a,s,t,e);else for(var l=a.length-1;l>=0;l--)(i=a[l])&&(o=(r<3?i(o):r>3?i(s,t,o):i(s,t))||o);return r>3&&o&&Object.defineProperty(s,t,o),o};class M extends Xt{get x(){return 0}set x(s){}get y(){return 0}set y(s){}get width(){return 0}set width(s){}get height(){return 0}set height(s){}get alpha(){return 1}set alpha(s){}get clipping(){return!1}set clipping(s){}get color(){return 0}set color(s){}get colorTop(){return 0}set colorTop(s){}get colorBottom(){return 0}set colorBottom(s){}get colorLeft(){return 0}set colorLeft(s){}get colorRight(){return 0}set colorRight(s){}get colorTl(){return 0}set colorTl(s){}get colorTr(){return 0}set colorTr(s){}get colorBl(){return 0}set colorBl(s){}get colorBr(){return 0}set colorBr(s){}get scale(){return 1}set scale(s){}get mount(){return 0}set mount(s){}get mountX(){return 0}set mountX(s){}get mountY(){return 0}set mountY(s){}get pivot(){return .5}set pivot(s){}get pivotX(){return .5}set pivotX(s){}get pivotY(){return .5}set pivotY(s){}get rotation(){return 0}set rotation(s){}get parentId(){return 0}set parentId(s){}get zIndex(){return 0}set zIndex(s){}get zIndexLocked(){return 0}set zIndexLocked(s){}}n(M,"typeId",he("NODE"));E([w("number")],M.prototype,"x",null);E([w("number")],M.prototype,"y",null);E([w("number")],M.prototype,"width",null);E([w("number")],M.prototype,"height",null);E([w("number")],M.prototype,"alpha",null);E([w("boolean")],M.prototype,"clipping",null);E([w("number")],M.prototype,"color",null);E([w("number")],M.prototype,"colorTop",null);E([w("number")],M.prototype,"colorBottom",null);E([w("number")],M.prototype,"colorLeft",null);E([w("number")],M.prototype,"colorRight",null);E([w("number")],M.prototype,"colorTl",null);E([w("number")],M.prototype,"colorTr",null);E([w("number")],M.prototype,"colorBl",null);E([w("number")],M.prototype,"colorBr",null);E([w("number")],M.prototype,"scale",null);E([w("number")],M.prototype,"mount",null);E([w("number")],M.prototype,"mountX",null);E([w("number")],M.prototype,"mountY",null);E([w("number")],M.prototype,"pivot",null);E([w("number")],M.prototype,"pivotX",null);E([w("number")],M.prototype,"pivotY",null);E([w("number")],M.prototype,"rotation",null);E([w("number")],M.prototype,"parentId",null);E([w("number")],M.prototype,"zIndex",null);E([w("number")],M.prototype,"zIndexLocked",null);class ss extends Bt{constructor(s,t){super(s,{...t,x:s.x,y:s.y,width:s.width,height:s.height,alpha:s.alpha,clipping:s.clipping,color:s.color,colorTop:s.colorTop,colorBottom:s.colorBottom,colorLeft:s.colorLeft,colorRight:s.colorRight,colorTl:s.colorTl,colorTr:s.colorTr,colorBl:s.colorBl,colorBr:s.colorBr,parentId:s.parentId,zIndex:s.zIndex,zIndexLocked:s.zIndexLocked,scale:s.scale,mount:s.mount,mountX:s.mountX,mountY:s.mountY,pivot:s.pivot,pivotX:s.pivotX,pivotY:s.pivotY,rotation:s.rotation})}}var B=globalThis&&globalThis.__decorate||function(a,s,t,e){var r=arguments.length,o=r<3?s:e===null?e=Object.getOwnPropertyDescriptor(s,t):e,i;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")o=Reflect.decorate(a,s,t,e);else for(var l=a.length-1;l>=0;l--)(i=a[l])&&(o=(r<3?i(o):r>3?i(s,t,o):i(s,t))||o);return r>3&&o&&Object.defineProperty(s,t,o),o};class Y extends M{get text(){return""}set text(s){}get textRendererOverride(){return null}set textRendererOverride(s){}get fontSize(){return 0}set fontSize(s){}get fontFamily(){return""}set fontFamily(s){}get fontStretch(){return"normal"}set fontStretch(s){}get fontStyle(){return"normal"}set fontStyle(s){}get fontWeight(){return"normal"}set fontWeight(s){}get textAlign(){return"left"}set textAlign(s){}get contain(){return"none"}set contain(s){}get scrollable(){return!1}set scrollable(s){}get scrollY(){return 0}set scrollY(s){}get offsetY(){return 0}set offsetY(s){}get letterSpacing(){return 0}set letterSpacing(s){}}n(Y,"typeId",he("TEXT"));B([w("string")],Y.prototype,"text",null);B([w("string",{propToBuffer(a){return a!=null?a:"$$null"},bufferToProp(a){return a==="$$null"?null:a}})],Y.prototype,"textRendererOverride",null);B([w("number")],Y.prototype,"fontSize",null);B([w("string")],Y.prototype,"fontFamily",null);B([w("string")],Y.prototype,"fontStretch",null);B([w("string")],Y.prototype,"fontStyle",null);B([w("string")],Y.prototype,"fontWeight",null);B([w("string")],Y.prototype,"textAlign",null);B([w("string")],Y.prototype,"contain",null);B([w("boolean")],Y.prototype,"scrollable",null);B([w("number")],Y.prototype,"scrollY",null);B([w("number")],Y.prototype,"offsetY",null);B([w("number")],Y.prototype,"letterSpacing",null);export{Xt as B,oe as C,M as N,Je as S,vt as T,qe as a,Ze as b,ts as c,ss as d,Y as e,es as l};
//# sourceMappingURL=TextNodeStruct-a05ccdc5.js.map
