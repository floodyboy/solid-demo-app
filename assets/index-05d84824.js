var Fr=Object.defineProperty;var Ir=(r,n,t)=>n in r?Fr(r,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[n]=t;var h=(r,n,t)=>(Ir(r,typeof n!="symbol"?n+"":n,t),t);import{a as k,E as ue,g as Er,m as Cn,b as he,c as bt,T as Un,d as kr,e as zr,i as Mr,S as Rn,f as Gn,B as Pr,h as Lr,j as Nr,k as Xe,W as Fn,l as Kn,n as Ar,o as $r,C as Br}from"./CoreExtension-c81fcba3.js";function Ys(){import.meta.url,import("_").catch(()=>1);async function*r(){}}(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))e(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const s of i.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&e(s)}).observe(document,{childList:!0,subtree:!0});function t(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function e(o){if(o.ep)return;o.ep=!0;const i=t(o);fetch(o.href,i)}})();const Vn=(r,n)=>r===n,Ee=Symbol("solid-proxy"),Yr=Symbol("solid-track"),ke={equals:Vn};let qn=er;const mt=1,ze=2,Qn={owned:null,cleanups:null,context:null,owner:null},je={};var A=null;let He=null,B=null,tt=null,vt=null,Ye=0;function Jt(r,n){const t=B,e=A,o=r.length===0,i=n===void 0?e:n,s=o?Qn:{owned:null,cleanups:null,context:i?i.context:null,owner:i},l=o?r:()=>r(()=>st(()=>De(s)));A=s,B=null;try{return wt(l,!0)}finally{B=t,A=e}}function O(r,n){n=n?Object.assign({},ke,n):ke;const t={value:r,observers:null,observerSlots:null,comparator:n.equals||void 0},e=o=>(typeof o=="function"&&(o=o(t.value)),tr(t,o));return[Zn.bind(t),e]}function Qe(r,n,t){const e=fe(r,n,!0,mt);Kt(e)}function yt(r,n,t){const e=fe(r,n,!1,mt);Kt(e)}function _t(r,n,t){qn=Kr;const e=fe(r,n,!1,mt);(!t||!t.render)&&(e.user=!0),vt?vt.push(e):Kt(e)}function J(r,n,t){t=t?Object.assign({},ke,t):ke;const e=fe(r,n,!0,0);return e.observers=null,e.observerSlots=null,e.comparator=t.equals||void 0,Kt(e),Zn.bind(e)}function Dr(r){return r&&typeof r=="object"&&"then"in r}function jt(r,n,t){let e,o,i;arguments.length===2&&typeof n=="object"||arguments.length===1?(e=!0,o=r,i=n||{}):(e=r,o=n,i=t||{});let s=null,l=je,c=!1,d="initialValue"in i,u=typeof e=="function"&&J(e);const x=new Set,[g,_]=(i.storage||O)(i.initialValue),[T,S]=O(void 0),[b,y]=O(void 0,{equals:!1}),[p,m]=O(d?"ready":"unresolved");function f(w,v,R,E){return s===w&&(s=null,E!==void 0&&(d=!0),(w===l||v===l)&&i.onHydrated&&queueMicrotask(()=>i.onHydrated(E,{value:v})),l=je,C(v,R)),v}function C(w,v){wt(()=>{v===void 0&&_(()=>w),m(v!==void 0?"errored":d?"ready":"unresolved"),S(v);for(const R of x.keys())R.decrement();x.clear()},!1)}function F(){const w=Hr,v=g(),R=T();if(R!==void 0&&!s)throw R;return B&&!B.user&&w&&Qe(()=>{b(),s&&(w.resolved||x.has(w)||(w.increment(),x.add(w)))}),v}function I(w=!0){if(w!==!1&&c)return;c=!1;const v=u?u():e;if(v==null||v===!1){f(s,st(g));return}const R=l!==je?l:st(()=>o(v,{value:g(),refetching:w}));return Dr(R)?(s=R,"value"in R?(R.status==="success"?f(s,R.value,void 0,v):f(s,void 0,void 0,v),R):(c=!0,queueMicrotask(()=>c=!1),wt(()=>{m(d?"refreshing":"pending"),y()},!1),R.then(E=>f(R,E,void 0,v),E=>f(R,void 0,rr(E),v)))):(f(s,R,void 0,v),R)}return Object.defineProperties(F,{state:{get:()=>p()},error:{get:()=>T()},loading:{get(){const w=p();return w==="pending"||w==="refreshing"}},latest:{get(){if(!d)return F();const w=T();if(w&&!s)throw w;return g()}}}),u?Qe(()=>I(!1)):I(!1),[F,{refetch:I,mutate:_}]}function Or(r,n=Vn,t){const e=new Map,o=fe(i=>{const s=r();for(const[l,c]of e.entries())if(n(l,s)!==n(l,i))for(const d of c.values())d.state=mt,d.pure?tt.push(d):vt.push(d);return s},void 0,!0,mt);return Kt(o),i=>{const s=B;if(s){let l;(l=e.get(i))?l.add(s):e.set(i,l=new Set([s])),Ht(()=>{l.delete(s),!l.size&&e.delete(i)})}return n(i,o.value)}}function Wr(r){return wt(r,!1)}function st(r){if(B===null)return r();const n=B;B=null;try{return r()}finally{B=n}}function kt(r,n,t){const e=Array.isArray(r);let o,i=t&&t.defer;return s=>{let l;if(e){l=Array(r.length);for(let d=0;d<r.length;d++)l[d]=r[d]()}else l=r();if(i){i=!1;return}const c=st(()=>n(l,o,s));return o=l,c}}function de(r){_t(()=>st(r))}function Ht(r){return A===null||(A.cleanups===null?A.cleanups=[r]:A.cleanups.push(r)),r}function un(){return A}function Xr(r,n){const t=A,e=B;A=r,B=null;try{return wt(n,!0)}catch(o){fn(o)}finally{A=t,B=e}}function jr(r){const n=B,t=A;return Promise.resolve().then(()=>{B=n,A=t;let e;return wt(r,!1),B=A=null,e?e.done:void 0})}function Jn(r,n){const t=Symbol("context");return{id:t,Provider:Vr(t),defaultValue:r}}function hn(r){return A&&A.context&&A.context[r.id]!==void 0?A.context[r.id]:r.defaultValue}function dn(r){const n=J(r),t=J(()=>Je(n()));return t.toArray=()=>{const e=t();return Array.isArray(e)?e:e!=null?[e]:[]},t}let Hr;function Zn(){if(this.sources&&this.state)if(this.state===mt)Kt(this);else{const r=tt;tt=null,wt(()=>Pe(this),!1),tt=r}if(B){const r=this.observers?this.observers.length:0;B.sources?(B.sources.push(this),B.sourceSlots.push(r)):(B.sources=[this],B.sourceSlots=[r]),this.observers?(this.observers.push(B),this.observerSlots.push(B.sources.length-1)):(this.observers=[B],this.observerSlots=[B.sources.length-1])}return this.value}function tr(r,n,t){let e=r.value;return(!r.comparator||!r.comparator(e,n))&&(r.value=n,r.observers&&r.observers.length&&wt(()=>{for(let o=0;o<r.observers.length;o+=1){const i=r.observers[o],s=He&&He.running;s&&He.disposed.has(i),(s?!i.tState:!i.state)&&(i.pure?tt.push(i):vt.push(i),i.observers&&nr(i)),s||(i.state=mt)}if(tt.length>1e6)throw tt=[],new Error},!1)),n}function Kt(r){if(!r.fn)return;De(r);const n=A,t=B,e=Ye;B=A=r,Ur(r,r.value,e),B=t,A=n}function Ur(r,n,t){let e;try{e=r.fn(n)}catch(o){return r.pure&&(r.state=mt,r.owned&&r.owned.forEach(De),r.owned=null),r.updatedAt=t+1,fn(o)}(!r.updatedAt||r.updatedAt<=t)&&(r.updatedAt!=null&&"observers"in r?tr(r,e):r.value=e,r.updatedAt=t)}function fe(r,n,t,e=mt,o){const i={fn:r,state:e,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:n,owner:A,context:A?A.context:null,pure:t};return A===null||A!==Qn&&(A.owned?A.owned.push(i):A.owned=[i]),i}function Me(r){if(r.state===0)return;if(r.state===ze)return Pe(r);if(r.suspense&&st(r.suspense.inFallback))return r.suspense.effects.push(r);const n=[r];for(;(r=r.owner)&&(!r.updatedAt||r.updatedAt<Ye);)r.state&&n.push(r);for(let t=n.length-1;t>=0;t--)if(r=n[t],r.state===mt)Kt(r);else if(r.state===ze){const e=tt;tt=null,wt(()=>Pe(r,n[0]),!1),tt=e}}function wt(r,n){if(tt)return r();let t=!1;n||(tt=[]),vt?t=!0:vt=[],Ye++;try{const e=r();return Gr(t),e}catch(e){t||(vt=null),tt=null,fn(e)}}function Gr(r){if(tt&&(er(tt),tt=null),r)return;const n=vt;vt=null,n.length&&wt(()=>qn(n),!1)}function er(r){for(let n=0;n<r.length;n++)Me(r[n])}function Kr(r){let n,t=0;for(n=0;n<r.length;n++){const e=r[n];e.user?r[t++]=e:Me(e)}for(n=0;n<t;n++)Me(r[n])}function Pe(r,n){r.state=0;for(let t=0;t<r.sources.length;t+=1){const e=r.sources[t];if(e.sources){const o=e.state;o===mt?e!==n&&(!e.updatedAt||e.updatedAt<Ye)&&Me(e):o===ze&&Pe(e,n)}}}function nr(r){for(let n=0;n<r.observers.length;n+=1){const t=r.observers[n];t.state||(t.state=ze,t.pure?tt.push(t):vt.push(t),t.observers&&nr(t))}}function De(r){let n;if(r.sources)for(;r.sources.length;){const t=r.sources.pop(),e=r.sourceSlots.pop(),o=t.observers;if(o&&o.length){const i=o.pop(),s=t.observerSlots.pop();e<o.length&&(i.sourceSlots[s]=e,o[e]=i,t.observerSlots[e]=s)}}if(r.owned){for(n=r.owned.length-1;n>=0;n--)De(r.owned[n]);r.owned=null}if(r.cleanups){for(n=r.cleanups.length-1;n>=0;n--)r.cleanups[n]();r.cleanups=null}r.state=0}function rr(r){return r instanceof Error?r:new Error(typeof r=="string"?r:"Unknown error",{cause:r})}function fn(r,n=A){throw rr(r)}function Je(r){if(typeof r=="function"&&!r.length)return Je(r());if(Array.isArray(r)){const n=[];for(let t=0;t<r.length;t++){const e=Je(r[t]);Array.isArray(e)?n.push.apply(n,e):n.push(e)}return n}return r}function Vr(r,n){return function(e){let o;return yt(()=>o=st(()=>(A.context={...A.context,[r]:e.value},dn(()=>e.children))),void 0),o}}const qr=Symbol("fallback");function In(r){for(let n=0;n<r.length;n++)r[n]()}function Qr(r,n,t={}){let e=[],o=[],i=[],s=0,l=n.length>1?[]:null;return Ht(()=>In(i)),()=>{let c=r()||[],d,u;return c[Yr],st(()=>{let g=c.length,_,T,S,b,y,p,m,f,C;if(g===0)s!==0&&(In(i),i=[],e=[],o=[],s=0,l&&(l=[])),t.fallback&&(e=[qr],o[0]=Jt(F=>(i[0]=F,t.fallback())),s=1);else if(s===0){for(o=new Array(g),u=0;u<g;u++)e[u]=c[u],o[u]=Jt(x);s=g}else{for(S=new Array(g),b=new Array(g),l&&(y=new Array(g)),p=0,m=Math.min(s,g);p<m&&e[p]===c[p];p++);for(m=s-1,f=g-1;m>=p&&f>=p&&e[m]===c[f];m--,f--)S[f]=o[m],b[f]=i[m],l&&(y[f]=l[m]);for(_=new Map,T=new Array(f+1),u=f;u>=p;u--)C=c[u],d=_.get(C),T[u]=d===void 0?-1:d,_.set(C,u);for(d=p;d<=m;d++)C=e[d],u=_.get(C),u!==void 0&&u!==-1?(S[u]=o[d],b[u]=i[d],l&&(y[u]=l[d]),u=T[u],_.set(C,u)):i[d]();for(u=p;u<g;u++)u in S?(o[u]=S[u],i[u]=b[u],l&&(l[u]=y[u],l[u](u))):o[u]=Jt(x);o=o.slice(0,s=g),e=c.slice(0)}return o});function x(g){if(i[u]=g,l){const[_,T]=O(u);return l[u]=T,n(c[u],_)}return n(c[u])}}}function Ze(r,n){return st(()=>r(n||{}))}function _e(){return!0}const tn={get(r,n,t){return n===Ee?t:r.get(n)},has(r,n){return n===Ee?!0:r.has(n)},set:_e,deleteProperty:_e,getOwnPropertyDescriptor(r,n){return{configurable:!0,enumerable:!0,get(){return r.get(n)},set:_e,deleteProperty:_e}},ownKeys(r){return r.keys()}};function Ue(r){return(r=typeof r=="function"?r():r)?r:{}}function Jr(){for(let r=0,n=this.length;r<n;++r){const t=this[r]();if(t!==void 0)return t}}function gn(...r){let n=!1;for(let i=0;i<r.length;i++){const s=r[i];n=n||!!s&&Ee in s,r[i]=typeof s=="function"?(n=!0,J(s)):s}if(n)return new Proxy({get(i){for(let s=r.length-1;s>=0;s--){const l=Ue(r[s])[i];if(l!==void 0)return l}},has(i){for(let s=r.length-1;s>=0;s--)if(i in Ue(r[s]))return!0;return!1},keys(){const i=[];for(let s=0;s<r.length;s++)i.push(...Object.keys(Ue(r[s])));return[...new Set(i)]}},tn);const t={},e={},o=new Set;for(let i=r.length-1;i>=0;i--){const s=r[i];if(!s)continue;const l=Object.getOwnPropertyNames(s);for(let c=0,d=l.length;c<d;c++){const u=l[c];if(u==="__proto__"||u==="constructor")continue;const x=Object.getOwnPropertyDescriptor(s,u);if(!o.has(u))x.get?(o.add(u),Object.defineProperty(t,u,{enumerable:!0,configurable:!0,get:Jr.bind(e[u]=[x.get.bind(s)])})):(x.value!==void 0&&o.add(u),t[u]=x.value);else{const g=e[u];g?x.get?g.push(x.get.bind(s)):x.value!==void 0&&g.push(()=>x.value):t[u]===void 0&&(t[u]=x.value)}}}return t}function Zr(r,...n){if(Ee in r){const o=new Set(n.length>1?n.flat():n[0]),i=n.map(s=>new Proxy({get(l){return s.includes(l)?r[l]:void 0},has(l){return s.includes(l)&&l in r},keys(){return s.filter(l=>l in r)}},tn));return i.push(new Proxy({get(s){return o.has(s)?void 0:r[s]},has(s){return o.has(s)?!1:s in r},keys(){return Object.keys(r).filter(s=>!o.has(s))}},tn)),i}const t={},e=n.map(()=>({}));for(const o of Object.getOwnPropertyNames(r)){const i=Object.getOwnPropertyDescriptor(r,o),s=!i.get&&!i.set&&i.enumerable&&i.writable&&i.configurable;let l=!1,c=0;for(const d of n)d.includes(o)&&(l=!0,s?e[c][o]=i.value:Object.defineProperty(e[c],o,i)),++c;l||(s?t[o]=i.value:Object.defineProperty(t,o,i))}return[...e,t]}const to=r=>"Stale read from <".concat(r,">.");function pn(r){const n="fallback"in r&&{fallback:()=>r.fallback};return J(Qr(()=>r.each,r.children,n||void 0))}function Tt(r){const n=r.keyed,t=J(()=>r.when,void 0,{equals:(e,o)=>n?e===o:!e==!o});return J(()=>{const e=t();if(e){const o=r.children;return typeof o=="function"&&o.length>0?st(()=>o(n?e:()=>{if(!st(t))throw to("Show");return r.when})):o}return r.fallback},void 0,void 0)}const eo=void 0,[Le,or]=O(null),L=r=>(()=>{const n=zt("text");return Zt(n,r,!1),n})(),Y=r=>(()=>{const n=zt("node");return Zt(n,r,!1),n})();class ir{constructor(n){h(this,"releaseCallback");this.releaseCallback=n}}class no extends ir{constructor(t,e){var o,i;super(t);h(this,"textureMap",new Map);h(this,"zeroReferenceTextureSet",new Set);h(this,"options");this.options={textureCleanupIntervalMs:(o=e.textureCleanupIntervalMs)!=null?o:1e4,textureCleanupAgeThreadholdMs:(i=e.textureCleanupAgeThreadholdMs)!=null?i:6e4},setInterval(()=>{const s=Date.now(),l=this.options.textureCleanupAgeThreadholdMs;for(const c of this.zeroReferenceTextureSet)s-c.lastUpdate>l&&(this.releaseCallback(c.id),this.textureMap.delete(c.id),this.zeroReferenceTextureSet.delete(c))},this.options.textureCleanupIntervalMs)}registerTexture(t){var o;const e=(o=t.options)==null?void 0:o.id;if(k(e,"Texture must have an id to be registered"),!this.textureMap.has(e)){const i={id:e,nodeRefCount:0,lastUpdate:Date.now()};this.textureMap.set(e,i),this.zeroReferenceTextureSet.add(i)}}incrementTextureRefCount(t){var i;const e=(i=t.options)==null?void 0:i.id;k(e,"Texture must have an id to be registered");let o=this.textureMap.get(e);o||(this.registerTexture(t),o=this.textureMap.get(e)),k(o,"Texture must have been registered"),t.txType==="SubTexture"&&this.incrementTextureRefCount(t.props.texture),o.nodeRefCount++,o.lastUpdate=Date.now(),this.zeroReferenceTextureSet.has(o)&&this.zeroReferenceTextureSet.delete(o)}decrementTextureRefCount(t){var i;const e=(i=t.options)==null?void 0:i.id;k(e,"Texture must have an id to be registered");const o=this.textureMap.get(e);k(o,"Texture must have been registered"),o.nodeRefCount--,o.lastUpdate=Date.now(),o.nodeRefCount===0&&this.zeroReferenceTextureSet.add(o),t.txType==="SubTexture"&&this.decrementTextureRefCount(t.props.texture)}}class ro extends ir{constructor(t){super(t);h(this,"registry");this.registry=new FinalizationRegistry(t)}registerTexture(t){var e,o;k((e=t.options)==null?void 0:e.id,"Texture must have an ID to be registered"),this.registry.register(t,(o=t.options)==null?void 0:o.id)}incrementTextureRefCount(){}decrementTextureRefCount(){}}class oo{constructor(n,t,e){h(this,"root",null);h(this,"driver");h(this,"canvas");h(this,"settings");h(this,"nodes",new Map);h(this,"nextTextureId",1);h(this,"textureTracker");var S,b;const o={appWidth:n.appWidth||1920,appHeight:n.appHeight||1080,deviceLogicalPixelRatio:n.deviceLogicalPixelRatio||1,devicePhysicalPixelRatio:n.devicePhysicalPixelRatio||window.devicePixelRatio,clearColor:(S=n.clearColor)!=null?S:0,coreExtensionModule:n.coreExtensionModule||null,experimental_FinalizationRegistryTextureUsageTracker:(b=n.experimental_FinalizationRegistryTextureUsageTracker)!=null?b:!1,textureCleanupOptions:n.textureCleanupOptions||{}};this.settings=o;const{appWidth:i,appHeight:s,deviceLogicalPixelRatio:l,devicePhysicalPixelRatio:c}=o,d=y=>{this.driver.releaseTexture(y)},u=o.experimental_FinalizationRegistryTextureUsageTracker&&typeof FinalizationRegistry=="function";this.textureTracker=u?new ro(d):new no(d,this.settings.textureCleanupOptions);const x=i*l,g=s*l;this.driver=e;const _=document.createElement("canvas");this.canvas=_,_.width=x*c,_.height=g*c,_.style.width="".concat(x,"px"),_.style.height="".concat(g,"px");let T;if(typeof t=="string"?T=document.getElementById(t):T=t,!T)throw new Error("Could not find target element");e.onCreateNode=y=>{this.nodes.set(y.id,y)},e.onBeforeDestroyNode=y=>{this.nodes.delete(y.id)},T.appendChild(_)}async init(){await this.driver.init(this,this.settings,this.canvas),this.root=this.driver.getRootNode()}createNode(n){return this.driver.createNode(this.resolveNodeDefaults(n))}createTextNode(n){var t,e,o,i,s,l,c,d,u,x,g,_,T,S;return this.driver.createTextNode({...this.resolveNodeDefaults(n),text:(t=n.text)!=null?t:"",textRendererOverride:(e=n.textRendererOverride)!=null?e:null,fontSize:(o=n.fontSize)!=null?o:16,fontFamily:(i=n.fontFamily)!=null?i:"sans-serif",fontStyle:(s=n.fontStyle)!=null?s:"normal",fontWeight:(l=n.fontWeight)!=null?l:"normal",fontStretch:(c=n.fontStretch)!=null?c:"normal",textAlign:(d=n.textAlign)!=null?d:"left",contain:(u=n.contain)!=null?u:"none",scrollable:(x=n.scrollable)!=null?x:!1,scrollY:(g=n.scrollY)!=null?g:0,offsetY:(_=n.offsetY)!=null?_:0,letterSpacing:(T=n.letterSpacing)!=null?T:0,debug:(S=n.debug)!=null?S:{}})}resolveNodeDefaults(n){var l,c,d,u,x,g,_,T,S,b,y,p,m,f,C,F,I,w,v,R,E,z,M,P,$,W,X,ct,Ct,te,me,xe,Pt,xt,ht,Z,D,Rt,ot,Ft,ye,ve,Lt,Nt,At;const t=(l=n.color)!=null?l:4294967295,e=(u=(d=(c=n.colorTl)!=null?c:n.colorTop)!=null?d:n.colorLeft)!=null?u:t,o=(_=(g=(x=n.colorTr)!=null?x:n.colorTop)!=null?g:n.colorRight)!=null?_:t,i=(b=(S=(T=n.colorBl)!=null?T:n.colorBottom)!=null?S:n.colorLeft)!=null?b:t,s=(m=(p=(y=n.colorBr)!=null?y:n.colorBottom)!=null?p:n.colorRight)!=null?m:t;return{x:(f=n.x)!=null?f:0,y:(C=n.y)!=null?C:0,width:(F=n.width)!=null?F:0,height:(I=n.height)!=null?I:0,alpha:(w=n.alpha)!=null?w:1,clipping:(v=n.clipping)!=null?v:!1,color:t,colorTop:(R=n.colorTop)!=null?R:t,colorBottom:(E=n.colorBottom)!=null?E:t,colorLeft:(z=n.colorLeft)!=null?z:t,colorRight:(M=n.colorRight)!=null?M:t,colorBl:i,colorBr:s,colorTl:e,colorTr:o,zIndex:(P=n.zIndex)!=null?P:0,zIndexLocked:($=n.zIndexLocked)!=null?$:0,parent:(W=n.parent)!=null?W:null,texture:(X=n.texture)!=null?X:null,shader:(ct=n.shader)!=null?ct:null,src:(Ct=n.src)!=null?Ct:"",scale:(te=n.scale)!=null?te:null,scaleX:(xe=(me=n.scaleX)!=null?me:n.scale)!=null?xe:1,scaleY:(xt=(Pt=n.scaleY)!=null?Pt:n.scale)!=null?xt:1,mount:(ht=n.mount)!=null?ht:0,mountX:(D=(Z=n.mountX)!=null?Z:n.mount)!=null?D:0,mountY:(ot=(Rt=n.mountY)!=null?Rt:n.mount)!=null?ot:0,pivot:(Ft=n.pivot)!=null?Ft:.5,pivotX:(ve=(ye=n.pivotX)!=null?ye:n.pivot)!=null?ve:.5,pivotY:(Nt=(Lt=n.pivotY)!=null?Lt:n.pivot)!=null?Nt:.5,rotation:(At=n.rotation)!=null?At:0}}destroyNode(n){return this.driver.destroyNode(n)}createTexture(n,t,e){const o=this.nextTextureId++,i={descType:"texture",txType:n,props:t,options:{...e,id:o}};return this.textureTracker.registerTexture(i),i}createShader(n,t){return{descType:"shader",shType:n,props:t}}getNodeById(n){return this.nodes.get(n)||null}toggleFreeze(){throw new Error("Not implemented")}advanceFrame(){throw new Error("Not implemented")}rerender(){throw new Error("Not implemented")}}class io extends ue{constructor(t,e,o){super();h(this,"node");h(this,"props");h(this,"settings");h(this,"propStartValues",{});h(this,"restoreValues",{});h(this,"progress",0);h(this,"timingFunction");this.node=t,this.props=e,this.settings=o,this.propStartValues={},Object.keys(e).forEach(i=>{this.propStartValues[i]=t[i]}),this.timingFunction=i=>i,o.easing&&typeof o.easing=="string"&&(this.timingFunction=Er(o.easing))}reset(){this.progress=0,this.update(0)}restore(){this.reset(),Object.keys(this.props).forEach(t=>{this.node[t]=this.propStartValues[t]})}reverse(){this.progress=0,Object.keys(this.props).forEach(t=>{const e=this.props[t],o=this.propStartValues[t];this.props[t]=o,this.propStartValues[t]=e}),this.settings.loop||(this.settings.stopMethod=!1)}applyEasing(t,e,o){return(this.timingFunction(t)||t)*(o-e)+e}update(t){const{duration:e,loop:o,easing:i}=this.settings;if(!e){this.emit("finished",{});return}this.progress+=t/e,this.progress>1&&(this.progress=o?0:1,this.emit("finished",{})),Object.keys(this.props).forEach(s=>{const l=this.props[s],c=this.propStartValues[s],d=l;if(s.indexOf("color")!==-1){const u=i?this.timingFunction(this.progress)||this.progress:this.progress,x=Cn(c,d,u);this.node[s]=i?x:Cn(c,d,this.progress)}else this.node[s]=i?this.applyEasing(this.progress,c,d):c+(d-c)*this.progress})}}class so{constructor(n,t){h(this,"manager");h(this,"animation");h(this,"stoppedPromise",null);h(this,"stoppedResolve",null);h(this,"state");this.manager=n,this.animation=t,this.state="stopped"}start(){return this.makeStoppedPromise(),this.animation.once("finished",this.finished.bind(this)),this.manager.activeAnimations.has(this.animation)||this.manager.registerAnimation(this.animation),this.state="running",this}stop(){return this.manager.unregisterAnimation(this.animation),this.stoppedResolve!==null&&(this.stoppedResolve(),this.stoppedResolve=null),this.animation.reset(),this.state="stopped",this}pause(){return this.manager.unregisterAnimation(this.animation),this.state="paused",this}restore(){return this.stoppedResolve=null,this.animation.restore(),this}waitUntilStopped(){this.makeStoppedPromise();const n=this.stoppedPromise;return k(n),n}makeStoppedPromise(){this.stoppedResolve===null&&(this.stoppedPromise=new Promise(n=>{this.stoppedResolve=n}))}finished(){k(this.stoppedResolve);const{loop:n,stopMethod:t}=this.animation.settings;if(t==="reverse"){this.animation.reverse(),this.start();return}this.stoppedResolve(),this.stoppedResolve=null,!n&&this.manager.unregisterAnimation(this.animation)}}const U=0,G=3,et=6,j=1,K=4,it=7,dt=2,ft=5,gt=8;class ut{constructor(n){h(this,"data");n?(this.data=new Float32Array(9),this.data[U]=n[0],this.data[G]=n[3],this.data[et]=n[6],this.data[j]=n[1],this.data[K]=n[4],this.data[it]=n[7],this.data[dt]=n[2],this.data[ft]=n[5],this.data[gt]=n[8]):this.data=new Float32Array(9)}static get temp(){return ao}static multiply(n,t,e){const o=n.data[U]*t.data[U]+n.data[G]*t.data[j]+n.data[et]*t.data[dt],i=n.data[U]*t.data[G]+n.data[G]*t.data[K]+n.data[et]*t.data[ft],s=n.data[U]*t.data[et]+n.data[G]*t.data[it]+n.data[et]*t.data[gt],l=n.data[j]*t.data[U]+n.data[K]*t.data[j]+n.data[it]*t.data[dt],c=n.data[j]*t.data[G]+n.data[K]*t.data[K]+n.data[it]*t.data[ft],d=n.data[j]*t.data[et]+n.data[K]*t.data[it]+n.data[it]*t.data[gt],u=n.data[dt]*t.data[U]+n.data[ft]*t.data[j]+n.data[gt]*t.data[dt],x=n.data[dt]*t.data[G]+n.data[ft]*t.data[K]+n.data[gt]*t.data[ft],g=n.data[dt]*t.data[et]+n.data[ft]*t.data[it]+n.data[gt]*t.data[gt];return e||(e=new ut),e.data[U]=o,e.data[G]=i,e.data[et]=s,e.data[j]=l,e.data[K]=c,e.data[it]=d,e.data[dt]=u,e.data[ft]=x,e.data[gt]=g,e}static identity(n){return n||(n=new ut),n.data[U]=1,n.data[G]=0,n.data[et]=0,n.data[j]=0,n.data[K]=1,n.data[it]=0,n.data[dt]=0,n.data[ft]=0,n.data[gt]=1,n}static translate(n,t,e){return e||(e=new ut),e.data[U]=1,e.data[G]=0,e.data[et]=n,e.data[j]=0,e.data[K]=1,e.data[it]=t,e.data[dt]=0,e.data[ft]=0,e.data[gt]=1,e}static scale(n,t,e){return e||(e=new ut),e.data[U]=n,e.data[G]=0,e.data[et]=0,e.data[j]=0,e.data[K]=t,e.data[it]=0,e.data[dt]=0,e.data[ft]=0,e.data[gt]=1,e}static rotate(n,t){const e=Math.cos(n),o=Math.sin(n);return t||(t=new ut),t.data[U]=e,t.data[G]=-o,t.data[et]=0,t.data[j]=o,t.data[K]=e,t.data[it]=0,t.data[dt]=0,t.data[ft]=0,t.data[gt]=1,t}static copy(n,t,e){return t||(t=new ut),t.data[0]=n.data[0],t.data[1]=n.data[1],t.data[2]=n.data[2],t.data[3]=n.data[3],t.data[4]=n.data[4],t.data[5]=n.data[5],t.data[6]=n.data[6],t.data[7]=n.data[7],t.data[8]=n.data[8],t}translate(n,t){return this.data[et]=this.data[U]*n+this.data[G]*t+this.data[et],this.data[it]=this.data[j]*n+this.data[K]*t+this.data[it],this}scale(n,t){return this.data[U]=this.data[U]*n,this.data[G]=this.data[G]*t,this.data[j]=this.data[j]*n,this.data[K]=this.data[K]*t,this}rotate(n){if(n===0||!(n%Math.PI*2))return this;const t=Math.cos(n),e=Math.sin(n),o=this.data[U]*t+this.data[G]*e,i=this.data[G]*t-this.data[U]*e,s=this.data[j]*t+this.data[K]*e,l=this.data[K]*t-this.data[j]*e;return this.data[U]=o,this.data[G]=i,this.data[j]=s,this.data[K]=l,this}multiply(n){return ut.multiply(this,n,this)}get tx(){return this.data[et]}get ty(){return this.data[it]}get ta(){return this.data[U]}get tb(){return this.data[G]}get tc(){return this.data[j]}get td(){return this.data[K]}transformPoint(n,t){return[this.data[U]*n+this.data[G]*t+this.data[et],this.data[j]*n+this.data[K]*t+this.data[j]]}}const ao=new ut;class mn extends ue{constructor(t,e){super();h(this,"stage");h(this,"children",[]);h(this,"props");h(this,"recalculationType",6);h(this,"hasUpdates",!0);h(this,"globalTransform");h(this,"scaleRotateTransform");h(this,"localTransform");h(this,"isComplex",!1);h(this,"onTextureLoaded",(t,e)=>{this.emit("loaded",{type:"texture",dimensions:e})});h(this,"onTextureFailed",(t,e)=>{this.emit("failed",{type:"texture",error:e})});this.stage=t,this.props={...e,parent:null},this.parent=e.parent,this.updateScaleRotateTransform()}loadTexture(t,e,o=null){this.props.texture&&this.unloadTexture();const{txManager:i}=this.stage,s=i.loadTexture(t,e,o);this.props.texture=s,this.props.textureOptions=o,queueMicrotask(()=>{s.state==="loaded"?this.onTextureLoaded(s,s.dimensions):s.state==="failed"&&this.onTextureFailed(s,s.error),s.on("loaded",this.onTextureLoaded),s.on("failed",this.onTextureFailed)})}unloadTexture(){this.props.texture&&(this.props.texture.off("loaded",this.onTextureLoaded),this.props.texture.off("failed",this.onTextureFailed)),this.props.texture=null,this.props.textureOptions=null}loadShader(t,e){const o=this.stage.renderer.getShaderManager();k(o);const{shader:i,props:s}=o.loadShader(t,e);this.props.shader=i,this.props.shaderProps=s}setHasUpdates(){if(!this.props.alpha)return;this.hasUpdates=!0;let t=this==null?void 0:this.props.parent;for(;t;)t.hasUpdates=!0,t=t==null?void 0:t.props.parent}setRecalculationType(t){this.recalculationType|=t,this.setHasUpdates()}updateScaleRotateTransform(){this.setRecalculationType(4),this.scaleRotateTransform=ut.rotate(this.props.rotation,this.scaleRotateTransform).scale(this.props.scaleX,this.props.scaleY),this.updateLocalTransform()}updateLocalTransform(){k(this.scaleRotateTransform),this.setRecalculationType(2);const t=this.props.pivotX*this.props.width,e=this.props.pivotY*this.props.height,o=this.props.mountX*this.props.width,i=this.props.mountY*this.props.height;this.localTransform=ut.translate(t-o+this.props.x,e-i+this.props.y,this.localTransform).multiply(this.scaleRotateTransform).translate(-t,-e)}update(t){var o;k(this.localTransform);const e=(o=this.parent)==null?void 0:o.globalTransform;e?this.globalTransform=ut.copy(e,this.globalTransform).multiply(this.localTransform):this.globalTransform=ut.copy(this.localTransform,this.globalTransform),this.children.length&&this.children.forEach(i=>{i.update(t)}),this.hasUpdates=!1,this.recalculationType=0}renderQuads(t,e){const{width:o,height:i,colorTl:s,colorTr:l,colorBl:c,colorBr:d,texture:u,textureOptions:x,shader:g,shaderProps:_}=this.props,{zIndex:T,worldAlpha:S,globalTransform:b}=this;k(b),t.addRenderable({width:o,height:i,colorTl:s,colorTr:l,colorBl:c,colorBr:d,texture:u,textureOptions:x,zIndex:T,shader:g,shaderProps:_,alpha:S,clippingRect:e,tx:b.tx,ty:b.ty,ta:b.ta,tb:b.tb,tc:b.tc,td:b.td})}get id(){return this.props.id}get x(){return this.props.x}set x(t){this.props.x!==t&&(this.props.x=t,this.updateLocalTransform())}get absX(){var t,e,o;return this.props.x+(((t=this.props.parent)==null?void 0:t.absX)||((o=(e=this.props.parent)==null?void 0:e.globalTransform)==null?void 0:o.tx)||0)}get absY(){var t,e;return this.props.y+((e=(t=this.props.parent)==null?void 0:t.absY)!=null?e:0)}get y(){return this.props.y}set y(t){this.props.y!==t&&(this.props.y=t,this.updateLocalTransform())}get width(){return this.props.width}set width(t){this.props.width!==t&&(this.props.width=t,this.updateLocalTransform())}get height(){return this.props.height}set height(t){this.props.height!==t&&(this.props.height=t,this.updateLocalTransform())}get scale(){return this.scaleX}set scale(t){this.scaleX=t,this.scaleY=t}get scaleX(){return this.props.scaleX}set scaleX(t){this.props.scaleX!==t&&(this.props.scaleX=t,this.updateScaleRotateTransform())}get scaleY(){return this.props.scaleY}set scaleY(t){this.props.scaleY!==t&&(this.props.scaleY=t,this.updateScaleRotateTransform())}get worldScaleX(){var t,e;return this.props.scaleX*((e=(t=this.props.parent)==null?void 0:t.worldScaleX)!=null?e:1)||this.props.scaleX}get worldScaleY(){var t,e;return this.props.scaleY*((e=(t=this.props.parent)==null?void 0:t.worldScaleY)!=null?e:1)||this.props.scaleY}get mount(){return this.props.mount}set mount(t){this.props.mountX=t,this.props.mountY=t,this.props.mount=t,this.updateLocalTransform()}get mountX(){return this.props.mountX}set mountX(t){this.props.mountX=t,this.updateLocalTransform()}get mountY(){return this.props.mountY}set mountY(t){this.props.mountY=t,this.updateLocalTransform()}get pivot(){return this.props.pivot}set pivot(t){(this.props.pivotX!==t||this.props.pivotY!==t)&&(this.props.pivotX=t,this.props.pivotY=t,this.updateLocalTransform())}get pivotX(){return this.props.pivotX}set pivotX(t){this.props.pivotX=t,this.updateLocalTransform()}get pivotY(){return this.props.pivotY}set pivotY(t){this.props.pivotY=t,this.updateLocalTransform()}get rotation(){return this.props.rotation}set rotation(t){this.props.rotation!==t&&(this.props.rotation=t,this.updateScaleRotateTransform())}get alpha(){return this.props.alpha}set alpha(t){this.props.alpha=t}get worldAlpha(){const t=this.props,e=t.parent;return t.alpha*((e==null?void 0:e.worldAlpha)||1)}get clipping(){return this.props.clipping}set clipping(t){this.props.clipping=t}get color(){return this.props.color}set color(t){(this.props.colorTl!==t||this.props.colorTr!==t||this.props.colorBl!==t||this.props.colorBr!==t)&&(this.colorTl=t,this.colorTr=t,this.colorBl=t,this.colorBr=t),this.props.color=t}get colorTop(){return this.props.colorTop}set colorTop(t){(this.props.colorTl!==t||this.props.colorTr!==t)&&(this.colorTl=t,this.colorTr=t),this.props.colorTop=t}get colorBottom(){return this.props.colorBottom}set colorBottom(t){(this.props.colorBl!==t||this.props.colorBr!==t)&&(this.colorBl=t,this.colorBr=t),this.props.colorBottom=t}get colorLeft(){return this.props.colorLeft}set colorLeft(t){(this.props.colorTl!==t||this.props.colorBl!==t)&&(this.colorTl=t,this.colorBl=t),this.props.colorLeft=t}get colorRight(){return this.props.colorRight}set colorRight(t){(this.props.colorTr!==t||this.props.colorBr!==t)&&(this.colorTr=t,this.colorBr=t),this.props.colorRight=t}get colorTl(){return this.props.colorTl}set colorTl(t){this.props.colorTl=t}get colorTr(){return this.props.colorTr}set colorTr(t){this.props.colorTr=t}get colorBl(){return this.props.colorBl}set colorBl(t){this.props.colorBl=t}get colorBr(){return this.props.colorBr}set colorBr(t){this.props.colorBr=t}get zIndexLocked(){return this.props.zIndexLocked||0}set zIndexLocked(t){this.props.zIndexLocked=t}get zIndex(){var i,s;const t=this.props,e=t.zIndex||0,o=((i=t.parent)==null?void 0:i.zIndex)||0;return(s=t.parent)!=null&&s.zIndexLocked?e<o?e:o:e}set zIndex(t){this.props.zIndex=t}get parent(){return this.props.parent}set parent(t){const e=this.props.parent;if(e!==t){if(this.props.parent=t,e){const o=e.children.indexOf(this);k(o!==-1,"CoreNode.parent: Node not found in old parent's children!"),e.children.splice(o,1)}t&&t.children.push(this),this.updateScaleRotateTransform()}}}let lo=1;function sr(){return lo++}class en extends ue{constructor(t,e,o,i){var s;super();h(this,"rendererMain");h(this,"stage");h(this,"id");h(this,"coreNode");h(this,"_children",[]);h(this,"_src","");h(this,"_parent",null);h(this,"_texture",null);h(this,"_shader",null);h(this,"onTextureLoaded",(t,e)=>{this.emit("loaded",e)});h(this,"onTextureFailed",(t,e)=>{this.emit("failed",e)});this.rendererMain=e,this.stage=o,this.id=(s=i==null?void 0:i.id)!=null?s:sr(),this.coreNode=i||new mn(this.stage,{id:this.id,x:t.x,y:t.y,width:t.width,height:t.height,alpha:t.alpha,clipping:t.clipping,color:t.color,colorTop:t.colorTop,colorBottom:t.colorBottom,colorLeft:t.colorLeft,colorRight:t.colorRight,colorTl:t.colorTl,colorTr:t.colorTr,colorBl:t.colorBl,colorBr:t.colorBr,zIndex:t.zIndex,zIndexLocked:t.zIndexLocked,scaleX:t.scaleX,scaleY:t.scaleY,mountX:t.mountX,mountY:t.mountY,mount:t.mount,pivot:t.pivot,pivotX:t.pivotX,pivotY:t.pivotY,rotation:t.rotation,parent:null,shader:null,shaderProps:null,texture:null,textureOptions:null}),this.coreNode.on("loaded",this.onTextureLoaded),this.coreNode.on("failed",this.onTextureFailed),this.parent=t.parent,this.shader=t.shader,this.texture=t.texture,this.src=t.src}get x(){return this.coreNode.x}set x(t){this.coreNode.x=t}get y(){return this.coreNode.y}set y(t){this.coreNode.y=t}get width(){return this.coreNode.width}set width(t){this.coreNode.width=t}get height(){return this.coreNode.height}set height(t){this.coreNode.height=t}get alpha(){return this.coreNode.alpha}set alpha(t){this.coreNode.alpha=t}get clipping(){return this.coreNode.clipping}set clipping(t){this.coreNode.clipping=t}get color(){return this.coreNode.color}set color(t){this.coreNode.color=t}get colorTop(){return this.coreNode.colorTop}set colorTop(t){this.coreNode.colorTop=t}get colorBottom(){return this.coreNode.colorBottom}set colorBottom(t){this.coreNode.colorBottom=t}get colorLeft(){return this.coreNode.colorLeft}set colorLeft(t){this.coreNode.colorLeft=t}get colorRight(){return this.coreNode.colorRight}set colorRight(t){this.coreNode.colorRight=t}get colorTl(){return this.coreNode.colorTl}set colorTl(t){this.coreNode.colorTl=t}get colorTr(){return this.coreNode.colorTr}set colorTr(t){this.coreNode.colorTr=t}get colorBl(){return this.coreNode.colorBl}set colorBl(t){this.coreNode.colorBl=t}get colorBr(){return this.coreNode.colorBr}set colorBr(t){this.coreNode.colorBr=t}get scale(){return this.scaleX!==this.scaleY?null:this.coreNode.scaleX}set scale(t){t!==null&&(this.coreNode.scaleX=t,this.coreNode.scaleY=t)}get scaleX(){return this.coreNode.scaleX}set scaleX(t){this.coreNode.scaleX=t}get scaleY(){return this.coreNode.scaleY}set scaleY(t){this.coreNode.scaleY=t}get mount(){return this.coreNode.mount}set mount(t){this.coreNode.mount=t}get mountX(){return this.coreNode.mountX}set mountX(t){this.coreNode.mountX=t}get mountY(){return this.coreNode.mountY}set mountY(t){this.coreNode.mountY=t}get pivot(){return this.coreNode.pivot}set pivot(t){this.coreNode.pivot=t}get pivotX(){return this.coreNode.pivotX}set pivotX(t){this.coreNode.pivotX=t}get pivotY(){return this.coreNode.pivotY}set pivotY(t){this.coreNode.pivotY=t}get rotation(){return this.coreNode.rotation}set rotation(t){this.coreNode.rotation=t}get parent(){return this._parent}set parent(t){var o;const e=this._parent;if(this._parent=t,this.coreNode.parent=(o=t==null?void 0:t.coreNode)!=null?o:null,e){const i=e.children.indexOf(this);k(i!==-1,"MainOnlyNode.parent: Node not found in old parent's children!"),e.children.splice(i,1)}t&&t.children.push(this)}get children(){return this._children}get zIndex(){return this.coreNode.zIndex}set zIndex(t){this.coreNode.zIndex=t}get zIndexLocked(){return this.coreNode.zIndexLocked}set zIndexLocked(t){this.coreNode.zIndexLocked=t}get src(){return this._src}set src(t){if(this._src!==t){if(this._src=t,!t){this.texture=null;return}this.texture=this.rendererMain.createTexture("ImageTexture",{src:t})}}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture&&this.rendererMain.textureTracker.decrementTextureRefCount(this._texture),t&&this.rendererMain.textureTracker.incrementTextureRefCount(t),this._texture=t,t?this.coreNode.loadTexture(t.txType,t.props,t.options):this.coreNode.unloadTexture())}get shader(){return this._shader}set shader(t){this._shader!==t&&(this._shader=t,t&&this.coreNode.loadShader(t.shType,t.props))}destroy(){this.emit("beforeDestroy",{}),this.parent=null,this.texture=null,this.emit("afterDestroy",{}),this.removeAllListeners()}flush(){}animate(t,e){const o=new io(this.coreNode,t,e);return new so(this.stage.animationManager,o)}}class co{constructor(n){h(this,"root");this.root=n}getNodeByType(n){return[]}getNodeById(n){return null}update(n){this.root.update(n)}}const uo=r=>{const n=()=>{r.drawFrame(),requestAnimationFrame(n)};requestAnimationFrame(n)},ho=()=>performance?performance.now():Date.now();class ar extends he{constructor(n){super({renderer:n,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"}]})}bindTextures(n){const{gl:t}=this;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,n[0].ctxTexture)}}h(ar,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n          vec4 color = texture2D(u_texture, v_textureCoordinate);\n          gl_FragColor = vec4(v_color) * texture2D(u_texture, v_textureCoordinate);\n      }\n    "});class lr extends he{constructor(t){super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color","a_textureIndex"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_textures[0]",uniform:"uniform1iv"}]});h(this,"supportsIndexedTextures",!0)}bindTextures(t){const{renderer:e,gl:o}=this;if(t.length>e.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS)throw new Error("DefaultShaderBatched: Cannot bind more than ".concat(e.system.parameters.MAX_VERTEX_TEXTURE_IMAGE_UNITS," textures"));t.forEach((s,l)=>{o.activeTexture(o.TEXTURE0+l),o.bindTexture(o.TEXTURE_2D,s.ctxTexture)});const i=Array.from(Array(t.length).keys());this.setUniform("u_textures[0]",i)}}h(lr,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_textureCoordinate;\n      attribute vec2 a_position;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      void main(){\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n        v_textureIndex = a_textureIndex;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:t=>"\n      #define txUnits ".concat(t,"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform sampler2D u_image;\n      uniform sampler2D u_textures[txUnits];\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n      varying float v_textureIndex;\n\n      vec4 sampleFromTexture(sampler2D textures[").concat(t,"], int idx, vec2 uv) {\n        ").concat(Array.from(Array(t).keys()).map(e=>"\n          ".concat(e!==0?"else ":"","if (idx == ").concat(e,") {\n            return texture2D(textures[").concat(e,"], uv);\n          }\n        ")).join(""),"\n        return texture2D(textures[0], uv);\n      }\n\n      void main(){\n        gl_FragColor = vec4(v_color) * sampleFromTexture(u_textures, int(v_textureIndex), v_textureCoordinate);\n      }\n    ")});class nt{constructor(n){h(this,"priority",1);h(this,"name","");h(this,"ref");h(this,"target");h(this,"passParameters","");h(this,"declaredUniforms","");h(this,"uniformInfo",{});const{ref:t,target:e,props:o={}}=n;this.ref=t,this.target=e;const i={},s=[];let l="";const c=this.constructor.uniforms||{};for(const d in c){const u=c[d],x=u.type,g="".concat(t,"_").concat(d);let _="";u.size&&(_="[".concat(u.size(o),"]")),s.push(g),l+="uniform ".concat(x," ").concat(g).concat(_,";"),i[d]={name:g,uniform:c[d].method}}this.passParameters=s.join(","),this.declaredUniforms=l,this.uniformInfo=i}static getEffectKey(n){return""}static getMethodParameters(n,t){const e=[];for(const o in n){const i=n[o];let s="";i.size&&(s="[".concat(i.size(t),"]")),e.push("".concat(i.type," ").concat(o).concat(s))}return e.join(",")}static resolveDefaults(n){return{}}static makeEffectKey(n){return!1}}h(nt,"uniforms",{}),h(nt,"methods"),h(nt,"onShaderMask"),h(nt,"onColorize"),h(nt,"onEffectMask");class $t extends nt{constructor(){super(...arguments);h(this,"name","radius")}static getEffectKey(){return"radius"}static resolveDefaults(t){var e;return{radius:(e=t.radius)!=null?e:10}}}h($t,"z$__type__Props"),h($t,"uniforms",{radius:{value:0,method:"uniform4fv",type:"vec4",validator:t=>{let e=t;return Array.isArray(e)?e.length===2?e=[e[0],e[1],e[0],e[1]]:e.length===3?e=[e[0],e[1],e[2],e[0]]:e.length!==4&&(e=[e[0],e[0],e[0],e[0]]):typeof e=="number"&&(e=[e,e,e,e]),e}}}),h($t,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",boxDist:"\n      float function(vec2 p, vec2 size, float radius) {\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n    "}),h($t,"onShaderMask","\n  vec2 halfDimensions = u_dimensions * 0.5;\n  float r = radius[0] * step(v_textureCoordinate.x, 0.5) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[1] * step(0.5, v_textureCoordinate.x) * step(v_textureCoordinate.y, 0.5);\n  r = r + radius[2] * step(0.5, v_textureCoordinate.x) * step(0.5, v_textureCoordinate.y);\n  r = r + radius[3] * step(v_textureCoordinate.x, 0.5) * step(0.5, v_textureCoordinate.y);\n  return $boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions, r);\n  "),h($t,"onEffectMask","\n  return mix(vec4(0.0), maskColor, $fillMask(shaderMask));\n  ");class Vt extends nt{constructor(){super(...arguments);h(this,"name","border")}static getEffectKey(){return"border"}static resolveDefaults(t){var e,o;return{width:(e=t.width)!=null?e:10,color:(o=t.color)!=null?o:4294967295}}}h(Vt,"z$__type__Props"),h(Vt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>bt(t),method:"uniform4fv",type:"vec4"}}),h(Vt,"onEffectMask","\n  float mask = clamp(shaderMask + width, 0.0, 1.0) - clamp(shaderMask, 0.0, 1.0);\n  return mix(shaderColor, maskColor, mask);\n  "),h(Vt,"onColorize","\n    return color;\n  ");class Bt extends nt{constructor(){super(...arguments);h(this,"name","linearGradient")}static getEffectKey(t){return"linearGradient".concat(t.colors.length)}static resolveDefaults(t){var i,s;const e=(i=t.colors)!=null?i:[4278190080,4294967295];let o=t.stops;if(!o){o=[];const l=e.length-1;for(let c=0;c<e.length;c++)o.push(c*(1/l))}return{colors:e,stops:o,angle:(s=t.angle)!=null?s:0}}}h(Bt,"z$__type__Props"),h(Bt,"uniforms",{angle:{value:0,method:"uniform1f",type:"float"},colors:{value:4294967295,validator:t=>t.map(o=>bt(o)).reduce((o,i)=>o.concat(i),[]),size:t=>t.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],validator:(t,e)=>{var l;const o=(l=e.colors)!=null?l:[];let i=t;const s=t;if(i.length===0||i&&i.length!==o.length){for(let c=0;c<o.length;c++)i[c]?(s[c]=i[c],i[c-1]===void 0&&s[c-2]!==void 0&&(s[c-1]=s[c-2]+(i[c]-s[c-2])/2)):s[c]=c*(1/(o.length-1));i=s}return s},size:t=>t.colors.length,method:"uniform1fv",type:"float"}}),h(Bt,"methods",{fromLinear:"\n      vec4 function(vec4 linearRGB) {\n        vec4 higher = vec4(1.055)*pow(linearRGB, vec4(1.0/2.4)) - vec4(0.055);\n        vec4 lower = linearRGB * vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",toLinear:"\n      vec4 function(vec4 sRGB) {\n        vec4 higher = pow((sRGB + vec4(0.055))/vec4(1.055), vec4(2.4));\n        vec4 lower = sRGB/vec4(12.92);\n        return mix(higher, lower, 1.0);\n      }\n    ",calcPoint:"\n      vec2 function(float d, float angle) {\n        return d * vec2(cos(angle), sin(angle)) + (u_dimensions * 0.5);\n      }\n    "}),h(Bt,"ColorLoop",t=>{let e="";for(let o=2;o<t;o++)e+="colorOut = mix(colorOut, colors[".concat(o,"], clamp((dist - stops[").concat(o-1,"]) / (stops[").concat(o,"] - stops[").concat(o-1,"]), 0.0, 1.0));");return e}),h(Bt,"onColorize",t=>{const e=t.colors.length||1;return"\n      float a = angle - (PI / 180.0 * 90.0);\n      float lineDist = abs(u_dimensions.x * cos(a)) + abs(u_dimensions.y * sin(a));\n      vec2 f = $calcPoint(lineDist * 0.5, a);\n      vec2 t = $calcPoint(lineDist * 0.5, a + PI);\n      vec2 gradVec = t - f;\n      float dist = dot(v_textureCoordinate.xy * u_dimensions - f, gradVec) / dot(gradVec, gradVec);\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = $fromLinear(mix($toLinear(colors[0]), $toLinear(colors[1]), stopCalc));\n      for(int i = 1; i < ".concat(e,"-1; i++) {\n        stopCalc = (dist - stops[i]) / (stops[i + 1] - stops[i]);\n        colorOut = mix(colorOut, colors[i + 1], clamp(stopCalc, 0.0, 1.0));\n      }\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    ")});class xn extends nt{constructor(){super(...arguments);h(this,"name","grayscale")}static getEffectKey(){return"grayscale"}}h(xn,"onColorize","\n    vec3 color = pow(maskColor.rgb, vec3(2.0));\n    float gray = dot(color, vec3(0.2126, 0.7152, 0.0722));\n    float gammaGray = sqrt(gray);\n    return vec4(gammaGray, gammaGray, gammaGray, 1.0);\n  ");class Yt extends nt{constructor(){super(...arguments);h(this,"name","borderRight")}static getEffectKey(){return"borderRight"}static resolveDefaults(t){var e,o;return{width:(e=t.width)!=null?e:10,color:(o=t.color)!=null?o:4294967295}}}h(Yt,"z$__type__Props"),h(Yt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>bt(t),method:"uniform4fv",type:"vec4"}}),h(Yt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),h(Yt,"onEffectMask","\n  vec2 pos = vec2(u_dimensions.x - width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),h(Yt,"onColorize","\n    return color;\n  ");class Dt extends nt{constructor(){super(...arguments);h(this,"name","borderTop")}static getEffectKey(){return"borderTop"}static resolveDefaults(t){var e,o;return{width:(e=t.width)!=null?e:10,color:(o=t.color)!=null?o:4294967295}}}h(Dt,"z$__type__Props"),h(Dt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>bt(t),method:"uniform4fv",type:"vec4"}}),h(Dt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),h(Dt,"onEffectMask","\n  vec2 pos = vec2(0.0, width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),h(Dt,"onColorize","\n    return color;\n  ");class Ot extends nt{constructor(){super(...arguments);h(this,"name","borderBottom")}static getEffectKey(){return"borderBottom"}static resolveDefaults(t){var e,o;return{width:(e=t.width)!=null?e:10,color:(o=t.color)!=null?o:4294967295}}}h(Ot,"z$__type__Props"),h(Ot,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>bt(t),method:"uniform4fv",type:"vec4"}}),h(Ot,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),h(Ot,"onEffectMask","\n  vec2 pos = vec2(0.0, u_dimensions.y - width * 0.5);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(u_dimensions.x, width*0.5));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),h(Ot,"onColorize","\n    return color;\n  ");class Wt extends nt{constructor(){super(...arguments);h(this,"name","borderLeft")}static getEffectKey(){return"borderLeft"}static resolveDefaults(t){var e,o;return{width:(e=t.width)!=null?e:10,color:(o=t.color)!=null?o:4294967295}}}h(Wt,"z$__type__Props"),h(Wt,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},color:{value:4294967295,validator:t=>bt(t),method:"uniform4fv",type:"vec4"}}),h(Wt,"methods",{fillMask:"\n      float function(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n    ",rectDist:"\n      float function(vec2 p, vec2 size) {\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n      }\n    "}),h(Wt,"onEffectMask","\n  vec2 pos = vec2(width * 0.5, 0.0);\n  float mask = $rectDist(v_textureCoordinate.xy * u_dimensions - pos, vec2(width*0.5, u_dimensions.y));\n  return mix(shaderColor, maskColor, $fillMask(mask));\n  "),h(Wt,"onColorize","\n    return color;\n  ");class qt extends nt{constructor(){super(...arguments);h(this,"name","glitch")}static getEffectKey(t){return"glitch"}static resolveDefaults(t){var e,o,i,s,l;return{amplitude:(e=t.amplitude)!=null?e:.2,narrowness:(o=t.narrowness)!=null?o:4,blockiness:(i=t.blockiness)!=null?i:2,minimizer:(s=t.minimizer)!=null?s:8,time:(l=t.time)!=null?l:Date.now()}}}h(qt,"z$__type__Props"),h(qt,"uniforms",{amplitude:{value:0,method:"uniform1f",type:"float"},narrowness:{value:0,method:"uniform1f",type:"float"},blockiness:{value:0,method:"uniform1f",type:"float"},minimizer:{value:0,method:"uniform1f",type:"float"},time:{value:0,method:"uniform1f",validator:t=>(Date.now()-t)%1e3,type:"float"}}),h(qt,"methods",{rand:"\n      float function(vec2 p, float time) {\n        float t = floor(time * 20.) / 10.;\n        return fract(sin(dot(p, vec2(t * 12.9898, t * 78.233))) * 43758.5453);\n      }\n    ",noise:"\n      float function(vec2 uv, float blockiness, float time) {\n        vec2 lv = fract(uv);\n        vec2 id = floor(uv);\n\n        float n1 = rand(id, time);\n        float n2 = rand(id+vec2(1,0), time);\n        float n3 = rand(id+vec2(0,1), time);\n        float n4 = rand(id+vec2(1,1), time);\n        vec2 u = smoothstep(0.0, 1.0 + blockiness, lv);\n        return mix(mix(n1, n2, u.x), mix(n3, n4, u.x), u.y);\n      }\n    ",fbm:"\n      float function(vec2 uv, int count, float blockiness, float complexity, float time) {\n        float val = 0.0;\n        float amp = 0.5;\n        const int MAX_ITERATIONS = 10;\n\n        for(int i = 0; i < MAX_ITERATIONS; i++) {\n          if(i >= count) {break;}\n          val += amp * noise(uv, blockiness, time);\n          amp *= 0.5;\n          uv *= complexity;\n        }\n        return val;\n      }\n    "}),h(qt,"onColorize","\n    vec2 uv = v_textureCoordinate.xy;\n    float aspect = u_dimensions.x / u_dimensions.y;\n    vec2 a = vec2(uv.x * aspect , uv.y);\n    vec2 uv2 = vec2(a.x / u_dimensions.x, exp(a.y));\n\n    float shift = amplitude * pow($fbm(uv2, 4, blockiness, narrowness, time), minimizer);\n    float colR = texture2D(u_texture, vec2(uv.x + shift, uv.y)).r * (1. - shift);\n    float colG = texture2D(u_texture, vec2(uv.x - shift, uv.y)).g * (1. - shift);\n    float colB = texture2D(u_texture, vec2(uv.x - shift, uv.y)).b * (1. - shift);\n\n    vec3 f = vec3(colR, colG, colB);\n    return vec4(f, texture2D(u_texture, vec2(uv.x - shift, uv.y)).a);\n  ");class ne extends nt{constructor(){super(...arguments);h(this,"name","fadeOut")}static getEffectKey(){return"fadeOut"}static resolveDefaults(t){var e;return{fade:(e=t.fade)!=null?e:10}}}h(ne,"z$__type__Props"),h(ne,"uniforms",{fade:{value:0,method:"uniform4fv",type:"vec4",validator:t=>{let e=t;return Array.isArray(e)?e.length===2?e=[e[0],e[1],e[0],e[1]]:e.length===3?e=[e[0],e[1],e[2],e[0]]:e.length!==4&&(e=[e[0],e[0],e[0],e[0]]):typeof e=="number"&&(e=[e,e,e,e]),e}}}),h(ne,"onColorize","\n  vec2 point = v_textureCoordinate.xy * u_dimensions.xy;\n  vec2 pos1;\n  vec2 pos2;\n  vec2 d;\n  float c;\n  vec4 result = maskColor;\n\n\n  if(fade[0] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x, point.y + fade[0]);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[1] > 0.0) {\n    pos1 = vec2(point.x - u_dimensions.x - fade[1], v_textureCoordinate.y);\n    pos2 = vec2(point.x - u_dimensions.x, v_textureCoordinate.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[2] > 0.0) {\n    pos1 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y - fade[2]);\n    pos2 = vec2(v_textureCoordinate.x, point.y - u_dimensions.y);\n    d = pos1 - pos2;\n    c = dot(pos2, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  if(fade[3] > 0.0) {\n    pos1 = vec2(point.x, point.y);\n    pos2 = vec2(point.x + fade[3], point.y);\n    d = pos2 - pos1;\n    c = dot(pos1, d) / dot(d, d);\n    result = mix(vec4(0.0), result, smoothstep(0.0, 1.0, clamp(c, 0.0, 1.0)));\n  }\n\n  return result;\n  ");class re extends nt{constructor(){super(...arguments);h(this,"name","radialGradient")}static getEffectKey(t){return"radialGradient".concat(t.colors.length)}static resolveDefaults(t){var i,s,l,c,d;const e=(i=t.colors)!=null?i:[4278190080,4294967295];let o=t.stops;if(!o){o=[];const u=e.length-1;for(let x=0;x<e.length;x++)o.push(x*(1/u))}return{colors:e,stops:o,width:(s=t.width)!=null?s:0,height:(c=(l=t.height)!=null?l:t.width)!=null?c:0,pivot:(d=t.pivot)!=null?d:[.5,.5]}}}h(re,"z$__type__Props"),h(re,"uniforms",{width:{value:0,method:"uniform1f",type:"float"},height:{value:0,method:"uniform1f",type:"float"},pivot:{value:[.5,.5],method:"uniform2fv",type:"vec2"},colors:{value:4294967295,validator:t=>t.map(o=>bt(o)).reduce((o,i)=>o.concat(i),[]),size:t=>t.colors.length,method:"uniform4fv",type:"vec4"},stops:{value:[],validator:(t,e)=>{var l;const o=(l=e.colors)!=null?l:[];let i=t;const s=t;if(i.length===0||i&&i.length!==o.length){for(let c=0;c<o.length;c++)i[c]?(s[c]=i[c],i[c-1]===void 0&&s[c-2]!==void 0&&(s[c-1]=s[c-2]+(i[c]-s[c-2])/2)):s[c]=c*(1/(o.length-1));i=s}return s},size:t=>t.colors.length,method:"uniform1fv",type:"float"}}),h(re,"onColorize",t=>{const e=t.colors.length||1;return"\n      vec2 point = v_textureCoordinate.xy * u_dimensions;\n      vec2 projection = vec2(pivot.x * u_dimensions.x, pivot.y * u_dimensions.y);\n\n      float dist = length((point - projection) / vec2(width, height));\n\n      float stopCalc = (dist - stops[0]) / (stops[1] - stops[0]);\n      vec4 colorOut = mix(colors[0], colors[1], stopCalc);\n      for(int i = 1; i < ".concat(e,"-1; i++) {\n        stopCalc = (dist - stops[i]) / (stops[i + 1] - stops[i]);\n        colorOut = mix(colorOut, colors[i + 1], clamp(stopCalc, 0.0, 1.0));\n      }\n      return mix(maskColor, colorOut, clamp(colorOut.a, 0.0, 1.0));\n    ")});const Ge={radius:$t,border:Vt,borderBottom:Ot,borderLeft:Wt,borderRight:Yt,borderTop:Dt,fadeOut:ne,linearGradient:Bt,radialGradient:re,grayscale:xn,glitch:qt},St=class St extends he{constructor(t,e,o){const i=St.createShader(e,o);super({renderer:t,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2fv"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_alpha",uniform:"uniform1f"},...i.uniforms],shaderSources:{vertex:i.vertex,fragment:i.fragment}});h(this,"effects",[]);this.effects=i.effects}bindTextures(t){const{gl:e}=this;e.activeTexture(e.TEXTURE0),e.bindTexture(e.TEXTURE_2D,t[0].ctxTexture)}bindProps(t){var e;(e=t.effects)==null||e.forEach((o,i)=>{var u;const s=this.effects[i],l=Ge[s.name],c=(u=o.props)!=null?u:{},d=s.uniformInfo;Object.keys(c).forEach(x=>{const g=l.uniforms[x],_=d[x];let T=g.validator?g.validator(c[x],c):c[x];Array.isArray(T)&&(T=new Float32Array(T)),this.setUniform(_.name,T)})})}static createShader(t,e){const o={},i={};let s="";const l=[],c=[],d=t.effects.map(T=>{const S=e[T.type],b=S.getEffectKey(T.props||{});o[b]=o[b]?++o[b]:1;const y=o[b];y===1&&c.push({key:b,type:T.type,props:T.props});const p=new S({ref:"".concat(b).concat(y===1?"":y),target:b,props:T.props});return s+=p.declaredUniforms,l.push(...Object.values(p.uniformInfo)),p});let u="";c==null||c.forEach(T=>{var I;const S=e[T.type],b=S.resolveDefaults((I=T.props)!=null?I:{}),y=[];for(const w in S.methods){let v=w;const R=S.methods[w];i[w]&&i[w]!==R&&(v=St.resolveMethodDuplicate(w,R,i)),i[v]=R.replace("function",v),y.push({m:w,cm:v})}let p=S.onShaderMask instanceof Function?S.onShaderMask(b):S.onShaderMask,m=S.onColorize instanceof Function?S.onColorize(b):S.onColorize,f=S.onEffectMask instanceof Function?S.onEffectMask(b):S.onEffectMask;y.forEach(w=>{const{m:v,cm:R}=w,E=new RegExp("\\$".concat(v),"g");p&&(p=p.replace(E,R)),m&&(m=m.replace(E,R)),f&&(f=f.replace(E,R))});const C=S.getMethodParameters(S.uniforms,b),F=C.length>0?", ".concat(C):"";p&&(u+="\n        float fx_".concat(T.key,"_onShaderMask(float shaderMask ").concat(F,") {\n          ").concat(p,"\n        }\n        ")),m&&(u+="\n          vec4 fx_".concat(T.key,"_onColorize(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(F,") {\n            ").concat(m,"\n          }\n        ")),f&&(u+="\n          vec4 fx_".concat(T.key,"_onEffectMask(float shaderMask, vec4 maskColor, vec4 shaderColor").concat(F,") {\n            ").concat(f,"\n          }\n        "))});let x="";for(const T in i)x+=i[T];let g="mix(shaderColor, maskColor, clamp(-(lng_DefaultMask), 0.0, 1.0))",_="\n\n    ";for(let T=0;T<d.length;T++){const S=d[T],b=S.passParameters.length>0?", ".concat(S.passParameters):"",y=Ge[S.name];y.onShaderMask&&(_+="\n        shaderMask = fx_".concat(S.target,"_onShaderMask(shaderMask ").concat(b,");\n        ")),y.onColorize&&(_+="\n        maskColor = fx_".concat(S.target,"_onColorize(shaderMask, maskColor, shaderColor").concat(b,");\n        ")),y.onEffectMask&&(g="fx_".concat(S.target,"_onEffectMask(shaderMask, maskColor, shaderColor").concat(b,")"));const p=d[T+1];(p===void 0||Ge[p.name].onEffectMask)&&(_+="\n          shaderColor = ".concat(g,";\n        "))}return{effects:d,uniforms:l,fragment:St.fragment(s,x,u,_),vertex:St.vertex()}}static resolveMethodDuplicate(t,e,o,i=0){const s=t+(i>0?i:"");return o[s]&&o[s]!==e?this.resolveMethodDuplicate(t,e,o,++i):s}static resolveDefaults(t,e){var o;return{effects:((o=t.effects)!=null?o:[]).map(i=>({type:i.type,props:e[i.type].resolveDefaults(i.props||{})})),$dimensions:{width:0,height:0},$alpha:0}}static makeCacheKey(t,e){var i;let o="";return(i=t.effects)==null||i.forEach(s=>{const c=e[s.type].getEffectKey(s.props||{});o+=",".concat(c)}),"DynamicShader".concat(o)}};h(St,"z$__type__Props"),h(St,"vertex",()=>"\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    attribute vec2 a_textureCoordinate;\n    attribute vec2 a_position;\n    attribute vec4 a_color;\n    attribute float a_textureIndex;\n\n    uniform vec2 u_resolution;\n    uniform float u_pixelRatio;\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n    varying float v_textureIndex;\n\n    void main(){\n      vec2 normalized = a_position * u_pixelRatio / u_resolution;\n      vec2 zero_two = normalized * 2.0;\n      vec2 clip_space = zero_two - 1.0;\n\n      // pass to fragment\n      v_color = a_color;\n      v_textureCoordinate = a_textureCoordinate;\n      v_textureIndex = a_textureIndex;\n\n      // flip y\n      gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n    }\n  "),h(St,"fragment",(t,e,o,i)=>"\n    # ifdef GL_FRAGMENT_PRESICISON_HIGH\n    precision highp float;\n    # else\n    precision mediump float;\n    # endif\n\n    #define PI 3.14159265359\n\n    uniform vec2 u_resolution;\n    uniform vec2 u_dimensions;\n    uniform float u_alpha;\n    uniform float u_radius;\n    uniform sampler2D u_texture;\n    uniform float u_pixelRatio;\n\n    ".concat(t,"\n\n    varying vec4 v_color;\n    varying vec2 v_textureCoordinate;\n\n    ").concat(e,"\n\n    ").concat(o,"\n\n    void main() {\n      vec2 p = v_textureCoordinate.xy * u_dimensions - u_dimensions * 0.5;\n      vec2 d = abs(p) - (u_dimensions) * 0.5;\n      float lng_DefaultMask = min(max(d.x, d.y), 0.0) + length(max(d, 0.0));\n\n      vec4 shaderColor = vec4(0.0);\n      float shaderMask = lng_DefaultMask;\n\n      vec4 maskColor = texture2D(u_texture, v_textureCoordinate) * v_color;\n\n      shaderColor = mix(shaderColor, maskColor, clamp(-(lng_DefaultMask + 0.5), 0.0, 1.0));\n\n      ").concat(i,"\n\n      gl_FragColor = shaderColor * u_alpha;\n    }\n  "));let Qt=St;class nn extends he{constructor(n){super({renderer:n,attributes:["a_position","a_textureCoordinate","a_color"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_dimensions",uniform:"uniform2fv"},{name:"u_radius",uniform:"uniform1f"}]})}static resolveDefaults(n){return{radius:n.radius||10,$dimensions:{width:0,height:0}}}bindTextures(n){const{gl:t}=this;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,n[0].ctxTexture)}bindProps(n){this.setUniform("u_radius",n.radius)}canBatchShaderProps(n,t){return n.radius===t.radius&&n.$dimensions.width===t.$dimensions.width&&n.$dimensions.height===t.$dimensions.height}}h(nn,"z$__type__Props"),h(nn,"shaderSources",{vertex:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n      attribute vec4 a_color;\n      attribute float a_textureIndex;\n      attribute float a_depth;\n\n      uniform vec2 u_resolution;\n      uniform float u_pixelRatio;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      void main() {\n        vec2 normalized = a_position * u_pixelRatio / u_resolution;\n        vec2 zero_two = normalized * 2.0;\n        vec2 clip_space = zero_two - 1.0;\n\n        // pass to fragment\n        v_color = a_color;\n        v_textureCoordinate = a_textureCoordinate;\n\n        // flip y\n        gl_Position = vec4(clip_space * vec2(1.0, -1.0), 0, 1);\n      }\n    ",fragment:"\n      # ifdef GL_FRAGMENT_PRESICISON_HIGH\n      precision highp float;\n      # else\n      precision mediump float;\n      # endif\n\n      uniform vec2 u_resolution;\n      uniform vec2 u_dimensions;\n      uniform float u_radius;\n      uniform sampler2D u_texture;\n\n      varying vec4 v_color;\n      varying vec2 v_textureCoordinate;\n\n      float boxDist(vec2 p, vec2 size, float radius){\n        size -= vec2(radius);\n        vec2 d = abs(p) - size;\n        return min(max(d.x, d.y), 0.0) + length(max(d, 0.0)) - radius;\n      }\n\n      float fillMask(float dist) {\n        return clamp(-dist, 0.0, 1.0);\n      }\n\n      void main() {\n        vec4 color = texture2D(u_texture, v_textureCoordinate) * v_color;\n        vec2 halfDimensions = u_dimensions * 0.5;\n\n        float d = boxDist(v_textureCoordinate.xy * u_dimensions - halfDimensions, halfDimensions + 0.5, u_radius);\n        gl_FragColor = mix(vec4(0.0), color, fillMask(d));\n      }\n    "});const fo=new Float32Array([1,0,0,0,1,0,0,0,1]),Be=class Be extends he{constructor(n){super({renderer:n,attributes:["a_position","a_textureCoordinate"],uniforms:[{name:"u_resolution",uniform:"uniform2fv"},{name:"u_transform",uniform:"uniformMatrix3fv"},{name:"u_scrollY",uniform:"uniform1f"},{name:"u_pixelRatio",uniform:"uniform1f"},{name:"u_texture",uniform:"uniform2f"},{name:"u_color",uniform:"uniform4fv"},{name:"u_size",uniform:"uniform1f"},{name:"u_distanceRange",uniform:"uniform1f"},{name:"u_debug",uniform:"uniform1i"}]})}bindTextures(n){const{gl:t}=this;t.activeTexture(t.TEXTURE0),t.bindTexture(t.TEXTURE_2D,n[0].ctxTexture)}bindProps(n){const t=Be.resolveDefaults(n);for(const e in t)if(e==="transform")this.setUniform("u_transform",!1,t[e]);else if(e==="scrollY")this.setUniform("u_scrollY",t[e]);else if(e==="color"){const o=bt(t.color);this.setUniform("u_color",o)}else e==="size"?this.setUniform("u_size",t[e]):e==="distanceRange"?this.setUniform("u_distanceRange",t[e]):e==="debug"&&this.setUniform("u_debug",t[e]?1:0)}static resolveDefaults(n={}){var t,e,o,i,s,l;return{transform:(t=n.transform)!=null?t:fo,scrollY:(e=n.scrollY)!=null?e:0,color:(o=n.color)!=null?o:4294967295,size:(i=n.size)!=null?i:16,distanceRange:(s=n.distanceRange)!=null?s:1,debug:(l=n.debug)!=null?l:!1}}};h(Be,"shaderSources",{vertex:"\n      // an attribute is an input (in) to a vertex shader.\n      // It will receive data from a buffer\n      attribute vec2 a_position;\n      attribute vec2 a_textureCoordinate;\n\n      uniform vec2 u_resolution;\n      uniform mat3 u_transform;\n      uniform float u_scrollY;\n      uniform float u_pixelRatio;\n      uniform float u_size;\n\n      varying vec2 v_texcoord;\n\n      void main() {\n        vec2 scrolledPosition = a_position * u_size - vec2(0, u_scrollY);\n        vec2 transformedPosition = (u_transform * vec3(scrolledPosition, 1)).xy;\n        gl_Position = vec4((transformedPosition * u_pixelRatio / u_resolution * 2.0 - 1.0) * vec2(1, -1), 0, 1);\n        v_texcoord = a_textureCoordinate;\n      }\n    ",fragment:"\n      precision highp float;\n\n      uniform vec4 u_color;\n      uniform sampler2D u_texture;\n      uniform float u_distanceRange;\n      uniform float u_pixelRatio;\n      uniform int u_debug;\n\n      varying vec2 v_texcoord;\n\n      float median(float r, float g, float b) {\n          return max(min(r, g), min(max(r, g), b));\n      }\n\n      void main() {\n          vec3 sample = texture2D(u_texture, v_texcoord).rgb;\n          if (u_debug == 1) {\n            gl_FragColor = vec4(sample.r, sample.g, sample.b, 1.0);\n            return;\n          }\n          float scaledDistRange = u_distanceRange * u_pixelRatio;\n          float sigDist = scaledDistRange * (median(sample.r, sample.g, sample.b) - 0.5);\n          float opacity = clamp(sigDist + 0.5, 0.0, 1.0) * u_color.a;\n\n          // Build the final color.\n          // IMPORTANT: We must premultiply the color by the alpha value before returning it.\n          gl_FragColor = vec4(u_color.r * opacity, u_color.g * opacity, u_color.b * opacity, opacity);\n      }\n    "});let rn=Be;class go{constructor(){h(this,"shCache",new Map);h(this,"shConstructors",{});h(this,"attachedShader",null);h(this,"effectConstructors",{});h(this,"renderer");this.registerShaderType("DefaultShader",ar),this.registerShaderType("DefaultShaderBatched",lr),this.registerShaderType("RoundedRectangle",nn),this.registerShaderType("DynamicShader",Qt),this.registerShaderType("SdfShader",rn),this.registerEffectType("border",Vt),this.registerEffectType("borderBottom",Ot),this.registerEffectType("borderLeft",Wt),this.registerEffectType("borderRight",Yt),this.registerEffectType("borderTop",Dt),this.registerEffectType("fadeOut",ne),this.registerEffectType("linearGradient",Bt),this.registerEffectType("radialGradient",re),this.registerEffectType("grayscale",xn),this.registerEffectType("glitch",qt),this.registerEffectType("radius",$t)}registerShaderType(n,t){this.shConstructors[n]=t}registerEffectType(n,t){this.effectConstructors[n]=t}loadShader(n,t){if(!this.renderer)throw new Error("Renderer is not been defined");const e=this.shConstructors[n];if(!e)throw new Error('Shader type "'.concat(n,'" is not registered'));if(n==="DynamicShader")return this.loadDynamicShader(t);const o=e.resolveDefaults(t),i=e.makeCacheKey(o)||e.name;if(i&&this.shCache.has(i))return{shader:this.shCache.get(i),props:o};const s=new e(this.renderer,t);return i&&this.shCache.set(i,s),{shader:s,props:o}}loadDynamicShader(n){if(!this.renderer)throw new Error("Renderer is not been defined");const t=Qt.resolveDefaults(n,this.effectConstructors),e=Qt.makeCacheKey(t,this.effectConstructors);if(e&&this.shCache.has(e))return{shader:this.shCache.get(e),props:t};const o=new Qt(this.renderer,n,this.effectConstructors);return e&&this.shCache.set(e,o),{shader:o,props:t}}useShader(n){this.attachedShader!==n&&(this.attachedShader&&this.attachedShader.detach(),n.attach(),this.attachedShader=n)}}class po{constructor(){h(this,"activeAnimations",new Set)}registerAnimation(n){this.activeAnimations.add(n)}unregisterAnimation(n){this.activeAnimations.delete(n)}update(n){this.activeAnimations.forEach(t=>{t.update(n)})}}const se=class se extends Un{constructor(t,e){super(t);h(this,"props");this.props=se.resolveDefaults(e)}async getTextureData(){const{src:t,premultiplyAlpha:e}=this.props;if(!t)return{data:null};if(t instanceof ImageData)return{data:t,premultiplyAlpha:e};const i=await(await fetch(t)).blob();return{data:await createImageBitmap(i,{premultiplyAlpha:e?"premultiply":"none",colorSpaceConversion:"none",imageOrientation:"none"})}}static makeCacheKey(t){const e=se.resolveDefaults(t);return e.src instanceof ImageData?!1:"ImageTexture,".concat(e.src,",").concat(e.premultiplyAlpha)}static resolveDefaults(t){var e,o;return{src:(e=t.src)!=null?e:"",premultiplyAlpha:(o=t.premultiplyAlpha)!=null?o:!0}}};h(se,"z$__type__Props");let on=se;const ae=class ae extends Un{constructor(t,e){super(t);h(this,"props");this.props=ae.resolveDefaults(e)}async getTextureData(){const{width:t,height:e}=this.props,o=t*e*4,i=new Uint8ClampedArray(o);for(let s=0;s<o;s+=4){const l=Math.floor(Math.random()*256);i[s]=l,i[s+1]=l,i[s+2]=l,i[s+3]=255}return{data:new ImageData(i,t,e)}}static makeCacheKey(t){const e=ae.resolveDefaults(t);return"NoiseTexture,".concat(e.width,",").concat(e.height,",").concat(e.cacheId)}static resolveDefaults(t){var e,o,i;return{width:(e=t.width)!=null?e:128,height:(o=t.height)!=null?o:128,cacheId:(i=t.cacheId)!=null?i:0}}};h(ae,"z$__type__Props");let sn=ae;class mo{constructor(){h(this,"usedMemory",0);h(this,"txConstructors",{});h(this,"textureKeyCache",new Map);h(this,"textureIdCache",new Map);h(this,"ctxTextureCache",new WeakMap);h(this,"textureRefCountMap",new WeakMap);h(this,"renderer");this.registerTextureType("ImageTexture",on),this.registerTextureType("ColorTexture",kr),this.registerTextureType("NoiseTexture",sn),this.registerTextureType("SubTexture",zr)}registerTextureType(n,t){this.txConstructors[n]=t}loadTexture(n,t,e=null){var s;const o=this.txConstructors[n];if(!o)throw new Error('Texture type "'.concat(n,'" is not registered'));let i;if((e==null?void 0:e.id)!==void 0&&this.textureIdCache.has(e.id)&&(i=this.textureIdCache.get(e.id)),!i){const l=e==null?void 0:e.id,c=(s=e==null?void 0:e.cacheKey)!=null?s:o.makeCacheKey(t);c&&this.textureKeyCache.has(c)?i=this.textureKeyCache.get(c):i=new o(this,t),l&&this.addTextureIdToCache(l,c,i)}return e!=null&&e.preload&&this.getCtxTexture(i).load(),i}addTextureIdToCache(n,t,e){const{textureIdCache:o,textureRefCountMap:i}=this;o.set(n,e),i.has(e)?i.get(e).count++:(i.set(e,{cacheKey:t,count:1}),t&&this.textureKeyCache.set(t,e))}removeTextureIdFromCache(n){const{textureIdCache:t,textureRefCountMap:e}=this,o=t.get(n);if(o&&(t.delete(n),e.has(o))){const i=e.get(o);k(i),i.count--,i.count===0&&(e.delete(o),i.cacheKey&&this.textureKeyCache.delete(i.cacheKey))}}getDebugInfo(){return{keyCacheSize:this.textureKeyCache.size,idCacheSize:this.textureIdCache.size}}getCtxTexture(n){if(this.ctxTextureCache.has(n))return this.ctxTextureCache.get(n);const t=this.renderer.createCtxTexture(n);return this.ctxTextureCache.set(n,t),t}}class cr{constructor(n){h(this,"textRenderers");this.textRenderers=n}addFontFace(n){for(const t in this.textRenderers){const e=this.textRenderers[t];e&&e.isFontFaceSupported(n)&&e.addFontFace(n)}}static resolveFontFace(n,t){const e=[];return n.reduce((i,s)=>{if(i)return i;const l=s[t.fontFamily];if(!l)return;const c=new Set(l);for(const d of c)(d.descriptors.stretch!==t.fontStretch||d.descriptors.style!==t.fontStyle||d.descriptors.weight!==t.fontWeight)&&c.delete(d);return c.values().next().value},void 0)||e[0]}}const xo={x:(r,n)=>{r.props.x=n},y:(r,n)=>{r.props.y=n},width:(r,n)=>{r.props.width=n},height:(r,n)=>{r.props.height=n},color:(r,n)=>{r.props.color=n},zIndex:(r,n)=>{r.props.zIndex=n},fontFamily:(r,n)=>{r.props.fontFamily=n},fontWeight:(r,n)=>{r.props.fontWeight=n},fontStyle:(r,n)=>{r.props.fontStyle=n},fontStretch:(r,n)=>{r.props.fontStretch=n},fontSize:(r,n)=>{r.props.fontSize=n},scaleX:(r,n)=>{r.props.scaleX=n},scaleY:(r,n)=>{r.props.scaleY=n},text:(r,n)=>{r.props.text=n},textAlign:(r,n)=>{r.props.textAlign=n},contain:(r,n)=>{r.props.contain=n},offsetY:(r,n)=>{r.props.offsetY=n},scrollable:(r,n)=>{r.props.scrollable=n},scrollY:(r,n)=>{r.props.scrollY=n},letterSpacing:(r,n)=>{r.props.letterSpacing=n},debug:(r,n)=>{r.props.debug=n}};class ur{constructor(n){h(this,"stage");h(this,"set");this.stage=n,this.set=Object.freeze({...xo,...this.getPropertySetters()})}setStatus(n,t,e){n.status!==t&&(n.status=t,n.emitter.emit(t,e))}}const yo=24;function vo(r,n,t,e,o,i,s){let l=0;o&&(l=Math.min(Math.max(Math.floor(o.y1/r),0),i.length));const c=0,d=n/t+l*e;if(!(s&&d>=s/t))return{x:c,y:d,lineIndex:l}}class be{constructor(n,t=0){h(this,"iterator");h(this,"peekBuffer",[]);h(this,"_lastIndex");this.iterator=n,this.iterator=n,this._lastIndex=t-1,this.peekBuffer=[]}next(){const n=this.peekBuffer.length>0?this.peekBuffer.pop():this.iterator.next();return n.done?this._lastIndex=-1:this._lastIndex++,n}peek(){if(this.peekBuffer.length>0)return this.peekBuffer[0];const n=this.iterator.next();return this.peekBuffer.push(n),n}get lastIndex(){return this._lastIndex}}function*Ce(r,n=0){let t=n;for(;t<r.length;){const e=r.codePointAt(t);if(e===void 0)throw new Error("Invalid Unicode code point");yield e,t+=e<=65535?1:2}}function _o(r,n,t){const e=t.shapeText(n,new be(Ce(r,0),0));let o=0;for(const i of e)i.mapped&&(o+=i.xAdvance);return o}function wo(r,n,t,e,o,i,s,l,c,d,u,x,g,_,T,S){k(_,"Font face must be loaded"),k(_.loaded,"Font face must be loaded"),k(_.data,"Font face must be loaded"),k(_.shaper,"Font face must be loaded");const b=_.data.info.size,y=l/b,p=i/y,m=c/y,f=x[r],C=(f==null?void 0:f.codepointIndex)||0,F=(f==null?void 0:f.maxX)||0,I=(f==null?void 0:f.maxY)||0;let w=F,v=I,R=n,E=t,z=0;const M={codepointIndex:-1,bufferOffset:-1,xStart:-1},P=_.shaper,$={letterSpacing:m};let W=P.shapeText($,new be(Ce(e,C),C)),X,ct=-1;const Ct=[],te="...",me=s/y,xe=_o(te,$,P);let Pt=!0;for(;Pt;){const xt=u!=="both"||S||E+b+b<=me,ht=xt?p:p-xe;let Z=0;for(;(X=W.next())&&!X.done;){const D=X.value;if(r===x.length)x.push({codepointIndex:D.cluster,maxY:v,maxX:w});else if(r>x.length)throw new Error("Unexpected lineCache length");if(D.codepoint===32||D.codepoint===10?M.codepointIndex!==-1&&(M.codepointIndex=-1,Z=R):M.codepointIndex===-1&&(M.codepointIndex=D.cluster,M.bufferOffset=z,M.xStart=Z),D.mapped){const Rt=R+D.xOffset+D.width;if(u!=="none"&&Rt>=ht&&M.codepointIndex!==-1&&M.codepointIndex<D.cluster&&M.xStart>0)if(xt){W=P.shapeText($,new be(Ce(e,M.codepointIndex),M.codepointIndex)),z=M.bufferOffset;break}else W=P.shapeText($,new be(Ce(te,0),0)),R=M.xStart,z=M.bufferOffset;else{const ot=R+D.xOffset,Ft=E+D.yOffset,ye=g?E+b>=g.y1/y:!0,ve=g?E<=g.y2/y:!0;if(ye&&ve){ct===-1&&(ct=z);const Lt=_.getAtlasEntry(D.glyphId),Nt=Lt.x/_.data.common.scaleW,At=Lt.y/_.data.common.scaleH,Tn=Lt.width/_.data.common.scaleW,bn=Lt.height/_.data.common.scaleH;d[z++]=ot,d[z++]=Ft,d[z++]=Nt,d[z++]=At,d[z++]=ot+D.width,d[z++]=Ft,d[z++]=Nt+Tn,d[z++]=At,d[z++]=ot,d[z++]=Ft+D.height,d[z++]=Nt,d[z++]=At+bn,d[z++]=ot+D.width,d[z++]=Ft+D.height,d[z++]=Nt+Tn,d[z++]=At+bn}v=Math.max(v,Ft+D.height),R+=D.xAdvance,w=Math.max(w,R)}}else if(D.codepoint===10)break}ct!==-1&&(Ct.push({bufferStart:ct,bufferEnd:z}),ct=-1),R=0,E+=b,r++,M.codepointIndex=-1,Z=0,(!T&&u==="both"&&g&&E>g.y2/y||X&&X.done||u==="both"&&!S&&!xt)&&(Pt=!1)}if(o==="center"){const xt=u==="none"?w:p;for(let ht=0;ht<Ct.length;ht++){const Z=Ct[ht],D=d[Z.bufferEnd-4]-d[Z.bufferStart],Rt=(xt-D)/2;for(let ot=Z.bufferStart;ot<Z.bufferEnd;ot+=4)d[ot]+=Rt}}else if(o==="right"){const xt=u==="none"?w:p;for(let ht=0;ht<Ct.length;ht++){const Z=Ct[ht],D=Z.bufferEnd===Z.bufferStart?0:d[Z.bufferEnd-4]-d[Z.bufferStart],Rt=xt-D;for(let ot=Z.bufferStart;ot<Z.bufferEnd;ot+=4)d[ot]+=Rt}}return k(X),{bufferNumFloats:z,bufferNumQuads:z/16,layoutNumCharacters:X.done?e.length-C:X.value.cluster-C+1,fullyProcessed:!!X.done,maxX:w,maxY:v}}function So(r,n,t,e,o,i){const s=e*o,l=i.x1-r,c=i.y1-n;return Mr(i)?{x1:l,y1:c+t-s,x2:l+(i.x2-i.x1),y2:c+t+(i.y2-i.y1)+s}:{x1:0,y1:0,x2:0,y2:0}}class To extends ur{constructor(t){super(t);h(this,"ssdfFontFamilies",{});h(this,"msdfFontFamilies",{});h(this,"sdfShader");this.sdfShader=this.stage.shManager.loadShader("SdfShader").shader}getPropertySetters(){return{fontFamily:(t,e)=>{t.props.fontFamily=e,t.trFontFace=void 0,this.invalidateCache(t)},fontWeight:(t,e)=>{t.props.fontWeight=e,t.trFontFace=void 0,this.invalidateCache(t)},fontStyle:(t,e)=>{t.props.fontStyle=e,t.trFontFace=void 0,this.invalidateCache(t)},fontStretch:(t,e)=>{t.props.fontStretch=e,t.trFontFace=void 0,this.invalidateCache(t)},fontSize:(t,e)=>{t.props.fontSize=e,this.invalidateCache(t)},text:(t,e)=>{t.props.text=e,this.invalidateCache(t)},textAlign:(t,e)=>{t.props.textAlign=e,this.invalidateCache(t)},color:(t,e)=>{t.props.color=e},x:(t,e)=>{t.props.x=e},y:(t,e)=>{t.props.y=e},contain:(t,e)=>{t.props.contain=e,this.invalidateCache(t)},width:(t,e)=>{t.props.width=e,this.invalidateCache(t)},height:(t,e)=>{t.props.height=e,this.invalidateCache(t)},offsetY:(t,e)=>{t.props.offsetY=e,this.invalidateCache(t)},scrollable:(t,e)=>{t.props.scrollable=e,this.invalidateCache(t)},scrollY:(t,e)=>{t.props.scrollY=e},letterSpacing:(t,e)=>{t.props.letterSpacing=e,this.invalidateCache(t)},debug:(t,e)=>{t.props.debug=e}}}canRenderFont(t){const{fontFamily:e}=t;return e in this.ssdfFontFamilies||e in this.msdfFontFamilies||e==="$$SDF_FAILURE_TEST$$"}isFontFaceSupported(t){return t instanceof Rn}addFontFace(t){k(t instanceof Rn);const e=t.fontFamily,o=t.type==="ssdf"?this.ssdfFontFamilies:t.type==="msdf"?this.msdfFontFamilies:void 0;if(!o){console.warn("Invalid font face type: ".concat(t.type));return}let i=o[e];i||(i=new Set,o[e]=i),i.add(t)}createState(t){return{props:t,status:"initialState",emitter:new ue,lineCache:[],forceFullLayoutCalc:!1,renderWindow:void 0,bufferNumFloats:0,bufferNumQuads:0,vertexBuffer:void 0,webGlBuffers:null,bufferUploaded:!1,textH:void 0,textW:void 0,distanceRange:0,trFontFace:void 0,debugData:{updateCount:0,layoutCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,drawCount:0,bufferSize:0}}}updateState(t){performance.now();let{trFontFace:e}=t;const{textH:o,lineCache:i,debugData:s,forceFullLayoutCalc:l}=t;if(s.updateCount++,t.status==="initialState"&&this.setStatus(t,"loading"),!e&&(e=this.resolveFontFace(t.props),t.trFontFace=e,!e)){const P="SdfTextRenderer: Could not resolve font face for family: '".concat(t.props.fontFamily,"'");console.error(P),this.setStatus(t,"failed",new Error(P));return}if(!e.loaded){e.on("loaded",function P(){t.emitter.emit("fontLoaded",{}),e==null||e.off("fontLoaded",P)});return}k(e.data,"Font face data should be loaded");const{text:c,fontSize:d,x:u,y:x,contain:g,width:_,height:T,scrollable:S}=t.props,b=g==="both"&&S?t.props.scrollY:0;let{renderWindow:y}=t;const p=e.data.info.size,m=d/p;t.distanceRange=m*e.data.distanceField.distanceRange;const f=c.length*yo;let C=t.vertexBuffer;(!C||C.length<f)&&(C=new Float32Array(f*2));const F={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight},I={x1:u,y1:x,x2:g!=="none"?u+_:1/0,y2:g==="both"?x+T:1/0},w=Gn(F,I);if(!l&&y){if(u+y.x1<=w.x1&&u+y.x2>=w.x2&&x-b+y.y1<=w.y1&&x-b+y.y2>=w.y2)return;t.renderWindow=y=void 0}const{offsetY:v,textAlign:R}=t.props;if(!y){const P=w.y2-w.y1,$=Math.ceil(P/p);y=So(u,x,b,p,$,w)}const E=vo(d,v,m,p,y,i,o);if(!E){this.setStatus(t,"loaded");return}const{letterSpacing:z}=t.props,M=wo(E.lineIndex,E.x,E.y,c,R,_,T,d,z,C,g,i,y,e,l,S);t.bufferUploaded=!1,t.bufferNumFloats=M.bufferNumFloats,t.bufferNumQuads=M.bufferNumQuads,t.vertexBuffer=C,t.renderWindow=y,s.lastLayoutNumCharacters=M.layoutNumCharacters,s.bufferSize=C.byteLength,M.fullyProcessed&&(t.textW=M.maxX*m,t.textH=M.maxY*m),this.setStatus(t,"loaded")}renderQuads(t,e,o,i){var E,z,M;if(!t.vertexBuffer)return;performance.now();const{renderer:s}=this.stage;this.stage.options;const{fontSize:l,color:c,contain:d,scrollable:u,zIndex:x,debug:g}=t.props,_=d==="both"&&u?t.props.scrollY:0,{textW:T=0,textH:S=0,distanceRange:b,vertexBuffer:y,bufferNumFloats:p,bufferUploaded:m,renderWindow:f,debugData:C,trFontFace:F}=t;let{webGlBuffers:I}=t;if(!I){const P=s.gl,$=4*Float32Array.BYTES_PER_ELEMENT,W=P.createBuffer();k(W),t.webGlBuffers=new Pr([{buffer:W,attributes:{a_position:{name:"a_position",size:2,type:P.FLOAT,normalized:!1,stride:$,offset:0},a_textureCoordinate:{name:"a_textureCoordinate",size:2,type:P.FLOAT,normalized:!1,stride:$,offset:2*Float32Array.BYTES_PER_ELEMENT}}}]),t.bufferUploaded=!1,k(t.webGlBuffers),I=t.webGlBuffers}if(!m){const P=s.gl,$=(E=I==null?void 0:I.getBuffer("a_textureCoordinate"))!=null?E:null;P.bindBuffer(P.ARRAY_BUFFER,$),P.bufferData(P.ARRAY_BUFFER,y,P.STATIC_DRAW),t.bufferUploaded=!0}k(F);const w=new Lr(s.gl,s.options,I,this.sdfShader,{transform:e.data,color:Nr(c,i),size:l/(((z=F.data)==null?void 0:z.info.size)||0),scrollY:_,distanceRange:b,debug:g.sdfShaderDebug},i,o,{height:S,width:T},0,x),v=(M=t.trFontFace)==null?void 0:M.texture;k(v);const R=this.stage.txManager.getCtxTexture(v);w.addTexture(R),w.length=t.bufferNumFloats,w.numQuads=t.bufferNumQuads,s.addRenderable(w)}resolveFontFace(t){return cr.resolveFontFace([this.msdfFontFamilies,this.ssdfFontFamilies],t)}invalidateCache(t){t.renderWindow=void 0,t.textH=void 0,t.textW=void 0,t.lineCache=[],this.setStatus(t,"loading")}}const En=2048;class bo{constructor(n,t){h(this,"_canvas");h(this,"_context");h(this,"_settings");h(this,"renderInfo");this._canvas=n,this._context=t,this._settings=this.mergeDefaults({})}set settings(n){this._settings=this.mergeDefaults(n)}get settings(){return this._settings}getPrecision(){return this._settings.precision}setFontProperties(){this._context.font=this._getFontSetting(),this._context.textBaseline=this._settings.textBaseline}_getFontSetting(){const n=[this._settings.fontFace],t=[];for(let e=0,o=n.length;e<o;e++)n[e]==="serif"||n[e]==="sans-serif"?t.push(n[e]):t.push('"'.concat(n[e],'"'));return"".concat(this._settings.fontStyle," ").concat(this._settings.fontSize*this.getPrecision(),"px ").concat(t.join(","))}_load(){if(document.fonts){const n=this._getFontSetting();try{if(!document.fonts.check(n,this._settings.text))return document.fonts.load(n,this._settings.text).catch(t=>{console.warn("[Lightning] Font load error",t,n)}).then(()=>{document.fonts.check(n,this._settings.text)||console.warn("[Lightning] Font not found",n)})}catch(t){console.warn("[Lightning] Can't check font loading for "+n)}}}calculateRenderInfo(){const n={},t=this.getPrecision(),e=this._settings.paddingLeft*t,o=this._settings.paddingRight*t,i=this._settings.fontSize*t;let s=this._settings.offsetY===null?null:this._settings.offsetY*t,l=(this._settings.lineHeight||i)*t;const c=this._settings.w*t,d=this._settings.h*t;let u=this._settings.wordWrapWidth*t;const x=this._settings.cutSx*t,g=this._settings.cutEx*t,_=this._settings.cutSy*t,T=this._settings.cutEy*t,S=(this._settings.letterSpacing||0)*t,b=this._settings.textIndent*t;this.setFontProperties();let y=c||2048/this.getPrecision(),p=y-e;if(p<10&&(y+=10-p,p=10),u||(u=p),this._settings.textOverflow&&!this._settings.wordWrap){let w;switch(this._settings.textOverflow){case"clip":w="";break;case"ellipsis":w=this._settings.maxLinesSuffix;break;default:w=this._settings.textOverflow}this._settings.text=this.wrapWord(this._settings.text,u-b,w)}let m;if(this._settings.wordWrap)m=this.wrapText(this._settings.text,u,S,b);else{m={l:this._settings.text.split(/(?:\r\n|\r|\n)/),n:[]};const w=m.l.length;for(let v=0;v<w-1;v++)m.n.push(v)}let f=m.l;if(this._settings.maxLines&&f.length>this._settings.maxLines){const w=f.slice(0,this._settings.maxLines);let v=null;if(this._settings.maxLinesSuffix){const P=this._settings.maxLinesSuffix?this.measureText(this._settings.maxLinesSuffix):0,$=this.wrapText(w[w.length-1],u-P,S,b);w[w.length-1]="".concat($.l[0]).concat(this._settings.maxLinesSuffix),v=[$.l.length>1?$.l[1]:""]}else v=[""];let R;const E=f.length;let z=0;const M=m.n.length;for(R=this._settings.maxLines;R<E;R++)v[z]+="".concat(v[z]?" ":"").concat(f[R]),R+1<M&&m.n[R+1]&&z++;n.remainingText=v.join("\n"),n.moreTextLines=!0,f=w}else n.moreTextLines=!1,n.remainingText="";let C=0;const F=[];for(let w=0;w<f.length;w++){const v=this.measureText(f[w],S)+(w===0?b:0);F.push(v),C=Math.max(C,v)}n.lineWidths=F,c||(y=C+e+o,p=C),l=l||i;let I;if(d)I=d;else{const w=this._settings.textBaseline!="bottom"?.5*i:0;I=l*(f.length-1)+w+Math.max(l,i)+(s||0)}return s===null&&(s=i),n.w=y,n.h=I,n.lines=f,n.precision=t,y||(y=1),I||(I=1),(x||g)&&(y=Math.min(y,g-x)),(_||T)&&(I=Math.min(I,T-_)),n.width=y,n.innerWidth=p,n.height=I,n.fontSize=i,n.cutSx=x,n.cutSy=_,n.cutEx=g,n.cutEy=T,n.lineHeight=l,n.lineWidths=F,n.offsetY=s,n.paddingLeft=e,n.paddingRight=o,n.letterSpacing=S,n.textIndent=b,n}draw(n,t){const e=this.getPrecision(),o=(t==null?void 0:t.lines)||n.lines,i=(t==null?void 0:t.lineWidths)||n.lineWidths,s=t?t.lines.length*n.lineHeight:n.height;this._canvas.width=Math.min(Math.ceil(n.width+this._settings.textRenderIssueMargin),En),this._canvas.height=Math.min(Math.ceil(s),En),this.setFontProperties(),n.fontSize>=128&&(this._context.globalAlpha=.01,this._context.fillRect(0,0,.01,.01),this._context.globalAlpha=1),(n.cutSx||n.cutSy)&&this._context.translate(-n.cutSx,-n.cutSy);let l,c;const d=[];for(let x=0,g=o.length;x<g;x++)l=x===0?n.textIndent:0,c=x*n.lineHeight+n.offsetY,this._settings.verticalAlign=="middle"?c+=(n.lineHeight-n.fontSize)/2:this._settings.verticalAlign=="bottom"&&(c+=n.lineHeight-n.fontSize),this._settings.textAlign==="right"?l+=n.innerWidth-i[x]:this._settings.textAlign==="center"&&(l+=(n.innerWidth-i[x])/2),l+=n.paddingLeft,d.push({text:o[x],x:l,y:c,w:i[x]});if(this._settings.highlight){const x=this._settings.highlightColor,g=this._settings.highlightHeight*e||n.fontSize*1.5,_=this._settings.highlightOffset*e,T=this._settings.highlightPaddingLeft!==null?this._settings.highlightPaddingLeft*e:n.paddingLeft,S=this._settings.highlightPaddingRight!==null?this._settings.highlightPaddingRight*e:n.paddingRight;this._context.fillStyle=Xe(x);for(let b=0;b<d.length;b++){const y=d[b];this._context.fillRect(y.x-T,y.y-n.offsetY+_,y.w+S+T,g)}}let u=null;this._settings.shadow&&(u=[this._context.shadowColor,this._context.shadowOffsetX,this._context.shadowOffsetY,this._context.shadowBlur],this._context.shadowColor=Xe(this._settings.shadowColor),this._context.shadowOffsetX=this._settings.shadowOffsetX*e,this._context.shadowOffsetY=this._settings.shadowOffsetY*e,this._context.shadowBlur=this._settings.shadowBlur*e),this._context.fillStyle=Xe(this._settings.textColor);for(let x=0,g=d.length;x<g;x++){const _=d[x];if(n.letterSpacing===0)this._context.fillText(_.text,_.x,_.y);else{const T=_.text.split("");let S=_.x;for(let b=0,y=T.length;b<y;b++)this._context.fillText(T[b],S,_.y),S+=this.measureText(T[b],n.letterSpacing)}}u&&(this._context.shadowColor=u[0],this._context.shadowOffsetX=u[1],this._context.shadowOffsetY=u[2],this._context.shadowBlur=u[3]),(n.cutSx||n.cutSy)&&this._context.translate(n.cutSx,n.cutSy),this.renderInfo=n}wrapWord(n,t,e){const o=this._context.measureText(e).width,i=n.length,s=this._context.measureText(n).width;if(s<=t)return n;let l=Math.floor(t*i/s),c=this._context.measureText(n.substring(0,l)).width+o;if(c>t)for(;l>0&&(c=this._context.measureText(n.substring(0,l)).width+o,c>t);)l-=1;else for(;l<i;)if(c=this._context.measureText(n.substring(0,l)).width+o,c<t)l+=1;else{l-=1;break}return n.substring(0,l)+(t>=o?e:"")}wrapText(n,t,e,o=0){const i=n.split(/\r?\n/g);let s=[];const l=[];for(let c=0;c<i.length;c++){const d=[];let u="",x=t-o;const g=i[c].split(" ");for(let _=0;_<g.length;_++){const T=this.measureText(g[_],e),S=T+this.measureText(" ",e);_===0||S>x?(_>0&&(d.push(u),u=""),u+=g[_],x=t-T-(_===0?o:0)):(x-=S,u+=" ".concat(g[_]))}d.push(u),u="",s=s.concat(d),c<i.length-1&&l.push(s.length)}return{l:s,n:l}}measureText(n,t=0){return t?n.split("").reduce((e,o)=>e+this._context.measureText(o).width+t,0):this._context.measureText(n).width}mergeDefaults(n){return{text:"",w:0,h:0,fontStyle:"normal",fontSize:40,fontFace:null,wordWrap:!0,wordWrapWidth:0,wordBreak:!1,textOverflow:"",lineHeight:null,textBaseline:"alphabetic",textAlign:"left",verticalAlign:"top",offsetY:null,maxLines:0,maxLinesSuffix:"..",textColor:[1,1,1,1],paddingLeft:0,paddingRight:0,shadow:!1,shadowColor:[0,0,0,1],shadowOffsetX:0,shadowOffsetY:0,shadowBlur:5,highlight:!1,highlightHeight:0,highlightColor:[0,0,0,1],highlightOffset:0,highlightPaddingLeft:0,highlightPaddingRight:0,letterSpacing:0,textIndent:0,cutSx:0,cutEx:0,cutSy:0,cutEy:0,advancedRenderer:!1,fontBaselineRatio:0,precision:1,textRenderIssueMargin:0,...n}}}const kn=typeof self>"u"?globalThis:self;var On;const zn=((On=kn.document)==null?void 0:On.fonts)||kn.fonts;function Co(r){const{fontFamily:n,fontStyle:t,fontWeight:e,fontStretch:o,fontSize:i}=r;return[t,e,o,"".concat(i,"px"),n].join(" ")}class Ro extends ur{constructor(t){super(t);h(this,"canvas");h(this,"context");typeof OffscreenCanvas<"u"?this.canvas=new OffscreenCanvas(0,0):this.canvas=document.createElement("canvas");let e=this.canvas.getContext("2d");e||(this.canvas=document.createElement("canvas"),e=this.canvas.getContext("2d")),k(e),this.context=e}getPropertySetters(){return{fontFamily:(t,e)=>{t.props.fontFamily=e,t.fontInfo=void 0,this.markForReload(t)},fontWeight:(t,e)=>{t.props.fontWeight=e,t.fontInfo=void 0,this.markForReload(t)},fontStyle:(t,e)=>{t.props.fontStyle=e,t.fontInfo=void 0,this.markForReload(t)},fontStretch:(t,e)=>{t.props.fontStretch=e,t.fontInfo=void 0,this.markForReload(t)},fontSize:(t,e)=>{t.props.fontSize=e,t.fontInfo=void 0,this.markForReload(t)},text:(t,e)=>{t.props.text=e,this.markForReload(t)},textAlign:(t,e)=>{t.props.textAlign=e,this.markForReload(t)},color:(t,e)=>{t.props.color=e,this.markForReload(t)},x:(t,e)=>{t.props.x=e},y:(t,e)=>{t.props.y=e},contain:(t,e)=>{t.props.contain=e,this.markForReload(t)},width:(t,e)=>{t.props.width=e,this.markForReload(t)},height:(t,e)=>{t.props.height=e,this.markForReload(t)},offsetY:(t,e)=>{t.props.offsetY=e,this.markForReload(t)},scrollY:(t,e)=>{t.props.scrollY=e},letterSpacing:(t,e)=>{t.props.letterSpacing=e,this.markForReload(t)}}}canRenderFont(t){return!0}isFontFaceSupported(t){return t instanceof Fn}addFontFace(t){k(t instanceof Fn),zn.add(t.fontFace)}createState(t){return{props:t,status:"initialState",emitter:new ue,canvasPages:void 0,lightning2TextRenderer:new bo(this.canvas,this.context),renderWindow:void 0,renderInfo:void 0,forceFullLayoutCalc:!1,textW:0,textH:0,fontInfo:void 0,fontFaceLoadedHandler:void 0,debugData:{updateCount:0,layoutCount:0,drawCount:0,lastLayoutNumCharacters:0,layoutSum:0,drawSum:0,bufferSize:0}}}updateState(t){if(t.status==="initialState"&&this.setStatus(t,"loading"),!t.fontInfo){const y=Co(t.props);if(t.fontInfo={cssString:y,loaded:!1},!t.fontInfo.loaded){zn.load(y).then(this.onFontLoaded.bind(this,t,y)).catch(this.onFontLoadError.bind(this,t,y));return}}if(!t.fontInfo.loaded)return;if(!t.renderInfo){t.lightning2TextRenderer.settings={text:t.props.text,textAlign:t.props.textAlign,fontFace:t.props.fontFamily,fontSize:t.props.fontSize,fontStyle:[t.props.fontStretch,t.props.fontStyle,t.props.fontWeight].join(" "),textColor:bt(t.props.color),offsetY:t.props.fontSize+t.props.offsetY,wordWrap:t.props.contain!=="none",wordWrapWidth:t.props.contain==="none"?void 0:t.props.width,letterSpacing:t.props.letterSpacing};const y=performance.now();t.renderInfo=t.lightning2TextRenderer.calculateRenderInfo(),console.log("Render info calculated in",performance.now()-y,"ms"),t.textH=t.renderInfo.lineHeight*t.renderInfo.lines.length,t.textW=t.renderInfo.width,t.renderWindow=void 0}const{x:e,y:o,width:i,height:s,scrollY:l,contain:c}=t.props;let{renderWindow:d,canvasPages:u}=t;const x={x1:0,y1:0,x2:this.stage.options.appWidth,y2:this.stage.options.appHeight},g={x1:e,y1:o,x2:c!=="none"?e+i:1/0,y2:c==="both"?o+s:1/0},_=Gn(x,g),T=_.y2-_.y1,S=Math.ceil(T/t.renderInfo.lineHeight);if(d&&u){const y=e+d.x1,p=o-l+d.y1,m=e+d.x2,f=o-l+d.y2;if(y<=_.x1&&m>=_.x2&&p<=_.y1&&f>=_.y2)return;f<_.y2?(d.y1+=S*t.renderInfo.lineHeight,d.y2+=S*t.renderInfo.lineHeight,u.push(u.shift()),u[2].lineNumStart=u[1].lineNumStart+S,u[2].lineNumEnd=u[2].lineNumStart+S,u[2].valid=!1):p>_.y1&&(d.y1-=S*t.renderInfo.lineHeight,d.y2-=S*t.renderInfo.lineHeight,u.unshift(u.pop()),u[0].lineNumStart=u[1].lineNumStart-S,u[0].lineNumEnd=u[0].lineNumStart+S,u[0].valid=!1)}else{const y=t.renderInfo.lineHeight*S,m=Math.ceil(l/y)*S,f=m-S,C=m+S;u=[{texture:u==null?void 0:u[0].texture,lineNumStart:f,lineNumEnd:f+S,valid:!1},{texture:u==null?void 0:u[1].texture,lineNumStart:m,lineNumEnd:m+S,valid:!1},{texture:u==null?void 0:u[2].texture,lineNumStart:C,lineNumEnd:C+S,valid:!1}],t.canvasPages=u;const F=Math.ceil(l/y)*y;d={x1:0,y1:F-y,x2:i,y2:F+y*2}}t.renderWindow=d;const b=performance.now();for(const y of u)if(!y.valid){if(y.lineNumStart<0){y.texture=this.stage.txManager.loadTexture("ImageTexture",{src:""}),y.valid=!0;continue}t.lightning2TextRenderer.draw(t.renderInfo,{lines:t.renderInfo.lines.slice(y.lineNumStart,y.lineNumEnd),lineWidths:t.renderInfo.lineWidths.slice(y.lineNumStart,y.lineNumEnd)}),this.canvas.width===0||this.canvas.height===0||(y.texture=this.stage.txManager.loadTexture("ImageTexture",{src:this.context.getImageData(0,0,this.canvas.width,this.canvas.height)},{preload:!0})),y.valid=!0}console.log("pageDrawTime",performance.now()-b,"ms"),this.setStatus(t,"loaded")}renderQuads(t,e,o,i){var I,w,v,R,E,z,M,P,$,W,X,ct;const{stage:s}=this,{canvasPages:l,textW:c=0,textH:d=0,renderWindow:u}=t;if(!l||!u)return;const{x,y:g,scrollY:_,contain:T,width:S,height:b}=t.props,y={x,y:g,width:T!=="none"?S:c,height:T==="both"?b:d};Kn({x:0,y:0,width:s.options.appWidth,height:s.options.appHeight},y),k(l,"canvasPages is not defined"),k(u,"renderWindow is not defined");const m=(u.y2-u.y1)/3,{zIndex:f,color:C}=t.props,F=i*Ar(C);l[0].valid&&this.stage.renderer.addRenderable({alpha:F,clippingRect:o,colorBl:4294967295,colorBr:4294967295,colorTl:4294967295,colorTr:4294967295,width:((w=(I=l[0].texture)==null?void 0:I.dimensions)==null?void 0:w.width)||0,height:((R=(v=l[0].texture)==null?void 0:v.dimensions)==null?void 0:R.height)||0,texture:l[0].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:f,tx:e.tx,ty:e.ty-_+u.y1,ta:e.ta,tb:e.tb,tc:e.tc,td:e.td}),l[1].valid&&this.stage.renderer.addRenderable({alpha:F,clippingRect:o,colorBl:4294967295,colorBr:4294967295,colorTl:4294967295,colorTr:4294967295,width:((z=(E=l[1].texture)==null?void 0:E.dimensions)==null?void 0:z.width)||0,height:((P=(M=l[1].texture)==null?void 0:M.dimensions)==null?void 0:P.height)||0,texture:l[1].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:f,tx:e.tx,ty:e.ty-_+u.y1+m,ta:e.ta,tb:e.tb,tc:e.tc,td:e.td}),l[2].valid&&this.stage.renderer.addRenderable({alpha:F,clippingRect:o,colorBl:4294967295,colorBr:4294967295,colorTl:4294967295,colorTr:4294967295,width:((W=($=l[2].texture)==null?void 0:$.dimensions)==null?void 0:W.width)||0,height:((ct=(X=l[2].texture)==null?void 0:X.dimensions)==null?void 0:ct.height)||0,texture:l[2].texture,textureOptions:{},shader:null,shaderProps:null,zIndex:f,tx:e.tx,ty:e.ty-_+u.y1+m+m,ta:e.ta,tb:e.tb,tc:e.tc,td:e.td})}markForReload(t){t.renderInfo=void 0,this.setStatus(t,"loading")}onFontLoaded(t,e){var o;e!==((o=t.fontInfo)==null?void 0:o.cssString)||!t.fontInfo||(t.fontInfo.loaded=!0,this.updateState(t))}onFontLoadError(t,e,o){var i;e!==((i=t.fontInfo)==null?void 0:i.cssString)||!t.fontInfo||(t.fontInfo.loaded=!0,console.error("CanvasTextRenderer: Error loading font '".concat(t.fontInfo.cssString,"'"),o),this.updateState(t))}}const Fo=2e6;class Io{constructor(n){h(this,"options");h(this,"animationManager");h(this,"txManager");h(this,"fontManager");h(this,"textRenderers");h(this,"shManager");h(this,"renderer");h(this,"scene");h(this,"deltaTime",0);h(this,"lastFrameTime",0);h(this,"currentFrameTime",0);this.options=n;const{canvas:t,clearColor:e,rootId:o,debug:i,appWidth:s,appHeight:l}=n;this.txManager=new mo,this.shManager=new go,this.animationManager=new po,i!=null&&i.monitorTextureCache&&setInterval(()=>{k(this.txManager);const d=this.txManager.getDebugInfo();console.log("Texture ID Cache Size: ",d.idCacheSize),console.log("Texture Key Cache Size: ",d.keyCacheSize)},1e3),this.renderer=new $r({stage:this,canvas:t,pixelRatio:n.devicePhysicalPixelRatio*n.deviceLogicalPixelRatio,clearColor:e!=null?e:4278190080,bufferMemory:Fo,txManager:this.txManager,shManager:this.shManager}),this.txManager.renderer=this.renderer,this.textRenderers={canvas:new Ro(this),sdf:new To(this)},this.fontManager=new cr(this.textRenderers);const c=new mn(this,{id:o,x:0,y:0,width:s,height:l,alpha:1,clipping:!1,color:0,colorTop:0,colorBottom:0,colorLeft:0,colorRight:0,colorTl:0,colorTr:0,colorBl:0,colorBr:0,zIndex:0,zIndexLocked:0,scaleX:1,scaleY:1,mountX:0,mountY:0,mount:0,pivot:.5,pivotX:.5,pivotY:.5,rotation:0,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null});this.scene=new co(c),uo(this)}drawFrame(){var o,i;const{renderer:n,scene:t,animationManager:e}=this;t!=null&&t.root&&(this.lastFrameTime=this.currentFrameTime,this.currentFrameTime=ho(),this.deltaTime=this.lastFrameTime?this.currentFrameTime-this.lastFrameTime:100/6,e.update(this.deltaTime),n==null||n.reset(),(o=t==null?void 0:t.root)!=null&&o.hasUpdates&&((i=t==null?void 0:t.root)==null||i.update(this.deltaTime)),this.addQuads(t.root),n==null||n.sortRenderables(),n==null||n.render())}addQuads(n,t=null){k(this.renderer&&n.globalTransform);const e=n.globalTransform,o=e.tb!==0||e.tc!==0;let i=n.clipping&&!o?{x:e.tx,y:e.ty,width:n.width*e.ta,height:n.height*e.td}:null;t&&i?i=Kn(t,i):t&&(i=t),n.renderQuads(this.renderer,i),n.children.forEach(s=>{s.worldAlpha!==0&&this.addQuads(s,i)})}resolveTextRenderer(n,t=null){let e=t,o=!1;if(e){const s=this.textRenderers[e];s?s.canRenderFont(n)||(console.warn("Cannot use override text renderer '".concat(e,"' for font"),n),e=null,o=!0):(console.warn("Text renderer override '".concat(e,"' not found.")),e=null,o=!0)}if(!e){for(const[s,l]of Object.entries(this.textRenderers))if(s!=="canvas"&&l.canRenderFont(n)){e=s;break}e||(e="canvas")}o&&console.warn("Falling back to text renderer ".concat(String(e)));const i=this.textRenderers[e];return k(i,"resolvedTextRenderer undefined"),i}get root(){var n;return((n=this.scene)==null?void 0:n.root)||null}}class Eo extends mn{constructor(t,e){super(t,e);h(this,"textRenderer");h(this,"trState");h(this,"updateScheduled");h(this,"_textRendererOverride",null);h(this,"onTextLoaded",()=>{const{contain:t}=this,e=this.trState.props.width,o=this.trState.props.height,i=this.trState.textW||0,s=this.trState.textH||0;t==="both"?(this.props.width=e,this.props.height=o):t==="width"?(this.props.width=e,this.props.height=s):t==="none"&&(this.props.width=i,this.props.height=s),this.updateLocalTransform(),this.emit("loaded",{type:"text",dimensions:{width:this.trState.textW||0,height:this.trState.textH||0}})});h(this,"onTextFailed",(t,e)=>{this.emit("failed",{type:"text",error:e})});this.updateScheduled=!1,this._textRendererOverride=e.textRendererOverride;const{resolvedTextRenderer:o,textRendererState:i}=this.resolveTextRendererAndState({x:this.absX,y:this.absY,width:e.width,height:e.height,textAlign:e.textAlign,color:e.color,zIndex:e.zIndex,contain:e.contain,scaleX:e.scaleX,scaleY:e.scaleY,scrollable:e.scrollable,scrollY:e.scrollY,offsetY:e.offsetY,letterSpacing:e.letterSpacing,debug:e.debug,fontFamily:e.fontFamily,fontSize:e.fontSize,fontStretch:e.fontStretch,fontStyle:e.fontStyle,fontWeight:e.fontWeight,text:e.text},void 0);this.textRenderer=o,this.trState=i}get width(){return this.trState.props.width}set width(t){this.textRenderer.set.width(this.trState,t),this.updateText()}get height(){return this.trState.props.height}set height(t){this.textRenderer.set.height(this.trState,t),this.updateText()}get color(){return this.trState.props.color}set color(t){this.textRenderer.set.color(this.trState,t),this.updateText()}get text(){return this.trState.props.text}set text(t){this.textRenderer.set.text(this.trState,t),this.updateText()}get textRendererOverride(){return this._textRendererOverride}set textRendererOverride(t){this._textRendererOverride=t;const{resolvedTextRenderer:e,textRendererState:o}=this.resolveTextRendererAndState(this.trState.props,this.trState);this.textRenderer=e,this.trState=o}get fontSize(){return this.trState.props.fontSize}set fontSize(t){this.textRenderer.set.fontSize(this.trState,t),this.updateText()}get fontFamily(){return this.trState.props.fontFamily}set fontFamily(t){this.textRenderer.set.fontFamily(this.trState,t),this.updateText()}get fontStretch(){return this.trState.props.fontStretch}set fontStretch(t){this.textRenderer.set.fontStretch(this.trState,t),this.updateText()}get fontStyle(){return this.trState.props.fontStyle}set fontStyle(t){this.textRenderer.set.fontStyle(this.trState,t),this.updateText()}get fontWeight(){return this.trState.props.fontWeight}set fontWeight(t){this.textRenderer.set.fontWeight(this.trState,t),this.updateText()}get textAlign(){return this.trState.props.textAlign}set textAlign(t){this.textRenderer.set.textAlign(this.trState,t),this.updateText()}get contain(){return this.trState.props.contain}set contain(t){this.textRenderer.set.contain(this.trState,t),this.updateText()}get scrollable(){return this.trState.props.scrollable}set scrollable(t){this.textRenderer.set.scrollable(this.trState,t),this.updateText()}get scrollY(){return this.trState.props.scrollY}set scrollY(t){this.textRenderer.set.scrollY(this.trState,t),this.updateText()}get offsetY(){return this.trState.props.offsetY}set offsetY(t){this.textRenderer.set.offsetY(this.trState,t),this.updateText()}get letterSpacing(){return this.trState.props.letterSpacing}set letterSpacing(t){this.textRenderer.set.letterSpacing(this.trState,t),this.updateText()}get debug(){return this.trState.props.debug}set debug(t){this.textRenderer.set.debug(this.trState,t),this.updateText()}update(t){super.update(t),k(this.globalTransform),this.textRenderer.set.x(this.trState,this.globalTransform.tx),this.textRenderer.set.y(this.trState,this.globalTransform.ty),this.trState.status==="loading"&&this.textRenderer.updateState(this.trState)}updateText(){this.updateScheduled||(this.updateScheduled=!0,queueMicrotask(()=>{this.updateScheduled=!1,this.textRenderer.updateState(this.trState)}))}renderQuads(t,e){k(this.globalTransform),this.textRenderer.renderQuads(this.trState,this.globalTransform,e,this.worldAlpha)}resolveTextRendererAndState(t,e){const o=this.stage.resolveTextRenderer(t,this._textRendererOverride),i=o.createState(t);return e&&["loading","loaded","failed"].forEach(l=>{e.emitter.off(l)}),i.emitter.on("loading",()=>{i.emitter.once("fontLoaded",()=>{this.updateText()}),i.emitter.once("loaded",()=>{i.emitter.off("fontLoaded")})}),i.emitter.on("loaded",this.onTextLoaded),i.emitter.on("failed",this.onTextFailed),this.updateText(),{resolvedTextRenderer:o,textRendererState:i}}}class ko extends en{constructor(n,t,e){super(n,t,e,new Eo(e,{id:sr(),x:n.x,y:n.y,width:n.width,height:n.height,alpha:n.alpha,clipping:n.clipping,color:n.color,colorTop:n.colorTop,colorBottom:n.colorBottom,colorLeft:n.colorLeft,colorRight:n.colorRight,colorTl:n.colorTl,colorTr:n.colorTr,colorBl:n.colorBl,colorBr:n.colorBr,zIndex:n.zIndex,zIndexLocked:n.zIndexLocked,scaleX:n.scaleX,scaleY:n.scaleY,mountX:n.mountX,mountY:n.mountY,mount:n.mount,pivot:n.pivot,pivotX:n.pivotX,pivotY:n.pivotY,rotation:n.rotation,text:n.text,fontSize:n.fontSize,fontFamily:n.fontFamily,fontWeight:n.fontWeight,fontStretch:n.fontStretch,fontStyle:n.fontStyle,contain:n.contain,scrollable:n.scrollable,letterSpacing:n.letterSpacing,textAlign:n.textAlign,scrollY:n.scrollY,offsetY:n.offsetY,textRendererOverride:n.textRendererOverride,debug:n.debug,parent:null,texture:null,textureOptions:null,shader:null,shaderProps:null}))}get text(){return this.coreNode.text}set text(n){this.coreNode.text=n}get textRendererOverride(){return this.coreNode.textRendererOverride}set textRendererOverride(n){this.coreNode.textRendererOverride=n}get fontSize(){return this.coreNode.fontSize}set fontSize(n){this.coreNode.fontSize=n}get fontFamily(){return this.coreNode.fontFamily}set fontFamily(n){this.coreNode.fontFamily=n}get fontWeight(){return this.coreNode.fontWeight}set fontWeight(n){this.coreNode.fontWeight=n}get fontStretch(){return this.coreNode.fontStretch}set fontStretch(n){this.coreNode.fontStretch=n}get fontStyle(){return this.coreNode.fontStyle}set fontStyle(n){this.coreNode.fontStyle=n}get textAlign(){return this.coreNode.textAlign}set textAlign(n){this.coreNode.textAlign=n}get contain(){return this.coreNode.contain}set contain(n){this.coreNode.contain=n}get scrollable(){return this.coreNode.scrollable}set scrollable(n){this.coreNode.scrollable=n}get scrollY(){return this.coreNode.scrollY}set scrollY(n){this.coreNode.scrollY=n}get offsetY(){return this.coreNode.offsetY}set offsetY(n){this.coreNode.offsetY=n}get letterSpacing(){return this.coreNode.letterSpacing}set letterSpacing(n){this.coreNode.letterSpacing=n}get debug(){return this.coreNode.debug}set debug(n){this.coreNode.debug=n}}const zo="modulepreload",Mo=function(r){return"/solid-demo-app/"+r},Mn={},Po=function(n,t,e){if(!t||t.length===0)return n();const o=document.getElementsByTagName("link");return Promise.all(t.map(i=>{if(i=Mo(i),i in Mn)return;Mn[i]=!0;const s=i.endsWith(".css"),l=s?'[rel="stylesheet"]':"";if(!!e)for(let u=o.length-1;u>=0;u--){const x=o[u];if(x.href===i&&(!s||x.rel==="stylesheet"))return}else if(document.querySelector('link[href="'.concat(i,'"]').concat(l)))return;const d=document.createElement("link");if(d.rel=s?"stylesheet":zo,s||(d.as="script",d.crossOrigin=""),d.href=i,document.head.appendChild(d),s)return new Promise((u,x)=>{d.addEventListener("load",u),d.addEventListener("error",()=>x(new Error("Unable to preload CSS for ".concat(i))))})})).then(()=>n()).catch(i=>{const s=new Event("vite:preloadError",{cancelable:!0});if(s.payload=i,window.dispatchEvent(s),!s.defaultPrevented)throw i})};function Lo(r){return r.prototype instanceof Br}async function No(r,n){let t;try{console.log("Loading core extension",r),t=await Po(()=>import(r),[])}catch(o){console.error("The core extension module at '".concat(r,"' could not be loaded.")),console.error(o);return}if(!t.default){console.error("The core extension module at '".concat(r,"' does not have a default export."));return}const e=t.default;if(Lo(e)){const o=new e;try{await o.run(n)}catch(i){console.error("The core extension at '".concat(r,"' threw an error.")),console.error(i)}}else console.error("The core extension at '".concat(r,"' does not extend CoreExtension."))}class Ao{constructor(){h(this,"root",null);h(this,"stage",null);h(this,"rendererMain",null)}async init(n,t,e){this.stage=new Io({rootId:1,appWidth:t.appWidth,appHeight:t.appHeight,deviceLogicalPixelRatio:t.deviceLogicalPixelRatio,devicePhysicalPixelRatio:t.devicePhysicalPixelRatio,clearColor:t.clearColor,canvas:e,debug:{monitorTextureCache:!1}}),this.rendererMain=n,k(this.stage.root);const o=new en(n.resolveNodeDefaults({}),this.rendererMain,this.stage,this.stage.root);this.root=o,o.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,o)),this.onCreateNode(o),t.coreExtensionModule&&await No(t.coreExtensionModule,this.stage)}createNode(n){k(this.rendererMain),k(this.stage);const t=new en(n,this.rendererMain,this.stage);return t.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,t)),this.onCreateNode(t),t}createTextNode(n){k(this.rendererMain),k(this.stage);const t=new ko(n,this.rendererMain,this.stage);return t.once("beforeDestroy",this.onBeforeDestroyNode.bind(this,t)),this.onCreateNode(t),t}destroyNode(n){n.destroy()}releaseTexture(n){const{stage:t}=this;k(t),t.txManager.removeTextureIdFromCache(n)}getRootNode(){return k(this.root),this.root}onCreateNode(n){throw new Error("Method not implemented.")}onBeforeDestroyNode(n){throw new Error("Method not implemented.")}}let lt,yn;const $o={appWidth:1920,appHeight:1080,deviceLogicalPixelRatio:.6666667,devicePhysicalPixelRatio:1,rootId:"app",threadXCoreWorkerUrl:void 0};function Bo(r={}){const n=new Ao,t={...$o,...r};return lt=new oo({appWidth:t.appWidth,appHeight:t.appHeight,deviceLogicalPixelRatio:t.deviceLogicalPixelRatio,devicePhysicalPixelRatio:t.devicePhysicalPixelRatio,clearColor:t.clearColor,coreExtensionModule:t.coreExtensionModule},t.rootId,n),yn=lt.createShader.bind(lt),lt}class Yo extends Array{constructor(t){super();h(this,"_parent");this._parent=t}get selected(){return this[this._parent.selected||0]}get firstChild(){return this[0]}insert(t,e){if(e){const o=this.indexOf(e);this.splice(o,0,t)}else this.push(t);t.parent=this._parent,this._parent._isDirty=!0}remove(t){const e=this.indexOf(t);e>=0&&this.splice(e,1)}}const pt={debug:!1,driver:"main",animationSettings:{duration:250,easing:"ease-in-out"},fontSettings:{fontFamily:"Ubuntu",fontSize:100}};var Wn,Xn;const Do=((Xn=(Wn=import.meta)==null?void 0:Wn.env)==null?void 0:Xn.MODE)==="development";function Xt(r,n,...t){Do&&(pt.debug||Oo(n)&&n.debug)&&console.log(r,n,...t)}function Re(r){return typeof r=="function"}function Oo(r){return typeof r=="object"}function Fe(r){return Array.isArray(r)}function Wo(r){return typeof r=="string"}function Xo(r){return typeof r=="number"}function jo(r){return Number.isInteger(r)}function Ho(r,n){for(const t of n)if(t in r)return!0;return!1}class Pn extends Array{constructor(t,e=[]){var n=(...args)=>{super(...args);h(this,"onChange")};return Fe(e)?n(...e):Wo(e)?n(e):n(...Object.entries(e).filter(([o,i])=>i).map(([o])=>o)),this.onChange=t,this}has(t){return this.indexOf(t)>=0}is(t){return this.indexOf(t)>=0}add(t){this.push(t),this.onChange()}toggle(t){this.has(t)?this.remove(t):this.add(t)}remove(t){const e=this.indexOf(t);e>=0&&(this.splice(e,1),this.onChange())}}function Uo(r){const n=r.children.filter(y=>y.name!=="TextNode"),t=r.flexDirection||"row",e=t==="row"?"width":"height",o=t==="row"?"height":"width",i=t==="row"?"marginLeft":"marginTop",s=t==="row"?"marginRight":"marginBottom",l=t==="row"?"x":"y",c=t==="row"?"y":"x",d=r[e]||0,u=r[o]||0,x=n.reduce((y,p)=>y+(p[e]||0),0),g=r.gap||0,_=n.length,T=r.justifyContent||"flexStart",S=r.alignItems,b=u&&S?y=>{S==="flexStart"?y[c]=0:S==="center"?y[c]=(u-(y[o]||0))/2:S==="flexEnd"&&(y[c]=u-(y[o]||0))}:y=>y;if(T==="flexStart"){let y=0;n.forEach(p=>{p[l]=y+(p[i]||0),y+=(p[e]||0)+g+(p[i]||0)+(p[s]||0),b(p)})}if(T==="flexEnd"){let y=d;for(let p=_-1;p>=0;p--){const m=n[p];k(m),m[l]=y-(m[e]||0)-(m[s]||0),y-=(m[e]||0)+g+(m[i]||0)+(m[s]||0),b(m)}}if(T==="center"){let y=(d-(x+g*(_-1)))/2;n.forEach(p=>{p[l]=y,y+=(p[e]||0)+g,b(p)})}if(T==="spaceBetween"){const y=(d-x)/(_-1);let p=0;n.forEach(m=>{m[l]=p,p+=(m[e]||0)+y,b(m)})}if(T==="spaceEvenly"){const y=(d-x)/(_+1);let p=y;n.forEach(m=>{m[l]=p,p+=(m[e]||0)+y,b(m)})}}const{animationSettings:Go}=pt;function Ko(r){const n=[];for(const[t,e]of Object.entries(r))n.push({type:t,props:e});return yn("DynamicShader",{effects:n})}function ee(r=""){return{set(n){Xo(n)&&(n={width:n,color:255}),this.effects={...this.effects||{},["border".concat(r)]:n},this["_border".concat(r)]=n},get(){return this["_border".concat(r)]}}}const Vo=["alpha","color","colorTop","colorRight","colorLeft","colorBottom","colorTl","colorTr","colorBl","colorBr","height","fontSize","lineHeight","mount","mountX","mountY","pivot","pivotX","pivotY","rotation","scale","width","worldX","worldY","x","y","zIndex","zIndexLocked"],qo=["clipping","contain","fontFamily","src","text","textAlign","texture"];class Ut extends Object{constructor(t){super();h(this,"name");h(this,"lng",null);h(this,"selected",null);h(this,"rendered");h(this,"_undoStates");h(this,"_renderProps");h(this,"_effects");h(this,"_parent",null);h(this,"_shader");h(this,"_style");h(this,"_states");h(this,"_animationSettings");h(this,"_updateLayoutOn");h(this,"_width");h(this,"_height");h(this,"_color");h(this,"_borderRadius");h(this,"_border");h(this,"_borderLeft");h(this,"_borderRight");h(this,"_borderTop");h(this,"_borderBottom");h(this,"_animate");h(this,"_autosized");h(this,"_isDirty");h(this,"_dom");h(this,"children");this.name=t,this.rendered=!1,this.autofocus=!1,this._renderProps={x:0,y:0},this.children=new Yo(this);for(const e of Vo)Object.defineProperty(this,e,{get(){return this["_".concat(e)]||this.lng&&this.lng[e]},set(o){this["_".concat(e)]=o,this._sendToLightningAnimatable(e,o)}});for(const e of qo)Object.defineProperty(this,e,{get(){return this["_".concat(e)]||this.lng&&this.lng[e]},set(o){this["_".concat(e)]=o,this._sendToLightning(e,o)}});Object.defineProperties(this,{borderRadius:{set(e){this._borderRadius=e,this.effects={...this.effects||{},radius:{radius:e}}},get(){return this._borderRadius}},border:ee(),borderLeft:ee("Left"),borderRight:ee("Right"),borderTop:ee("Top"),borderBottom:ee("Bottom")}),Object.defineProperties(this,{linearGradient:{set(e={}){this._linearGradient=e,this.effects={...this.effects||{},linearGradient:e}},get(){return this._linearGradient}}})}get effects(){return this._effects}set effects(t){this._effects=t,this.shader=Ko(t)}get parent(){return this._parent}set parent(t){var e;this._parent=t,this.rendered&&this.lng&&(this.lng.parent=(e=t==null?void 0:t.lng)!=null?e:null)}get shader(){return this._shader}set shader(t){Fe(t)?this._shader=yn(...t):this._shader=t,this._sendToLightning("shader",this._shader)}_sendToLightningAnimatable(t,e){if(this.rendered&&this.lng){if(Fe(e))return this.createAnimation({[t]:e[0]},e[1]).start();if(this._animate)return this.createAnimation({[t]:e}).start();this.lng[t]=e}else Fe(e)&&(e=e[0]),this._renderProps[t]=e}_sendToLightning(t,e){this.rendered&&this.lng?this.lng[t]=e:this._renderProps[t]=e}createAnimation(t,e){return k(this.lng,"Node must be rendered before animating"),this.lng.animate(t,e||this.animationSettings)}setFocus(){this.rendered?or(this):this.autofocus=!0}isTextNode(){return this.name==="text"}_resizeOnTextLoad(){k(this.lng),this.lng.once("loaded",(t,e)=>{if(e.type==="text"){const{dimensions:o}=e;this.width=o.width,this.height=o.height,k(this.parent),this.parent.updateLayout(this,o)}})}getText(){return this.children.map(t=>t.text).join("")}destroy(){this.lng&&lt.destroyNode(this.lng)}set style(t){for(let e in t)e==="animate"&&(e="_animate"),this[e]||(this[e]=t[e]);this._style=t}get style(){return this._style}get hasChildren(){return this.children.length>0}set states(t){this._states=new Pn(this._stateChanged.bind(this),t),this.rendered&&this._stateChanged()}get states(){return this._states=this._states||new Pn(this._stateChanged.bind(this)),this._states}get animationSettings(){return this._animationSettings||Go}set animationSettings(t){this._animationSettings=t}get updateLayoutOn(){return this._updateLayoutOn}set updateLayoutOn(t){this._updateLayoutOn=t,queueMicrotask(()=>this.updateLayout())}_applyZIndexToChildren(){const t=this.zIndex;k(t);const o=t>=1&&parseInt(""+t)===t?".":"";this.children.forEach((i,s)=>{(!i.zIndex||i.zIndex<1)&&(i.zIndex=parseFloat("".concat(t).concat(o).concat(s+1)))})}updateLayout(t,e){this.hasChildren&&(Xt("Layout: ",this),Re(this.onBeforeLayout)&&this.onBeforeLayout.call(this,t,e),this.display==="flex"&&Uo(this),Re(this.onLayout)&&this.onLayout.call(this,t,e))}_stateChanged(){var e;if(Xt("State Changed: ",this,this.states),this.forwardStates){const o=this.states.slice();this.children.forEach(i=>i.states=o)}const t=((e=pt.stateMapperHook)==null?void 0:e.call(pt,this,this.states))||this.states;if(this._undoStates||this.style&&Ho(this.style,t)){this._undoStates=this._undoStates||{};let o={};for(const[s,l]of Object.entries(this._undoStates))t.includes(s)||(o={...o,...l});const i=t.reduce((s,l)=>{const c=this.style[l];return c&&(s={...s,...c},this._undoStates&&!this._undoStates[l]&&(this._undoStates[l]={},Object.keys(c).forEach(d=>{k(this._undoStates),this._undoStates[l][d]=this[d]}))),s},{});Object.assign(this,{...o,...i})}}render(){const t=this,e=this.parent;e!=null&&e._isDirty&&(e.updateLayout(),e._applyZIndexToChildren(),e._isDirty=!1),t.updateLayout(),this.states.length&&this._stateChanged();let o=t._renderProps;e!=null&&e.lng&&(o.parent=e.lng),t.isTextNode()?(o={...pt.fontSettings,...o,text:t.getText()},Xt("Rendering: ",this,o),t.lng=lt.createTextNode(o),Re(t.onLoad)&&t.lng.once("loaded",t.onLoad),(!t.width||!t.height)&&(t._autosized=!0,t._resizeOnTextLoad())):(o.src||o.texture||(k(e),isNaN(o.width)&&(o.width=(e.width||0)-o.x,t._width=o.width),isNaN(o.height)&&(o.height=(e.height||0)-o.y,t._height=o.height),o.color||(t._color=o.color=0)),Xt("Rendering: ",this,o),t.hasChildren&&t._applyZIndexToChildren(),t.lng=lt.createNode(o),t.onFail&&t.lng.once("failed",t.onFail),t.onLoad&&t.lng.once("loaded",t.onLoad)),t.rendered=!0,t.autofocus&&t.setFocus(),delete this._renderProps}}function hr(r){r.name!=="TextNode"&&(k(r instanceof Ut),r.render(),r.children.forEach(n=>hr(n)))}const Qo=r=>{const n=Bo(r.options),t=n.init();let e;return _t(()=>{t.then(()=>{k(e),e.lng=n.root,e.children.forEach(hr),Re(r.onFirstRender)&&r.onFirstRender(e)}).catch(console.error)}),(()=>{const o=zt("canvas"),i=e;return typeof i=="function"?vn(i,o):e=o,Et(o,"zIndex",.1),ge(o,()=>r.children),o})()};function Jo({createElement:r,createTextNode:n,isTextNode:t,replaceText:e,insertNode:o,removeNode:i,setProperty:s,getParentNode:l,getFirstChild:c,getNextSibling:d}){function u(p,m,f,C){if(f!==void 0&&!C&&(C=[]),typeof m!="function")return x(p,m,C,f);yt(F=>x(p,m(),F,f),C)}function x(p,m,f,C,F){for(;typeof f=="function";)f=f();if(m===f)return f;const I=typeof m,w=C!==void 0;if(I==="string"||I==="number")if(I==="number"&&(m=m.toString()),w){let v=f[0];v&&t(v)?e(v,m):v=n(m),f=T(p,f,C,v)}else f!==""&&typeof f=="string"?e(c(p),f=m):(T(p,f,C,n(m)),f=m);else if(m==null||I==="boolean")f=T(p,f,C);else{if(I==="function")return yt(()=>{let v=m();for(;typeof v=="function";)v=v();f=x(p,v,f,C)}),()=>f;if(Array.isArray(m)){const v=[];if(g(v,m,F))return yt(()=>f=x(p,v,f,C,!0)),()=>f;if(v.length===0){const R=T(p,f,C);if(w)return f=R}else Array.isArray(f)?f.length===0?S(p,v,C):_(p,f,v):f==null||f===""?S(p,v):_(p,w&&f||[c(p)],v);f=v}else{if(Array.isArray(f)){if(w)return f=T(p,f,C,m);T(p,f,null,m)}else f==null||f===""||!c(p)?o(p,m):b(p,m,c(p));f=m}}return f}function g(p,m,f){let C=!1;for(let F=0,I=m.length;F<I;F++){let w=m[F],v;if(!(w==null||w===!0||w===!1))if(Array.isArray(w))C=g(p,w)||C;else if((v=typeof w)=="string"||v==="number")p.push(n(w));else if(v==="function")if(f){for(;typeof w=="function";)w=w();C=g(p,Array.isArray(w)?w:[w])||C}else p.push(w),C=!0;else p.push(w)}return C}function _(p,m,f){let C=f.length,F=m.length,I=C,w=0,v=0,R=d(m[F-1]),E=null;for(;w<F||v<I;){if(m[w]===f[v]){w++,v++;continue}for(;m[F-1]===f[I-1];)F--,I--;if(F===w){const z=I<C?v?d(f[v-1]):f[I-v]:R;for(;v<I;)o(p,f[v++],z)}else if(I===v)for(;w<F;)(!E||!E.has(m[w]))&&i(p,m[w]),w++;else if(m[w]===f[I-1]&&f[v]===m[F-1]){const z=d(m[--F]);o(p,f[v++],d(m[w++])),o(p,f[--I],z),m[F]=f[I]}else{if(!E){E=new Map;let M=v;for(;M<I;)E.set(f[M],M++)}const z=E.get(m[w]);if(z!=null)if(v<z&&z<I){let M=w,P=1,$;for(;++M<F&&M<I&&!(($=E.get(m[M]))==null||$!==z+P);)P++;if(P>z-v){const W=m[w];for(;v<z;)o(p,f[v++],W)}else b(p,f[v++],m[w++])}else w++;else i(p,m[w++])}}}function T(p,m,f,C){if(f===void 0){let I;for(;I=c(p);)i(p,I);return C&&o(p,C),""}const F=C||n("");if(m.length){let I=!1;for(let w=m.length-1;w>=0;w--){const v=m[w];if(F!==v){const R=l(v)===p;!I&&!w?R?b(p,F,v):o(p,F,f):R&&i(p,v)}else I=!0}}else o(p,F,f);return[F]}function S(p,m,f){for(let C=0,F=m.length;C<F;C++)o(p,m[C],f)}function b(p,m,f){o(p,m,f),i(p,f)}function y(p,m,f={},C){return m||(m={}),C||yt(()=>f.children=x(p,m.children,f.children)),yt(()=>m.ref&&m.ref(p)),yt(()=>{for(const F in m){if(F==="children"||F==="ref")continue;const I=m[F];I!==f[F]&&(s(p,F,I,f[F]),f[F]=I)}}),f}return{render(p,m){let f;return Jt(C=>{f=C,u(m,p())}),f},insert:u,spread(p,m,f){typeof m=="function"?yt(C=>y(p,m(),C,f)):y(p,m,void 0,f)},createElement:r,createTextNode:n,insertNode:o,setProp(p,m,f,C){return s(p,m,f,C),f},mergeProps:gn,effect:yt,memo:J,createComponent:Ze,use(p,m,f){return st(()=>p(m,f))}}}function Zo(r){const n=Jo(r);return n.mergeProps=gn,n}const It={createElement(r){const n=new Ut(r);return lt.root&&_t(()=>n.render()),n},createTextNode(r){return{name:"TextNode",text:r,parent:null}},replaceText(r,n){Xt("Replace Text: ",r,n),r.text=n;const t=r.parent;k(t),t._autosized&&t._resizeOnTextLoad(),t.text=t.getText()},setProperty(r,n,t=!0){if(n==="animate"){r._animate=t;return}r[n]=t},insertNode(r,n,t){Xt("INSERT: ",r,n,t),r&&(r.children.insert(n,t),n.name==="TextNode"&&r.isTextNode()&&(r._autosized&&r._resizeOnTextLoad(),r.text=r.getText()))},isTextNode(r){return r.isTextNode()},removeNode(r,n){Xt("REMOVE: ",r,n),r.children.remove(n),n instanceof Ut&&n.destroy()},getParentNode(r){var n;return(n=r.parent)!=null?n:void 0},getFirstChild(r){return r.children[0]},getNextSibling(r){if(r.parent){const n=r.parent.children||[],t=n.indexOf(r)+1;if(t<n.length)return n[t]}}},ti=r=>{const n=document.createElement("style");n.innerText=r,document.head.appendChild(n)},ei=function(r){const n=r.getBoundingClientRect(),t=lt.settings.deviceLogicalPixelRatio||1,e=document.getElementById("linspector");e.style.left=r.offsetLeft+"px",e.style.top=r.offsetTop+"px",e.style.width=Math.ceil(n.width/t)+"px",e.style.height=Math.ceil(n.height/t)+"px",e.style.transformOrigin="0 0 0",e.style.transform="scale("+t+","+t+")"};function ni(){ti("\n    #linspector {\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      zIndex: 5;\n      overflow: hidden;\n    }\n    div.lnode {\n      position: absolute;\n      display: inline-block;\n    }\n    .ltext {\n      visibility: hidden;\n    }\n  "),setTimeout(function(){ei(lt.canvas)},1e3)}const ri={...It,createElement(r){const n=document.createElement("div");r==="canvas"?(n.id="linspector",k(lt.canvas.parentNode),lt.canvas.parentNode.appendChild(n)):n.classList.add("lnode"),r==="text"&&n.classList.add("ltext");const t=It.createElement(r);if(r!=="canvas"){const e=t.render;t.render=()=>{e.call(t),t.id&&(n.id=t.id),t.clipping&&(n.style.overflow="hidden"),n.style.width=t.width+"px",n.style.height=t.height+"px",n.style.top=t.y+"px",n.style.left=t.x+"px",n.style.zIndex="".concat(t.zIndex)}}return t._dom=n,n.solid=t,t},setProperty(r,n,t=!0){n==="width"?r._dom.style.width=t+"px":n==="height"?r._dom.style.height=t+"px":n==="y"?r._dom.style.top=t+"px":n==="x"?r._dom.style.left=t+"px":n==="zIndex"&&(r._dom.style.zIndex=t),It.setProperty(r,n,t)},createTextNode(r){const n=document.createTextNode(r),t=It.createTextNode(r);return t._dom=n,t},replaceText(r,n){It.replaceText(r,n),r._dom.data=n},insertNode(r,n,t){r&&(t&&r._dom===t._dom.parentNode?r._dom.insertBefore(n._dom,t._dom):r._dom.appendChild(n._dom),It.insertNode(r,n,t))},removeNode(r,n){r._dom.removeChild(n._dom),It.removeNode(r,n)}};var jn,Hn;const dr=((Hn=(jn=import.meta)==null?void 0:jn.env)==null?void 0:Hn.MODE)==="development";dr&&ni();const fr=Zo(dr?ri:It),oi=fr.render,{effect:Os,memo:gr,createComponent:a,createElement:zt,createTextNode:Ws,insertNode:Xs,insert:ge,spread:Zt,setProp:Et,mergeProps:H,use:vn}=fr;function N(r=""){return jo(r)?r:typeof r=="string"?r.startsWith("#")?+(r.replace("#","0x")+(r.length===7?"ff":"")):r.startsWith("0x")?Number(r):+("0x"+(r.length===6?r+"ff":r)):0}function ii(r){return r*Math.PI/180}const Ln="_$DX_DELEGATE";function si(r,n=window.document){const t=n[Ln]||(n[Ln]=new Set);for(let e=0,o=r.length;e<o;e++){const i=r[e];t.has(i)||(t.add(i),n.addEventListener(i,ai))}}function ai(r){const n="$$".concat(r.type);let t=r.composedPath&&r.composedPath()[0]||r.target;for(r.target!==t&&Object.defineProperty(r,"target",{configurable:!0,value:t}),Object.defineProperty(r,"currentTarget",{configurable:!0,get(){return t||document}});t;){const e=t[n];if(e&&!t.disabled){const o=t["".concat(n,"Data")];if(o!==void 0?e.call(t,o,r):e.call(t,r),r.cancelBubble)return}t=t._$host||t.parentNode||t.host}}const li=!1;function ci(r,n,t){return r.addEventListener(n,t),()=>r.removeEventListener(n,t)}function ui([r,n],t,e){return[t?()=>t(r()):r,e?o=>n(e(o)):n]}function hi(r){try{return document.querySelector(r)}catch(n){return null}}function di(r,n){const t=hi("#".concat(r));t?t.scrollIntoView():n&&window.scrollTo(0,0)}function fi(r,n,t,e){let o=!1;const i=l=>typeof l=="string"?{value:l}:l,s=ui(O(i(r()),{equals:(l,c)=>l.value===c.value}),void 0,l=>(!o&&n(l),l));return t&&Ht(t((l=r())=>{o=!0,s[1](i(l)),o=!1})),{signal:s,utils:e}}function gi(r){if(r){if(Array.isArray(r))return{signal:r}}else return{signal:O({value:""})};return r}function pi(){return fi(()=>({value:window.location.pathname+window.location.search+window.location.hash,state:history.state}),({value:r,replace:n,scroll:t,state:e})=>{n?window.history.replaceState(e,"",r):window.history.pushState(e,"",r),di(window.location.hash.slice(1),t)},r=>ci(window,"popstate",()=>r()),{go:r=>window.history.go(r)})}function mi(){let r=new Set;function n(o){return r.add(o),()=>r.delete(o)}let t=!1;function e(o,i){if(t)return!(t=!1);const s={to:o,options:i,defaultPrevented:!1,preventDefault:()=>s.defaultPrevented=!0};for(const l of r)l.listener({...s,from:l.location,retry:c=>{c&&(t=!0),l.navigate(o,i)}});return!s.defaultPrevented}return{subscribe:n,confirm:e}}const xi=/^(?:[a-z0-9]+:)?\/\//i,yi=/^\/+|(\/)\/+$/g;function oe(r,n=!1){const t=r.replace(yi,"$1");return t?n||/^[?#]/.test(t)?t:"/"+t:""}function Ie(r,n,t){if(xi.test(n))return;const e=oe(r),o=t&&oe(t);let i="";return!o||n.startsWith("/")?i=e:o.toLowerCase().indexOf(e.toLowerCase())!==0?i=e+o:i=o,(i||"/")+oe(n,!i)}function vi(r,n){if(r==null)throw new Error(n);return r}function pr(r,n){return oe(r).replace(/\/*(\*.*)?$/g,"")+oe(n)}function _i(r){const n={};return r.searchParams.forEach((t,e)=>{n[e]=t}),n}function wi(r,n,t){const[e,o]=r.split("/*",2),i=e.split("/").filter(Boolean),s=i.length;return l=>{const c=l.split("/").filter(Boolean),d=c.length-s;if(d<0||d>0&&o===void 0&&!n)return null;const u={path:s?"":"/",params:{}},x=g=>t===void 0?void 0:t[g];for(let g=0;g<s;g++){const _=i[g],T=c[g],S=_[0]===":",b=S?_.slice(1):_;if(S&&Ke(T,x(b)))u.params[b]=T;else if(S||!Ke(T,_))return null;u.path+="/".concat(T)}if(o){const g=d?c.slice(-d).join("/"):"";if(Ke(g,x(o)))u.params[o]=g;else return null}return u}}function Ke(r,n){const t=e=>e.localeCompare(r,void 0,{sensitivity:"base"})===0;return n===void 0?!0:typeof n=="string"?t(n):typeof n=="function"?n(r):Array.isArray(n)?n.some(t):n instanceof RegExp?n.test(r):!1}function Si(r){const[n,t]=r.pattern.split("/*",2),e=n.split("/").filter(Boolean);return e.reduce((o,i)=>o+(i.startsWith(":")?2:3),e.length-(t===void 0?0:1))}function mr(r){const n=new Map,t=un();return new Proxy({},{get(e,o){return n.has(o)||Xr(t,()=>n.set(o,J(()=>r()[o]))),n.get(o)()},getOwnPropertyDescriptor(){return{enumerable:!0,configurable:!0}},ownKeys(){return Reflect.ownKeys(r())}})}function xr(r){let n=/(\/?\:[^\/]+)\?/.exec(r);if(!n)return[r];let t=r.slice(0,n.index),e=r.slice(n.index+n[0].length);const o=[t,t+=n[1]];for(;n=/^(\/\:[^\/]+)\?/.exec(e);)o.push(t+=n[1]),e=e.slice(n[0].length);return xr(e).reduce((i,s)=>[...i,...o.map(l=>l+s)],[])}const Ti=100,yr=Jn(),Oe=Jn(),_n=()=>vi(hn(yr),"Make sure your app is wrapped in a <Router />");let le;const wn=()=>le||hn(Oe)||_n().base,pe=()=>_n().navigatorFactory(),Sn=()=>wn().params;function bi(r,n="",t){const{component:e,data:o,children:i}=r,s=!i||Array.isArray(i)&&!i.length,l={key:r,element:e?()=>Ze(e,{}):()=>{const{element:c}=r;return c===void 0&&t?Ze(t,{}):c},preload:r.component?e.preload:r.preload,data:o};return vr(r.path).reduce((c,d)=>{for(const u of xr(d)){const x=pr(n,u),g=s?x:x.split("/*",1)[0];c.push({...l,originalPath:u,pattern:g,matcher:wi(g,!s,r.matchFilters)})}return c},[])}function Ci(r,n=0){return{routes:r,score:Si(r[r.length-1])*1e4-n,matcher(t){const e=[];for(let o=r.length-1;o>=0;o--){const i=r[o],s=i.matcher(t);if(!s)return null;e.unshift({...s,route:i})}return e}}}function vr(r){return Array.isArray(r)?r:[r]}function _r(r,n="",t,e=[],o=[]){const i=vr(r);for(let s=0,l=i.length;s<l;s++){const c=i[s];if(c&&typeof c=="object"&&c.hasOwnProperty("path")){const d=bi(c,n,t);for(const u of d){e.push(u);const x=Array.isArray(c.children)&&c.children.length===0;if(c.children&&!x)_r(c.children,u.pattern,t,e,o);else{const g=Ci([...e],o.length);o.push(g)}e.pop()}}}return e.length?o:o.sort((s,l)=>l.score-s.score)}function Ri(r,n){for(let t=0,e=r.length;t<e;t++){const o=r[t].matcher(n);if(o)return o}return[]}function Fi(r,n){const t=new URL("http://sar"),e=J(c=>{const d=r();try{return new URL(d,t)}catch(u){return console.error("Invalid path ".concat(d)),c}},t,{equals:(c,d)=>c.href===d.href}),o=J(()=>e().pathname),i=J(()=>e().search,!0),s=J(()=>e().hash),l=J(()=>"");return{get pathname(){return o()},get search(){return i()},get hash(){return s()},get state(){return n()},get key(){return l()},query:mr(kt(i,()=>_i(e())))}}function Ii(r,n="",t,e){const{signal:[o,i],utils:s={}}=gi(r),l=s.parsePath||(v=>v),c=s.renderPath||(v=>v),d=s.beforeLeave||mi(),u=Ie("",n),x=void 0;if(u===void 0)throw new Error("".concat(u," is not a valid base path"));u&&!o().value&&i({value:u,replace:!0,scroll:!1});const[g,_]=O(!1),T=async v=>{_(!0);try{await jr(v)}finally{_(!1)}},[S,b]=O(o().value),[y,p]=O(o().state),m=Fi(S,y),f=[],C={pattern:u,params:{},path:()=>u,outlet:()=>null,resolvePath(v){return Ie(u,v)}};if(t)try{le=C,C.data=t({data:void 0,params:{},location:m,navigate:I(C)})}finally{le=void 0}function F(v,R,E){st(()=>{if(typeof R=="number"){R&&(s.go?d.confirm(R,E)&&s.go(R):console.warn("Router integration does not support relative routing"));return}const{replace:z,resolve:M,scroll:P,state:$}={replace:!1,resolve:!0,scroll:!0,...E},W=M?v.resolvePath(R):Ie("",R);if(W===void 0)throw new Error("Path '".concat(R,"' is not a routable path"));if(f.length>=Ti)throw new Error("Too many redirects");const X=S();if((W!==X||$!==y())&&!li){if(d.confirm(W,E)){const ct=f.push({value:X,replace:z,scroll:P,state:y()});T(()=>{b(W),p($)}).then(()=>{f.length===ct&&w({value:W,state:$})})}}})}function I(v){return v=v||hn(Oe)||C,(R,E)=>F(v,R,E)}function w(v){const R=f[0];R&&((v.value!==R.value||v.state!==R.state)&&i({...v,replace:R.replace,scroll:R.scroll}),f.length=0)}yt(()=>{const{value:v,state:R}=o();st(()=>{v!==S()&&T(()=>{b(v),p(R)})})});{let v=function(R){if(R.defaultPrevented||R.button!==0||R.metaKey||R.altKey||R.ctrlKey||R.shiftKey)return;const E=R.composedPath().find(X=>X instanceof Node&&X.nodeName.toUpperCase()==="A");if(!E||!E.hasAttribute("link"))return;const z=E.href;if(E.target||!z&&!E.hasAttribute("state"))return;const M=(E.getAttribute("rel")||"").split(/\s+/);if(E.hasAttribute("download")||M&&M.includes("external"))return;const P=new URL(z);if(P.origin!==window.location.origin||u&&P.pathname&&!P.pathname.toLowerCase().startsWith(u.toLowerCase()))return;const $=l(P.pathname+P.search+P.hash),W=E.getAttribute("state");R.preventDefault(),F(C,$,{resolve:!1,replace:E.hasAttribute("replace"),scroll:!E.hasAttribute("noscroll"),state:W&&JSON.parse(W)})};si(["click"]),document.addEventListener("click",v),Ht(()=>document.removeEventListener("click",v))}return{base:C,out:x,location:m,isRouting:g,renderPath:c,parsePath:l,navigatorFactory:I,beforeLeave:d}}function Ei(r,n,t,e,o){const{base:i,location:s,navigatorFactory:l}=r,{pattern:c,element:d,preload:u,data:x}=e().route,g=J(()=>e().path);u&&u();const _={parent:n,pattern:c,get child(){return t()},path:g,params:o,data:n.data,outlet:d,resolvePath(T){return Ie(i.path(),T,g())}};if(x)try{le=_,_.data=x({data:n.data,params:o,location:s,navigate:l(_)})}finally{le=void 0}return _}const ki=r=>{const{source:n,url:t,base:e,data:o,out:i}=r,s=n||pi(),l=Ii(s,e,o);return a(yr.Provider,{value:l,get children(){return r.children}})},zi=r=>{const n=_n(),t=wn(),e=dn(()=>r.children),o=J(()=>_r(e(),pr(t.pattern,r.base||""),Mi)),i=J(()=>Ri(o(),n.location.pathname)),s=mr(()=>{const u=i(),x={};for(let g=0;g<u.length;g++)Object.assign(x,u[g].params);return x});n.out&&n.out.matches.push(i().map(({route:u,path:x,params:g})=>({originalPath:u.originalPath,pattern:u.pattern,path:x,params:g})));const l=[];let c;const d=J(kt(i,(u,x,g)=>{let _=x&&u.length===x.length;const T=[];for(let S=0,b=u.length;S<b;S++){const y=x&&x[S],p=u[S];g&&y&&p.route.key===y.route.key?T[S]=g[S]:(_=!1,l[S]&&l[S](),Jt(m=>{l[S]=m,T[S]=Ei(n,T[S-1]||t,()=>d()[S+1],()=>i()[S],s)}))}return l.splice(u.length).forEach(S=>S()),g&&_?g:(c=T[0],T)}));return a(Tt,{get when(){return d()&&c},keyed:!0,children:u=>a(Oe.Provider,{value:u,get children(){return u.outlet()}})})},at=r=>{const n=dn(()=>r.children);return gn(r,{get children(){return n()}})},Mi=()=>{const r=wn();return a(Tt,{get when(){return r.child},keyed:!0,children:n=>a(Oe.Provider,{value:n,get children(){return n.outlet()}})})};var Pi=!!eo,Li=Pi?r=>un()?Ht(r):r:Ht;function Ni(r,n,t,e){return r.addEventListener(n,t,e),Li(r.removeEventListener.bind(r,n,t,e))}function Ai(r,n=un()){let t=0,e,o;return()=>(t++,Ht(()=>{t--,queueMicrotask(()=>{!t&&o&&(o(),o=e=void 0)})}),o||Jt(i=>e=r(o=i),n),e)}var $i=Ai(()=>{const[r,n]=O(null);return Ni(window,"keydown",t=>{n(t),setTimeout(()=>n(null))}),r});function we(r){return typeof r=="function"}function Nn(r,n){if(!r)throw new Error(n||"Assertion failed")}let Ve={Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Enter:"Enter",Last:"l"};const[An,Bi]=O([]),Yi=(r={})=>{const n=$i();Ve={...Ve,...r};const t=Object.entries(Ve);return _t(kt(Le,(e,o,i=[])=>{var c;let s=e;const l=[];for(;s;)s.states.has("focus")||(s.states.add("focus"),we(s.onFocus)&&s.onFocus.call(s,e,o!=null?o:null)),l.push(s),s=(c=s.parent)!=null?c:null;return i.forEach(d=>{l.includes(d)||(d.states.remove("focus"),we(d.onBlur)&&d.onBlur.call(d,e,o!=null?o:null))}),Bi(l),l},{defer:!0})),_t(()=>{const e=n();if(e){const o=t.find(([i,s])=>s===e.key);st(()=>{const i=An();for(const s of i){const l=o?o[0]:void 0;if(l){const c=s["on".concat(l)];if(we(c)&&c.call(s,e,s)===!0)break}if(we(s.onKeyPress)&&s.onKeyPress.call(s,e,l,s)===!0)break}return!1})}}),An};function wr(r,n){const t=n();let e,o,i,s;Array.isArray(t)?t.length===2?(e=s=t[0],o=i=t[1]):t.length===3?(e=t[0],o=i=t[1],s=t[2]):[e,i,s,o]=t:e=i=s=o=t,r.onBeforeLayout=(l,c)=>{if(c){r.width=r.children.reduce((u,x)=>u+(x.width||0),0)+o+i;const d=r.children[0];d&&(d.x=o,d.marginLeft=o),r.height=r.children.reduce((u,x)=>(x.y=(x.y||0)+e,x.marginTop=e,u+(x.height||0)),0)+e+s}}}function Ne(r){return function(){var i,s;const n=this.children.length,t=this.wrap,e=this.selected;if(r==="right"||r==="down")do if(this.selected=(this.selected||0)%n+1,this.selected>=n){if(!t){this.selected=null;break}this.selected=0}while((i=this.children[this.selected])!=null&&i.skipFocus);else if(r==="left"||r==="up")do if(this.selected=(this.selected||0)%n-1,this.selected<0){if(!t){this.selected=null;break}this.selected=n-1}while((s=this.children[this.selected])!=null&&s.skipFocus);if(this.selected===null)return this.selected=e,!1;const o=this.children[this.selected];if(Nn(o instanceof Ut),this.onSelectedChanged&&this.onSelectedChanged.call(this,this,o,this.selected,e),this.plinko&&e!==null){const l=this.children[e];Nn(l instanceof Ut);const c=l.selected;o.selected=c}return or(o),!0}}function V(r){const n=Ne("left"),t=Ne("right");return(()=>{const e=zt("node");return Et(e,"onLeft",n),Et(e,"onRight",t),Et(e,"selected",0),Zt(e,H({get onFocus(){return r.onFocus||(o=>{if(!o||!o.selected)return;const i=o.children[o.selected];i instanceof Ut&&i.setFocus()})}},r),!0),ge(e,()=>r.children),e})()}function q(r){const n=Ne("up"),t=Ne("down");return(()=>{const e=zt("node");return Et(e,"onUp",n),Et(e,"onDown",t),Et(e,"selected",0),Zt(e,H({get onFocus(){return r.onFocus||(o=>{if(!o||!o.selected)return;const i=o.children[o.selected];i instanceof Ut&&i.setFocus()})}},r),!0),ge(e,()=>r.children),e})()}function Di(r,n){const t=lt.createTexture("ImageTexture",{src:r});return n.reduce((e,o)=>{const{x:i,y:s,width:l,height:c}=o;return e[o.name]=lt.createTexture("SubTexture",{texture:t,x:i,y:s,width:l,height:c}),e},{})}const Oi={display:"flex",flexDirection:"row",justifyContent:"flexStart"},Wi={display:"flex",flexDirection:"column",justifyContent:"flexStart"},Xi={screenW:1920,screenH:1080,marginX:120,marginY:120,gutterX:24,gutterY:72,focusScale:1.1},ji={primary:"#00315c",focus:"#bdbdbd",container:"#004882"},Hi={display1:{fontFamily:"Ubuntu",fontSize:72,lineHeight:88,fontStyle:"600",verticalAlign:"middle",textBaseline:"bottom",maxLineSuffix:"..."},display2:{fontFamily:"Ubuntu",fontSize:56,lineHeight:72},headline1:{fontFamily:"Ubuntu",fontSize:36,fontStyle:"600",lineHeight:48,verticalAlign:"middle",textBaseline:"bottom",maxLineSuffix:"..."},headline2:{fontFamily:"Ubuntu",fontSize:32,lineHeight:44},headline3:{fontFamily:"Ubuntu",fontSize:28,lineHeight:40},body1:{fontFamily:"Ubuntu",fontSize:32,lineHeight:40},body2:{fontFamily:"Ubuntu",fontSize:28,lineHeight:34},button1:{fontFamily:"Ubuntu",fontSize:32,lineHeight:40}},Q={flexRow:Oi,flexColumn:Wi,layout:Xi,color:ji,typography:Hi},rt={Page:{width:1920,height:1080},headlineText:{width:1200,height:240,x:360,y:455,contain:"both",fontSize:66,textAlign:"center"},headlineSubText:{width:960,height:170,x:530,y:655,contain:"both",fontSize:48,textAlign:"center"},itemsContainer:{width:Q.layout.screenW,height:600,y:560,x:0},Thumbnail:{borderRadius:16,width:185,height:278,scale:1,zIndex:2,focus:{scale:1.1}},FocusRing:{borderRadius:16,width:194,height:286,y:-5,x:-5},showHeadline:{x:70,y:20},headlineBlur:{width:1920,height:150,x:0,y:0,zIndex:14,alpha:.9,color:N("#000000")},RowTitle:{height:60,width:300,marginTop:20,fontSize:36,color:N("#f0f0f0"),zIndex:2},Row:{display:"flex",justifyContent:"spaceBetween",height:300},Column:{display:"flex",flexDirection:"column",justifyContent:"flexStart",gap:20,width:Q.layout.screenW-2*Q.layout.marginX,x:Q.layout.marginX+Q.layout.gutterX,y:48},Rect:{width:250,height:100,y:10,x:300,color:N("#0000ff")},peopleBio:{...Q.typography.body1,contain:"both",width:1500,height:400}},Ae={width:386,height:136,color:N("#000000"),alpha:.3,borderRadius:30,border:{width:5,color:N("#cc33ff")},scale:1,focus:{color:[N("#58807d"),{duration:2e3}],scale:1.2,border:{width:5,color:N("#ff0000")},alpha:[1,{duration:1500,delay:200,timing:"easy-in"}]},active:{color:N("#33ff55")},disabled:{alpha:1}},Ui={color:N("#00A699"),height:8,y:2,x:-4,width:Ae.width+8},Gi={fontSize:32,contain:"width",textAlign:"center",mountY:-.35,color:N("#F6F6F9"),height:Ae.height,width:Ae.width,focus:{fontSize:64}},$n={container:Ae,topBar:Ui,text:Gi},Bn={width:386,height:136,color:N("#715cab"),focus:{color:N("#5a39a2")},disabled:{color:N("#291d43")}},Ki={fontSize:32,contain:"width",textAlign:"center",mountY:-.35,color:N("#FFFFFF"),height:Bn.height,width:Bn.width,focus:{fontSize:40},disabled:{color:N("#909090")}};function Vi(r){return a(Y,H(r,{animate:!0,get style(){return rt.Thumbnail}}))}function qi(r){return a(Y,H(r,{get style(){return rt.FocusRing}}))}function $e(r){const[n,t]=Zr(r,["items"]);return a(V,H(t,{get style(){return rt.Row},get children(){return a(pn,{get each(){return n.items},children:e=>a(Vi,e)})}}))}const[Qi,Mt]=O(""),Ji="eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiIyZDE4YjEwMTA0YjdiZTlkNjFiMWYwYjVlMGEwNzM2OCIsInN1YiI6IjYwZTVjMTdlNGNhNjc2MDA3NTA4Njc3MSIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.D_nqH9kd-bhhWzeVsTDPYhHnsUaNAuyAa6YATmKHqsA",Zi="https://api.themoviedb.org/3";let Sr,Tr;const ts="w185",es={headers:{"Content-Type":"application/json",Authorization:"Bearer "+Ji}};function ie(r,n=ts){return Tr+n+r}function ns(r,n={}){return Sr?an(r,n):br().then(()=>an(r,n))}function an(r,n={}){return fetch(Zi+r,{...es,...n}).then(t=>t.json())}function br(){return an("/configuration").then(r=>{var n;return Sr=r,Tr=(n=r.images)==null?void 0:n.secure_base_url,r})}const Gt={get:ns,loadConfig:br};function rs(r,n){return r.length>n?r.substring(0,n-3)+"...":r}function os(r,n=7){let t=[];for(let e=0,o=r.length;e<o;e+=n)t.push(r.slice(e,e+n));return t}function ce(r=[]){return r.map(n=>({src:ie(n.poster_path||n.profile_path),tileSrc:ie(n.backdrop_path||n.profile_path,"w300"),backdrop:ie(n.backdrop_path,"original"),href:"/solid-demo-app/entity/".concat(n.media_type||"people","/").concat(n.id),shortTitle:rs(n.title||n.name,30),title:n.title||n.name,data:n,entityInfo:{type:n.media_type||"people",id:n.id},heroContent:{title:n.title||n.name,description:n.overview}}))}let qe=new Map;const Se=new Map;function is(r){return n=>{const t="/trending/".concat(r,"/week?page=").concat(n);if(qe.has(t))return qe.get(t);let e=Gt.get(t).then(o=>{let i=o.results.filter(c=>!c.adult),s=(Se.has(r)?Se.get(r):[]).concat(ce(i)),l=os(s);return l[l.length-1].length<7?Se.set(r,l.pop()):Se.delete(r),l});return qe.set(t,e),e}}function ss(r){const[n,t]=O([]),[e,o]=O(1),[i,s]=O(!1),[l]=jt(e,r);return Qe(()=>{const c=l();c&&Wr(()=>{c.length===0&&s(!0),t(d=>[...d,...c])})}),{pages:n,page:e,setPage:o,setPages:t,end:i,setEnd:s}}const We=1100,as={...Q.typography.display2,width:We,height:58,contain:"both"},ls=r=>a(L,H(r,{style:as,get children(){return r.children}})),cs={...Q.typography.body1,width:We,height:72,contain:"both"},us={fontSize:20,lineHeight:20},hs=r=>a(L,H(r,{style:cs,get children(){return r.children}}));function ds(r){return[a(Tt,{get when(){return(r==null?void 0:r.rtCrit)&&(r==null?void 0:r.rtCrit)!=="0"},get children(){return[a(Y,{src:"https://upload.wikimedia.org/wikipedia/commons/b/b6/Tomato-Torrent-Icon.png",title:"Rotten Tomatoes Rating",style:{width:30,height:30,marginRight:-6}}),a(L,{style:ln,get children(){return r.rtCrit+"%"}})]}}),a(Tt,{get when(){return(r==null?void 0:r.rtFan)&&(r==null?void 0:r.rtFan)!=="0"},get children(){return[a(Y,{src:"https://upload.wikimedia.org/wikipedia/commons/thumb/d/da/Rotten_Tomatoes_positive_audience.svg/80px-Rotten_Tomatoes_positive_audience.svg.png",title:"Rotten Tomatoes Rating",style:{width:24,height:30,marginRight:-6}}),a(L,{style:ln,get children(){return r.rtFan+"%"}})]}})]}const fs=r=>(()=>{const n=zt("node");return vn(wr,n,()=>[8,15,13,15]),Zt(n,H(r,{style:{color:"0x00000099",borderRadius:8,border:{width:3,color:"0xffffffff"}}}),!0),ge(n,a(L,{style:us,get children(){return r.children}})),n})(),ln=Q.typography.body2,gs=r=>a(Y,{get style(){return{...Q.flexRow,gap:12,width:We,height:48}},get children(){return[a(L,{style:ln,get children(){return r.metaText}}),a(pn,{get each(){return r.badges},children:n=>a(fs,{y:-5,children:n})}),gr(()=>ds(r.reviews))]}}),Cr=r=>a(Y,H(r,{get style(){return{...Q.flexColumn,width:We,height:160,gap:16}},get children(){return[a(ls,{get children(){return r.title}}),a(hs,{get children(){return r.description}}),a(gs,{get metaText(){return r.metaText},get badges(){return r.badges},get reviews(){return r.reviews}})]}}));function ps(r){const n=Math.floor(r/60),t=r%60;return n+"h "+(t<10?"0":"")+t+"m"}function Yn(r){return r.split("-")[0]}function ms({type:r,id:n}){return Gt.get("/".concat(r,"/").concat(n,"/recommendations")).then(({results:t})=>t.length?ce(t.slice(0,7)):Gt.get("/trending/".concat(r,"/week?page=1")).then(({results:e})=>ce(e.slice(0,7))))}function xs({type:r,id:n}){return Gt.get("/".concat(r,"/").concat(n,"/credits")).then(({cast:t})=>ce(t.slice(0,7)))}function Rr({type:r,id:n}){let t=r==="movie"?{rtCrit:86,rtFan:92}:{};return Gt.get("/".concat(r,"/").concat(n)).then(e=>({backgroundImage:ie(e.backdrop_path,"original"),heroContent:{title:e.title||e.name,description:e.overview,badges:["HD"],metaText:r==="movie"?ps(e.runtime)+" - "+e.release_date:"".concat(Yn(e.first_air_date)," - ").concat(Yn(e.last_air_date)),reviews:t},...e}))}const Dn=()=>{const r=Sn(),[n,t]=O(0),[e,o]=O();jt(e,Rr);const[i,s]=O({}),l=pe(),c=Or(()=>0),d=J(()=>ss(is(r.filter||"all")));_t(kt(Le,g=>{g.backdrop&&Mt(g.backdrop),g.heroContent&&s(g.heroContent)},{defer:!0}));function u(){var _;(_=this.children.selected)==null||_.setFocus(),t((this.y||0)*-1+24);let g=d().pages().length;(g===0||this.parent.selected&&this.parent.selected>=g-2)&&d().setPage(T=>T+1)}function x(){let g=this.children.selected;k(g&&g.href),l(g.href)}return a(Tt,{get when(){return d().pages().length},get children(){return[a(Cr,H({y:360,x:150},i)),a(Y,{clipping:!0,get style(){return rt.itemsContainer},get children(){return a(q,{plinko:!0,announce:"All Trending - Week",animate:!0,get y(){return n()},get style(){return rt.Column},get children(){return a(pn,{get each(){return d().pages()},children:(g,_)=>a($e,{get autofocus(){return c(_())},items:g,onFocus:u,onEnter:x})})}})}})]}})},ys=()=>[a(L,{autofocus:!0,get style(){return rt.headlineText},children:"Learn more about Solid + Lightning through other pages:"}),a(L,{get style(){return rt.headlineSubText},children:"Press B for buttons, T for Text pages, M for Browse, F for Flex, C for Column Flex"})],vs=()=>{const r={width:900,height:500,y:350,x:150,gap:25,display:"flex",flexDirection:"column",justifyContent:"flexStart",color:N("00000000")},n={width:900,height:36,gap:6,display:"flex",flexDirection:"row",justifyContent:"flexStart",color:N("00000000")},t={fontSize:42},e={width:r.width,fontSize:26,contain:"width"},o={fontSize:26};return de(()=>{Mt("0x000000ff")}),a(Y,{autofocus:!0,style:r,get children(){return[a(L,{style:t,children:"Title of the Page"}),a(L,{style:e,children:"Lorem ipsum dolor sit amet, consectetur adipiscing elit. Integer vel tempor tellus. Sed eu leo purus. Vestibulum sollicitudin eget tellus a varius. Phasellus est turpis, volutpat sed blandit sit amet, rutrum sit amet mauris. In dignissim elit orci, a sollicitudin ipsum faucibus et. Quisque vel quam rutrum, faucibus augue sed, scelerisque nunc."}),a(Y,{style:n,get children(){return[a(L,{style:o,children:"Subline Text"}),a(Y,{width:28,height:28,src:"/assets/rt-popcorn.png"}),a(L,{style:o,children:"More Text"})]}})]}})},_s=()=>{function r(o,i){this.states.toggle("disabled")}const n={display:"flex",justifyContent:"flexStart",width:1500,height:300,color:N("00000000"),gap:26,y:400};function t(o){return a(Y,H(o,{forwardStates:!0,animate:!0,get style(){return $n.container},get children(){return a(L,{get style(){return $n.text},get children(){return o.children}})}}))}const e=o=>(()=>{const i=zt("node");return vn(wr,i,()=>[10,15]),Zt(i,H(o,{get style(){return{color:N("#000000be"),borderRadius:8,border:{width:2,color:N("#ffffff")}}}}),!0),ge(i,a(L,{style:{fontSize:20},get children(){return o.children}})),i})();return[a(V,{x:100,y:200,gap:5,style:n,get children(){return[a(e,{children:"HD"}),a(e,{children:"PG13"}),a(e,{children:"NC17"}),a(L,{fontSize:30,children:"I like bananas"}),a(e,{children:"DOLBY"})]}}),a(V,{x:100,gap:40,style:n,get children(){return[a(t,{autofocus:!0,onEnter:r,children:"TV Shows"}),a(t,{states:{active:!0,disabled:!1},children:"Movies"}),a(t,{states:"active",children:"Sports"}),a(t,{states:"disabled",children:"News"})]}})]},ws=()=>{const r={display:"flex",justifyContent:"flexStart",width:1600,height:110,color:N("#4dabf5")},n={fontSize:44,marginTop:25,marginBottom:-20,skipFocus:!0};function t(l){return a(Y,H(l,{style:{width:200,height:100,y:5,color:392801023}}))}const[e,o]=O(50);function i(){var l;(l=this.children.selected)==null||l.setFocus(),o(150+(this.y||0)*-1)}de(()=>{Mt("#333333")});const s=50;return a(q,{x:160,get y(){return e()},animate:!0,gap:30,height:850,get width(){return r.width},get style(){return rt.Column},get children(){return[a(L,{style:n,children:"Flex Start"}),a(V,{gap:s,style:r,onFocus:i,get children(){return[a(t,{autofocus:!0}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}}),a(L,{style:n,children:"Flex Start - Margin Left"}),a(V,{gap:s,style:r,onFocus:i,get children(){return[a(t,{marginLeft:100}),a(t,{}),a(t,{marginLeft:100}),a(t,{}),a(t,{})]}}),a(L,{style:n,children:"Flex End"}),a(V,{gap:s,justifyContent:"flexEnd",style:r,onFocus:i,get children(){return[a(t,{}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}}),a(L,{style:n,children:"Flex End - Margin Right"}),a(V,{gap:s,justifyContent:"flexEnd",style:r,onFocus:i,get children(){return[a(t,{}),a(t,{marginRight:100}),a(t,{}),a(t,{}),a(t,{marginRight:100})]}}),a(L,{style:n,children:"Center - No Margin Support"}),a(V,{gap:s,justifyContent:"center",style:r,onFocus:i,get children(){return[a(t,{}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}}),a(L,{style:n,children:"Space Between - No Margin Support"}),a(V,{gap:s,justifyContent:"spaceBetween",style:r,onFocus:i,get children(){return[a(t,{}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}}),a(L,{style:n,children:"Space Evenly - No Margin Support"}),a(V,{gap:s,justifyContent:"spaceEvenly",style:r,onFocus:i,get children(){return[a(t,{}),a(t,{}),a(t,{}),a(t,{}),a(t,{})]}})]}})},Ss=()=>{const r={display:"flex",justifyContent:"flexStart",width:1600,height:110,color:N("#4dabf5")},n={fontSize:44,marginTop:25,marginBottom:-20,skipFocus:!0};function t(c){return a(Y,H(c,{style:{width:200,height:100,y:5,color:392801023}}))}function e(){return Math.floor(Math.random()*91)+10}const[o,i]=O(50);function s(){var c;(c=this.children.selected)==null||c.setFocus(),i(150+(this.y||0)*-1)}de(()=>{Mt("#333333")});const l=50;return a(q,{x:160,get y(){return o()},animate:!0,gap:30,height:850,get width(){return r.width},get style(){return rt.Column},get children(){return[a(L,{style:n,children:"Flex Start - AlignItems: center"}),a(V,{alignItems:"center",gap:l,style:r,onFocus:s,get children(){return[a(t,{autofocus:!0,get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}})]}}),a(L,{style:n,children:"Flex Start - Margin Left - AlignItems: flexStart"}),a(V,{gap:l,alignItems:"flexStart",style:r,onFocus:s,get children(){return[a(t,{marginLeft:100,get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{marginLeft:100,get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}})]}}),a(L,{style:n,children:"Flex End - AlignItems: flexEnd"}),a(V,{gap:l,justifyContent:"flexEnd",alignItems:"flexEnd",style:r,onFocus:s,get children(){return[a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}})]}}),a(L,{style:n,children:"Flex End - Margin Right"}),a(V,{gap:l,justifyContent:"flexEnd",style:r,onFocus:s,get children(){return[a(t,{get height(){return e()}}),a(t,{marginRight:100,get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{marginRight:100,get height(){return e()}})]}}),a(L,{style:n,children:"Center - No Margin Support"}),a(V,{gap:l,justifyContent:"center",style:r,onFocus:s,get children(){return[a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}})]}}),a(L,{style:n,children:"Space Between - No Margin Support"}),a(V,{gap:l,justifyContent:"spaceBetween",style:r,onFocus:s,get children(){return[a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}})]}}),a(L,{style:n,children:"Space Evenly - No Margin Support"}),a(V,{gap:l,justifyContent:"spaceEvenly",style:r,onFocus:s,get children(){return[a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}}),a(t,{get height(){return e()}})]}})]}})},Ts=()=>{const r={display:"flex",justifyContent:"spaceEvenly",width:1920,y:100,height:880,color:N("00000000")},n={display:"flex",flexDirection:"column",justifyContent:"flexStart",color:N("#4dabf5"),height:850,width:80},t={fontSize:44,y:20,x:150};function e(d){const u={width:o(),height:80,x:5,color:N("#1769aa")};return a(Y,H(d,{style:u}))}function o(){return Math.floor(Math.random()*61)+10}const[i,s]=O(50);function l(){var d;(d=this.children.selected)==null||d.setFocus(),s(150+(this.y||0)*-1)}de(()=>{Mt("#333333")});const c=50;return[a(L,{style:t,children:"Start, MarginTop, End, MarginBottom, Center, Between, Evenly"}),a(V,{gap:c,style:r,onFocus:l,get children(){return[a(q,{gap:30,style:n,alignItems:"center",get children(){return[a(e,{autofocus:!0}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}}),a(q,{gap:c,style:n,onFocus:l,alignItems:"flexStart",get children(){return[a(e,{marginTop:100}),a(e,{}),a(e,{marginTop:100}),a(e,{}),a(e,{})]}}),a(q,{gap:c,alignItems:"flexEnd",justifyContent:"flexEnd",style:n,onFocus:l,get children(){return[a(e,{}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}}),a(q,{gap:c,justifyContent:"flexEnd",style:n,onFocus:l,get children(){return[a(e,{}),a(e,{marginBottom:100}),a(e,{}),a(e,{}),a(e,{marginBottom:100})]}}),a(q,{gap:c,justifyContent:"center",style:n,onFocus:l,get children(){return[a(e,{}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}}),a(q,{gap:c,justifyContent:"spaceBetween",style:n,onFocus:l,get children(){return[a(e,{}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}}),a(q,{gap:c,justifyContent:"spaceEvenly",style:n,onFocus:l,get children(){return[a(e,{}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}})]}})]},bs=()=>{const r={display:"flex",justifyContent:"spaceEvenly",width:1920,y:100,height:880,color:N("00000000")},n={display:"flex",flexDirection:"column",justifyContent:"flexStart",color:N("#4dabf5"),height:850,width:60},t={fontSize:44,y:20,x:150};function e(c){const d={width:50,height:80,x:5,color:N("#1769aa")};return a(Y,H(c,{style:d}))}const[o,i]=O(50);function s(){var c;(c=this.children.selected)==null||c.setFocus(),i(150+(this.y||0)*-1)}de(()=>{Mt("#333333")});const l=50;return[a(L,{style:t,children:"Start, MarginTop, End, MarginBottom, Center, Between, Evenly"}),a(V,{gap:l,style:r,onFocus:s,get children(){return[a(q,{gap:30,style:n,get children(){return[a(e,{autofocus:!0}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}}),a(q,{gap:l,style:n,onFocus:s,get children(){return[a(e,{marginTop:100}),a(e,{}),a(e,{marginTop:100}),a(e,{}),a(e,{})]}}),a(q,{gap:l,justifyContent:"flexEnd",style:n,onFocus:s,get children(){return[a(e,{}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}}),a(q,{gap:l,justifyContent:"flexEnd",style:n,onFocus:s,get children(){return[a(e,{}),a(e,{marginBottom:100}),a(e,{}),a(e,{}),a(e,{marginBottom:100})]}}),a(q,{gap:l,justifyContent:"center",style:n,onFocus:s,get children(){return[a(e,{}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}}),a(q,{gap:l,justifyContent:"spaceBetween",style:n,onFocus:s,get children(){return[a(e,{}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}}),a(q,{gap:l,justifyContent:"spaceEvenly",style:n,onFocus:s,get children(){return[a(e,{}),a(e,{}),a(e,{}),a(e,{}),a(e,{})]}})]}})]},Cs=()=>{function r(i,s){this.states.toggle("disabled")}const n={display:"flex",justifyContent:"flexStart",width:1500,height:300,color:N("00000000"),gap:26,y:400,x:100},t={width:386,height:136,color:"0x715cabff",focus:{color:"0x5a39a2ff"},disabled:{color:"0x291d43ff"}},e=["RoundedRectangle",{radius:65}];function o(i){return a(Y,H(i,{forwardStates:!0,animate:!0,style:t,shader:e,get children(){return a(L,{style:Ki,get children(){return i.children}})}}))}return a(V,{style:n,get children(){return[a(o,{autofocus:!0,onEnter:r,children:"Focused"}),a(o,{states:{active:!0,disabled:!1},children:"Normal"}),a(o,{states:"disabled",children:"Disabled"})]}})},Rs=()=>{const r=Sn(),n=pe(),[t]=jt(()=>({...r}),Rr),[e]=jt(()=>({...r}),xs),[o]=jt(()=>({...r}),ms);_t(kt(t,g=>{Mt(g.backgroundImage)},{defer:!0}));const i=600,s={color:N("#000000"),alpha:0,width:1900,height:890,x:10,y:i,borderRadius:30};function l(){var g;(g=this.children.selected)==null||g.setFocus(),u.y=i,x.y=i,x.alpha=0}function c(){var g;(g=this.children.selected)==null||g.setFocus(),u.y=200,x.y=160,x.alpha=.9}function d(){let g=this.children.selected;k(g&&g.href),n(g.href)}let u,x;return a(Tt,{get when(){return t()},keyed:!0,get children(){return[a(Cr,H({y:360,x:150},()=>t().heroContent)),a(q,{animate:!0,ref(g){const _=u;typeof _=="function"?_(g):u=g},y:i,x:140,get style(){return rt.Column},get children(){return a(Tt,{get when(){return gr(()=>!!o())()&&e()},get children(){return[a(L,{skipFocus:!0,get style(){return rt.RowTitle},children:"Recommendations"}),a($e,{autofocus:!0,onFocus:l,onEnter:d,get items(){return o()}}),a(L,{skipFocus:!0,get style(){return rt.RowTitle},children:"Cast and Crew"}),a($e,{onFocus:c,onEnter:d,get items(){return e()}})]}})}}),a(Y,{ref(g){const _=x;typeof _=="function"?_(g):x=g},animate:!0,style:s})]}})};function Fs({id:r}){return Gt.get("/person/".concat(r,"/combined_credits")).then(({cast:n})=>ce(n.slice(0,7)))}function Is({id:r}){return Gt.get("/person/".concat(r)).then(n=>({backgroundImage:ie(n.profile_path,"original"),heroContent:{title:n.title||n.name,description:n.biography},...n}))}const Es=()=>{const r=Sn(),n=pe(),[t]=jt(()=>({...r}),Is),[e]=jt(()=>({...r}),Fs);_t(kt(t,s=>{Mt(s.backgroundImage)},{defer:!0}));const o={color:N("#000000"),alpha:.8,width:1540,height:440,x:130,y:180,borderRadius:30};function i(){let s=this.children.selected;k(s&&s.href),n(s.href)}return a(Tt,{get when(){return t()},keyed:!0,get children(){return[a(Y,{x:150,y:200,get style(){return rt.Column},zIndex:3,get children(){return[a(L,{get style(){return Q.typography.display2},get children(){return t().name}}),a(L,{get style(){return rt.peopleBio},get children(){return t().biography}})]}}),a(Y,{style:o}),a(q,{y:670,x:140,get style(){return rt.Column},get children(){return a(Tt,{get when(){return e()},get children(){return[a(L,{skipFocus:!0,get style(){return rt.RowTitle},children:"Credits"}),a($e,{autofocus:!0,onEnter:i,get items(){return e()}})]}})}})]}})},ks=()=>(()=>{const r=zt("node");return Et(r,"style",{width:1920,height:1080,color:868483072}),r})();function zs(){let r,n,t=0;const e=1,o={alpha:e,color:4294967295},i={duration:1e3,easing:"ease-in-out"};return _t(kt(Qi,s=>{if(s.startsWith("#")){r.color=s,r.src="",r.alpha=1,t=1,n.alpha=0;return}else r.color=4294967295;if(t===0){r.src=s,t=1;return}if(t===1){n.src=s,t=2,n.alpha=[e],r.alpha=[0];return}t===2&&(r.src=s,t=1,r.alpha=e,n.alpha=0)},{defer:!0})),a(Y,{width:1920,height:1080,get children(){return[a(Y,{ref(s){const l=r;typeof l=="function"?l(s):r=s},animate:!0,animationSettings:i,style:o}),a(Y,{ref(s){const l=n;typeof l=="function"?l(s):n=s},animate:!0,animationSettings:i,style:o,alpha:0}),a(Y,{get effects(){return{radialGradient:{colors:[124,124,N(Q.color.container)],stops:[0,.4,.9],height:800,width:1920,pivot:[.8,0]}}}})]}})}const cn={Column:{...Q.flexColumn,width:320,height:600,y:360,gap:20,zIndex:101,x:[8,{duration:250,easing:"ease-in-out"}],focus:{x:[Q.layout.marginX,{duration:250,easing:"ease-in-out"}]}},Gradient:{zIndex:99,linearGradient:{angle:ii(270),stops:[0,.4,.8],colors:[N(Q.color.primary),N(Q.color.primary),N("#00000000")]},alpha:[0],focus:{width:1600,alpha:[1]},width:100,height:1080},NavButton:{zIndex:102,height:70,width:100,borderRadius:8,focus:{color:N(Q.color.container)},active:{width:328,height:70}}},Ms="/solid-demo-app/",Ps=[{name:"experiment",width:81,height:100,x:0,y:0},{name:"trending",width:100,height:56,x:81,y:0},{name:"tv",width:100,height:68,x:181,y:0},{name:"movie",width:94,height:100,x:281,y:0}];function Ls(r){const n=Di(Ms+"assets/icons_white.png",Ps);return a(Y,H(r,{get texture(){return n[r.name]},get width(){return n[r.name].props.width},get height(){return n[r.name].props.height},get x(){return(100-(n[r.name].props.width||0))/2},get y(){return(100-(n[r.name].props.height||0))/2}}))}function Te(r){return a(Y,H(r,{forwardStates:!0,get style(){return cn.NavButton},get children(){return[a(Y,{y:-16,get children(){return a(Ls,{scale:.5,get name(){return r.icon}})}}),a(L,{get style(){return{...Q.typography.button1,fontSize:38,x:116,y:16,height:50,alpha:0,active:{alpha:1}}},get children(){return r.children}})]}}))}function Ns(r){let n;const t=pe();function e(){n.states.add("focus"),this.children.forEach(s=>s.states.add("active")),this.children.selected.setFocus()}function o(){n.states.remove("focus"),this.selected=0,this.children.forEach(s=>s.states.remove("active"))}const i="/solid-demo-app/";return[a(q,H(r,{onFocus:e,onBlur:o,get style(){return cn.Column},animate:!0,get children(){return[a(Te,{onEnter:()=>t(i+"browse/all"),icon:"trending",children:"Trending"}),a(Te,{icon:"movie",onEnter:()=>t(i+"browse/movie"),children:"Movies"}),a(Te,{icon:"tv",onEnter:()=>t(i+"browse/tv"),children:"TV"}),a(Te,{icon:"experiment",onEnter:()=>t(i+"examples"),children:"Examples"})]}})),a(Y,{ref(s){const l=n;typeof l=="function"?l(s):n=s},get style(){return cn.Gradient}})]}const As=()=>{Yi({Menu:"m",Flex:"f",FlexSize:"s",FlexColumnSize:"x",FlexColumn:"c",Text:"t",Buttons:"b"});const r=pe();let n,t,e;_t(kt(Le,i=>{k(i),setTimeout(()=>{i.heroContent?(n.parent=i,n.alpha=1,n.width=i.width+10,n.height=i.height+10,n.zIndex=i.zIndex-1e-8):n.alpha=0},10)},{defer:!0}));const o="/solid-demo-app/";return a(Y,{ref(i){const s=window.APP;typeof s=="function"?s(i):window.APP=i},onLast:()=>history.back(),onText:()=>r(o+"text"),onFlex:()=>r(o+"flex"),onFlexSize:()=>r(o+"flexsize"),onFlexColumnSize:()=>r(o+"flexcolumnsize"),onFlexColumn:()=>r(o+"flexcolumn"),onButtons:()=>r(o+"buttons"),onMenu:()=>r(o),style:{width:1920,height:1080},onLeft:()=>{if(t.states.has("focus"))return!1;e=Le(),t.setFocus()},onRight:()=>t.states.has("focus")&&e.setFocus(),get children(){return[a(zs,{}),a(qi,{get color(){return N(Q.color.focus)},ref(i){const s=n;typeof s=="function"?s(i):n=i}}),a(zi,{get children(){return a(at,{path:o,get children(){return[a(at,{path:"",component:Dn}),a(at,{path:"examples",component:ys}),a(at,{path:"browse/:filter",component:Dn}),a(at,{path:"text",component:vs}),a(at,{path:"buttons",component:_s}),a(at,{path:"flex",component:ws}),a(at,{path:"flexsize",component:Ss}),a(at,{path:"flexcolumnsize",component:Ts}),a(at,{path:"flexcolumn",component:bs}),a(at,{path:"buttonsmaterial",component:Cs}),a(at,{path:"entity/people/:id",component:Es}),a(at,{path:"entity/:type/:id",component:Rs}),a(at,{path:"*all",component:ks})]}})}}),a(Ns,{ref(i){const s=t;typeof s=="function"?s(i):t=i}})]}})},$s=new URL("AppCoreExtensions-44a75e0c.js",import.meta.url).href;pt.debug=!1;pt.fontSettings.fontFamily="Ubuntu";pt.fontSettings.color=N("#ffffff");pt.fontSettings.fontSize=100;pt.driver="main";oi(()=>a(Qo,{options:{coreExtensionModule:$s,threadXCoreWorkerUrl:void 0},get children(){return a(ki,{get children(){return a(As,{})}})}}));export{Ys as __vite_legacy_guard};
//# sourceMappingURL=index-05d84824.js.map
